[0m20:47:44.826317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ca6ae527d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ca6b61e350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ca6ae83ed0>]}


============================== 20:47:44.828207 | d593242c-ec7b-4d4a-9a72-72c6dc18e9bb ==============================
[0m20:47:44.828207 [info ] [MainThread]: Running with dbt=1.7.5
[0m20:47:44.828658 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/roy/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:47:44.891019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd593242c-ec7b-4d4a-9a72-72c6dc18e9bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ca6ad26710>]}
[0m20:47:44.894286 [error] [MainThread]: Encountered an error:
Runtime Error
  The packages.yml file in this project is malformed. Please double check
  the contents of this file and fix any errors before retrying.
  
  You can find more information on the syntax for this file here:
  https://docs.getdbt.com/docs/package-management
  
  Validator Error:
  {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.3.3', 'unrendered': {'name': 'dbt_utils', 'package': 'dbt-labs/dbt_utils', 'version': '1.3.3'}} is not valid under any of the given schemas
  
[0m20:47:44.895752 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.099061556, "process_user_time": 1.328259, "process_kernel_time": 0.070907, "process_mem_max_rss": "106884", "process_in_blocks": "160", "process_out_blocks": "8", "command_success": false}
[0m20:47:44.896160 [debug] [MainThread]: Command `cli deps` failed at 20:47:44.896034 after 0.10 seconds
[0m20:47:44.896575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ca6ae91310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ca6bcac250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ca6f91af10>]}
[0m20:47:44.896946 [debug] [MainThread]: Flushing usage events
[0m21:18:45.890066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e4059a46e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e404a67ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e404a67b10>]}


============================== 21:18:45.894141 | 7f68ae59-0fef-41d2-86c1-2750f49a7e76 ==============================
[0m21:18:45.894141 [info ] [MainThread]: Running with dbt=1.11.6
[0m21:18:45.894878 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'write_json': 'True', 'profiles_dir': '/home/roy/.dbt', 'partial_parse': 'True', 'warn_error': 'None', 'quiet': 'False', 'fail_fast': 'False', 'version_check': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/logs', 'debug': 'False', 'printer_width': '80', 'empty': 'None', 'invocation_command': 'dbt deps', 'log_cache_events': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None'}
[0m21:18:45.997846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f68ae59-0fef-41d2-86c1-2750f49a7e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e405750fc0>]}
[0m21:18:46.009232 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-au9kdcef'
[0m21:18:46.009555 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:18:46.177584 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:18:46.178810 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:18:46.279621 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:18:46.283283 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m21:18:46.386692 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m21:18:46.389032 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:18:46.681683 [info ] [MainThread]: Installed from version 1.3.3
[0m21:18:46.682117 [info ] [MainThread]: Up to date!
[0m21:18:46.682587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7f68ae59-0fef-41d2-86c1-2750f49a7e76', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e40494bce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e40494bac0>]}
[0m21:18:46.682882 [info ] [MainThread]: Installing dbt-labs/codegen
[0m21:18:46.932063 [info ] [MainThread]: Installed from version 0.14.0
[0m21:18:46.932561 [info ] [MainThread]: Up to date!
[0m21:18:46.932971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7f68ae59-0fef-41d2-86c1-2750f49a7e76', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e404a0b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e404ce9c70>]}
[0m21:18:46.935695 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0903438, "process_in_blocks": "280", "process_kernel_time": 0.083708, "process_mem_max_rss": "105412", "process_out_blocks": "2928", "process_user_time": 1.188859}
[0m21:18:46.936089 [debug] [MainThread]: Command `dbt deps` succeeded at 21:18:46.936008 after 1.09 seconds
[0m21:18:46.936373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e404b3be70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e404a19390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e4048a94a0>]}
[0m21:18:46.936718 [debug] [MainThread]: Flushing usage events
[0m21:18:47.958710 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:19:08.883078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70df605a46e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70df5f667ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70df5f667b10>]}


============================== 21:19:08.885344 | 99fe4a19-a1d8-4bed-98a8-b83f8a141907 ==============================
[0m21:19:08.885344 [info ] [MainThread]: Running with dbt=1.11.6
[0m21:19:08.885911 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/home/roy/.dbt', 'no_print': 'None', 'log_format': 'default', 'empty': 'None', 'introspect': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'invocation_command': 'dbt seed', 'log_path': '/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/logs', 'target_path': 'None', 'version_check': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'use_colors': 'True', 'debug': 'False'}
[0m21:19:09.055363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99fe4a19-a1d8-4bed-98a8-b83f8a141907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70df60350fc0>]}
[0m21:19:09.105464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99fe4a19-a1d8-4bed-98a8-b83f8a141907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70df5f6ee140>]}
[0m21:19:09.106575 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m21:19:09.167234 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m21:19:09.167838 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:19:09.168165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '99fe4a19-a1d8-4bed-98a8-b83f8a141907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70df5f52f350>]}
[0m21:19:10.690470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99fe4a19-a1d8-4bed-98a8-b83f8a141907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70df558eb020>]}
[0m21:19:10.768637 [debug] [MainThread]: Wrote artifact WritableManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/manifest.json
[0m21:19:10.769851 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/semantic_manifest.json
[0m21:19:10.783739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99fe4a19-a1d8-4bed-98a8-b83f8a141907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70df262899b0>]}
[0m21:19:10.784117 [info ] [MainThread]: Found 8 models, 2 seeds, 36 data tests, 2 sources, 619 macros
[0m21:19:10.784449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99fe4a19-a1d8-4bed-98a8-b83f8a141907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70df26229230>]}
[0m21:19:10.786295 [info ] [MainThread]: 
[0m21:19:10.786650 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:19:10.787033 [info ] [MainThread]: 
[0m21:19:10.787556 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:19:10.791013 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m21:19:10.816235 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m21:19:10.816568 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"taxi_rides_ny"'
    
  
  
[0m21:19:10.816864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:10.834182 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m21:19:10.835201 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m21:19:10.835797 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_dev)
[0m21:19:10.836180 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "dev"
"
[0m21:19:10.840506 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m21:19:10.840786 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='taxi_rides_ny'
        and type='sqlite'
    
  
[0m21:19:10.841093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:10.842646 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:19:10.843584 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m21:19:10.843832 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: BEGIN
[0m21:19:10.844319 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:19:10.844568 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m21:19:10.844838 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
    
        create schema if not exists "taxi_rides_ny"."dev"
    
[0m21:19:10.845399 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:19:10.846032 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m21:19:10.846286 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m21:19:10.846598 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m21:19:10.850685 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m21:19:10.851041 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: Close
[0m21:19:10.852656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_dev, now list_taxi_rides_ny_dev)
[0m21:19:10.856584 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m21:19:10.856880 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: BEGIN
[0m21:19:10.857174 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:10.858292 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:19:10.858609 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m21:19:10.858891 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "connection_name": "list_taxi_rides_ny_dev"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev'
    and lower(table_catalog) = 'taxi_rides_ny'
  
[0m21:19:10.867538 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m21:19:10.868388 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: ROLLBACK
[0m21:19:10.869059 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_dev'
[0m21:19:10.869309 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: Close
[0m21:19:10.869872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99fe4a19-a1d8-4bed-98a8-b83f8a141907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70df26261b50>]}
[0m21:19:10.870297 [debug] [MainThread]: Using duckdb connection "master"
[0m21:19:10.870547 [debug] [MainThread]: On master: BEGIN
[0m21:19:10.870811 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:19:10.871767 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:19:10.872058 [debug] [MainThread]: On master: COMMIT
[0m21:19:10.872375 [debug] [MainThread]: Using duckdb connection "master"
[0m21:19:10.872669 [debug] [MainThread]: On master: COMMIT
[0m21:19:10.873144 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:19:10.873424 [debug] [MainThread]: On master: Close
[0m21:19:10.876576 [debug] [Thread-1 (]: Began running node seed.taxi_rides_ny.payment_type_lookup
[0m21:19:10.877041 [info ] [Thread-1 (]: 1 of 2 START seed file dev.payment_type_lookup ................................. [RUN]
[0m21:19:10.877490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_taxi_rides_ny_dev, now seed.taxi_rides_ny.payment_type_lookup)
[0m21:19:10.877779 [debug] [Thread-1 (]: Began compiling node seed.taxi_rides_ny.payment_type_lookup
[0m21:19:10.878062 [debug] [Thread-1 (]: Began executing node seed.taxi_rides_ny.payment_type_lookup
[0m21:19:10.898120 [debug] [Thread-1 (]: Using duckdb connection "seed.taxi_rides_ny.payment_type_lookup"
[0m21:19:10.898566 [debug] [Thread-1 (]: On seed.taxi_rides_ny.payment_type_lookup: BEGIN
[0m21:19:10.898852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:10.899966 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:19:10.900252 [debug] [Thread-1 (]: Using duckdb connection "seed.taxi_rides_ny.payment_type_lookup"
[0m21:19:10.900653 [debug] [Thread-1 (]: On seed.taxi_rides_ny.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "seed.taxi_rides_ny.payment_type_lookup"} */

    create table "taxi_rides_ny"."dev"."payment_type_lookup" ("payment_type" integer,"description" text)
  
[0m21:19:10.901338 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:19:10.910777 [debug] [Thread-1 (]: Using duckdb connection "seed.taxi_rides_ny.payment_type_lookup"
[0m21:19:10.911144 [debug] [Thread-1 (]: On seed.taxi_rides_ny.payment_type_lookup: 
          COPY "taxi_rides_ny"."dev"."payment_type_lookup" FROM '/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/seeds/payment_type_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m21:19:10.915066 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:19:10.919192 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.taxi_rides_ny.payment_type_lookup"
[0m21:19:10.928777 [debug] [Thread-1 (]: On seed.taxi_rides_ny.payment_type_lookup: COMMIT
[0m21:19:10.929095 [debug] [Thread-1 (]: Using duckdb connection "seed.taxi_rides_ny.payment_type_lookup"
[0m21:19:10.929376 [debug] [Thread-1 (]: On seed.taxi_rides_ny.payment_type_lookup: COMMIT
[0m21:19:10.933146 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:19:10.934685 [debug] [Thread-1 (]: On seed.taxi_rides_ny.payment_type_lookup: Close
[0m21:19:10.935775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99fe4a19-a1d8-4bed-98a8-b83f8a141907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70df2638e570>]}
[0m21:19:10.936178 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file dev.payment_type_lookup ............................. [[32mINSERT 7[0m in 0.06s]
[0m21:19:10.936695 [debug] [Thread-1 (]: Finished running node seed.taxi_rides_ny.payment_type_lookup
[0m21:19:10.937018 [debug] [Thread-1 (]: Began running node seed.taxi_rides_ny.taxi_zone_lookup
[0m21:19:10.937488 [info ] [Thread-1 (]: 2 of 2 START seed file dev.taxi_zone_lookup .................................... [RUN]
[0m21:19:10.937873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.taxi_rides_ny.payment_type_lookup, now seed.taxi_rides_ny.taxi_zone_lookup)
[0m21:19:10.938169 [debug] [Thread-1 (]: Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
[0m21:19:10.938470 [debug] [Thread-1 (]: Began executing node seed.taxi_rides_ny.taxi_zone_lookup
[0m21:19:10.942636 [debug] [Thread-1 (]: Using duckdb connection "seed.taxi_rides_ny.taxi_zone_lookup"
[0m21:19:10.942982 [debug] [Thread-1 (]: On seed.taxi_rides_ny.taxi_zone_lookup: BEGIN
[0m21:19:10.943266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:10.944687 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:19:10.944989 [debug] [Thread-1 (]: Using duckdb connection "seed.taxi_rides_ny.taxi_zone_lookup"
[0m21:19:10.945276 [debug] [Thread-1 (]: On seed.taxi_rides_ny.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "seed.taxi_rides_ny.taxi_zone_lookup"} */

    create table "taxi_rides_ny"."dev"."taxi_zone_lookup" ("locationid" integer,"borough" text,"zone" text,"service_zone" text)
  
[0m21:19:10.945981 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:19:10.946865 [debug] [Thread-1 (]: Using duckdb connection "seed.taxi_rides_ny.taxi_zone_lookup"
[0m21:19:10.947165 [debug] [Thread-1 (]: On seed.taxi_rides_ny.taxi_zone_lookup: 
          COPY "taxi_rides_ny"."dev"."taxi_zone_lookup" FROM '/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/seeds/taxi_zone_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m21:19:10.950612 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:19:10.951168 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.taxi_rides_ny.taxi_zone_lookup"
[0m21:19:10.952563 [debug] [Thread-1 (]: On seed.taxi_rides_ny.taxi_zone_lookup: COMMIT
[0m21:19:10.953112 [debug] [Thread-1 (]: Using duckdb connection "seed.taxi_rides_ny.taxi_zone_lookup"
[0m21:19:10.953570 [debug] [Thread-1 (]: On seed.taxi_rides_ny.taxi_zone_lookup: COMMIT
[0m21:19:10.957862 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:19:10.958567 [debug] [Thread-1 (]: On seed.taxi_rides_ny.taxi_zone_lookup: Close
[0m21:19:10.959017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99fe4a19-a1d8-4bed-98a8-b83f8a141907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70df242a8370>]}
[0m21:19:10.959481 [info ] [Thread-1 (]: 2 of 2 OK loaded seed file dev.taxi_zone_lookup ................................ [[32mINSERT 265[0m in 0.02s]
[0m21:19:10.959969 [debug] [Thread-1 (]: Finished running node seed.taxi_rides_ny.taxi_zone_lookup
[0m21:19:10.961275 [debug] [MainThread]: Using duckdb connection "master"
[0m21:19:10.961565 [debug] [MainThread]: On master: BEGIN
[0m21:19:10.961804 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:19:10.963075 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:19:10.963421 [debug] [MainThread]: On master: COMMIT
[0m21:19:10.963733 [debug] [MainThread]: Using duckdb connection "master"
[0m21:19:10.963977 [debug] [MainThread]: On master: COMMIT
[0m21:19:10.964450 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:19:10.964728 [debug] [MainThread]: On master: Close
[0m21:19:10.965090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:19:10.965383 [debug] [MainThread]: Connection 'seed.taxi_rides_ny.taxi_zone_lookup' was properly closed.
[0m21:19:10.965689 [info ] [MainThread]: 
[0m21:19:10.966020 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m21:19:10.966797 [debug] [MainThread]: Command end result
[0m21:19:10.995185 [debug] [MainThread]: Wrote artifact WritableManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/manifest.json
[0m21:19:10.996624 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/semantic_manifest.json
[0m21:19:11.000614 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/run_results.json
[0m21:19:11.000869 [info ] [MainThread]: 
[0m21:19:11.001178 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:19:11.001446 [info ] [MainThread]: 
[0m21:19:11.001730 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m21:19:11.002438 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 2.163882, "process_in_blocks": "360", "process_kernel_time": 0.127146, "process_mem_max_rss": "169000", "process_out_blocks": "5144", "process_user_time": 2.960413}
[0m21:19:11.002797 [debug] [MainThread]: Command `dbt seed` succeeded at 21:19:11.002719 after 2.16 seconds
[0m21:19:11.003085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70df262bc0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70df2621aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70df5f69a120>]}
[0m21:19:11.003382 [debug] [MainThread]: Flushing usage events
[0m21:19:11.818226 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:29:44.178290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7010aa6706e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7010a9737ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7010a9737b10>]}


============================== 21:29:44.180545 | 278f226a-6ff8-45ea-91e6-530ab49071a4 ==============================
[0m21:29:44.180545 [info ] [MainThread]: Running with dbt=1.11.6
[0m21:29:44.181274 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'warn_error': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'quiet': 'False', 'empty': 'False', 'invocation_command': 'dbt build', 'log_format': 'default', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'no_print': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'version_check': 'True', 'debug': 'False', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': '/home/roy/.dbt', 'log_path': '/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/logs'}
[0m21:29:44.357743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '278f226a-6ff8-45ea-91e6-530ab49071a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7010aa618fc0>]}
[0m21:29:44.407696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '278f226a-6ff8-45ea-91e6-530ab49071a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7010a979a140>]}
[0m21:29:44.408823 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m21:29:44.465767 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m21:29:44.567392 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:29:44.567692 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:29:44.567922 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:29:44.608884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '278f226a-6ff8-45ea-91e6-530ab49071a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70109fa54350>]}
[0m21:29:44.726164 [debug] [MainThread]: Wrote artifact WritableManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/manifest.json
[0m21:29:44.727451 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/semantic_manifest.json
[0m21:29:44.748171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '278f226a-6ff8-45ea-91e6-530ab49071a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7010ac8a0050>]}
[0m21:29:44.748574 [info ] [MainThread]: Found 8 models, 2 seeds, 36 data tests, 2 sources, 619 macros
[0m21:29:44.751562 [info ] [MainThread]: 
[0m21:29:44.751927 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:29:44.752277 [info ] [MainThread]: 
[0m21:29:44.752774 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:29:44.758606 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m21:29:44.784042 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m21:29:44.784406 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"taxi_rides_ny"'
    
  
  
[0m21:29:44.784781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:44.795577 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m21:29:44.796637 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m21:29:44.797159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_dev)
[0m21:29:44.797576 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "dev"
"
[0m21:29:44.802060 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m21:29:44.802333 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='taxi_rides_ny'
        and type='sqlite'
    
  
[0m21:29:44.802596 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:44.803649 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:29:44.804596 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m21:29:44.804867 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: BEGIN
[0m21:29:44.805360 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:29:44.805640 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m21:29:44.805891 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
    
        create schema if not exists "taxi_rides_ny"."dev"
    
[0m21:29:44.806372 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:29:44.807030 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m21:29:44.807296 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m21:29:44.807628 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m21:29:44.808052 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:29:44.808336 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: Close
[0m21:29:44.809879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_dev, now list_taxi_rides_ny_dev)
[0m21:29:44.813873 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m21:29:44.814133 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: BEGIN
[0m21:29:44.814406 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:44.815386 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:29:44.815664 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m21:29:44.815919 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "connection_name": "list_taxi_rides_ny_dev"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev'
    and lower(table_catalog) = 'taxi_rides_ny'
  
[0m21:29:44.824642 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m21:29:44.825561 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: ROLLBACK
[0m21:29:44.826211 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_dev'
[0m21:29:44.826503 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: Close
[0m21:29:44.827298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '278f226a-6ff8-45ea-91e6-530ab49071a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70109f75d8d0>]}
[0m21:29:44.827662 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:44.827913 [debug] [MainThread]: On master: BEGIN
[0m21:29:44.828151 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:29:44.829097 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:29:44.829373 [debug] [MainThread]: On master: COMMIT
[0m21:29:44.829641 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:44.829876 [debug] [MainThread]: On master: COMMIT
[0m21:29:44.830308 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:29:44.830563 [debug] [MainThread]: On master: Close
[0m21:29:44.831992 [debug] [Thread-1 (]: Began running node seed.taxi_rides_ny.payment_type_lookup
[0m21:29:44.832380 [info ] [Thread-1 (]: 1 of 46 START seed file dev.payment_type_lookup ................................ [RUN]
[0m21:29:44.832726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_taxi_rides_ny_dev, now seed.taxi_rides_ny.payment_type_lookup)
[0m21:29:44.833014 [debug] [Thread-1 (]: Began compiling node seed.taxi_rides_ny.payment_type_lookup
[0m21:29:44.833302 [debug] [Thread-1 (]: Began executing node seed.taxi_rides_ny.payment_type_lookup
[0m21:29:44.857032 [debug] [Thread-1 (]: Using duckdb connection "seed.taxi_rides_ny.payment_type_lookup"
[0m21:29:44.857388 [debug] [Thread-1 (]: On seed.taxi_rides_ny.payment_type_lookup: BEGIN
[0m21:29:44.857685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:44.859066 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:29:44.859397 [debug] [Thread-1 (]: Using duckdb connection "seed.taxi_rides_ny.payment_type_lookup"
[0m21:29:44.859736 [debug] [Thread-1 (]: On seed.taxi_rides_ny.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "seed.taxi_rides_ny.payment_type_lookup"} */
truncate table "taxi_rides_ny"."dev"."payment_type_lookup"
[0m21:29:44.860503 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:29:44.868335 [debug] [Thread-1 (]: Using duckdb connection "seed.taxi_rides_ny.payment_type_lookup"
[0m21:29:44.868813 [debug] [Thread-1 (]: On seed.taxi_rides_ny.payment_type_lookup: 
          COPY "taxi_rides_ny"."dev"."payment_type_lookup" FROM '/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/seeds/payment_type_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m21:29:44.871923 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:29:44.875808 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.taxi_rides_ny.payment_type_lookup"
[0m21:29:44.882869 [debug] [Thread-1 (]: On seed.taxi_rides_ny.payment_type_lookup: COMMIT
[0m21:29:44.883174 [debug] [Thread-1 (]: Using duckdb connection "seed.taxi_rides_ny.payment_type_lookup"
[0m21:29:44.883489 [debug] [Thread-1 (]: On seed.taxi_rides_ny.payment_type_lookup: COMMIT
[0m21:29:44.887707 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:29:44.889221 [debug] [Thread-1 (]: On seed.taxi_rides_ny.payment_type_lookup: Close
[0m21:29:44.890318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '278f226a-6ff8-45ea-91e6-530ab49071a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70109d46b110>]}
[0m21:29:44.890729 [info ] [Thread-1 (]: 1 of 46 OK loaded seed file dev.payment_type_lookup ............................ [[32mINSERT 7[0m in 0.06s]
[0m21:29:44.891263 [debug] [Thread-1 (]: Finished running node seed.taxi_rides_ny.payment_type_lookup
[0m21:29:44.891703 [debug] [Thread-1 (]: Began running node seed.taxi_rides_ny.taxi_zone_lookup
[0m21:29:44.892077 [info ] [Thread-1 (]: 2 of 46 START seed file dev.taxi_zone_lookup ................................... [RUN]
[0m21:29:44.892586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.taxi_rides_ny.payment_type_lookup, now seed.taxi_rides_ny.taxi_zone_lookup)
[0m21:29:44.892883 [debug] [Thread-1 (]: Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
[0m21:29:44.893200 [debug] [Thread-1 (]: Began executing node seed.taxi_rides_ny.taxi_zone_lookup
[0m21:29:44.901736 [debug] [Thread-1 (]: Using duckdb connection "seed.taxi_rides_ny.taxi_zone_lookup"
[0m21:29:44.902291 [debug] [Thread-1 (]: On seed.taxi_rides_ny.taxi_zone_lookup: BEGIN
[0m21:29:44.902895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:44.904536 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:29:44.904910 [debug] [Thread-1 (]: Using duckdb connection "seed.taxi_rides_ny.taxi_zone_lookup"
[0m21:29:44.905223 [debug] [Thread-1 (]: On seed.taxi_rides_ny.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "seed.taxi_rides_ny.taxi_zone_lookup"} */
truncate table "taxi_rides_ny"."dev"."taxi_zone_lookup"
[0m21:29:44.905996 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:29:44.906921 [debug] [Thread-1 (]: Using duckdb connection "seed.taxi_rides_ny.taxi_zone_lookup"
[0m21:29:44.907219 [debug] [Thread-1 (]: On seed.taxi_rides_ny.taxi_zone_lookup: 
          COPY "taxi_rides_ny"."dev"."taxi_zone_lookup" FROM '/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/seeds/taxi_zone_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m21:29:44.909989 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:29:44.910465 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.taxi_rides_ny.taxi_zone_lookup"
[0m21:29:44.911536 [debug] [Thread-1 (]: On seed.taxi_rides_ny.taxi_zone_lookup: COMMIT
[0m21:29:44.911867 [debug] [Thread-1 (]: Using duckdb connection "seed.taxi_rides_ny.taxi_zone_lookup"
[0m21:29:44.912309 [debug] [Thread-1 (]: On seed.taxi_rides_ny.taxi_zone_lookup: COMMIT
[0m21:29:44.916932 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:29:44.917779 [debug] [Thread-1 (]: On seed.taxi_rides_ny.taxi_zone_lookup: Close
[0m21:29:44.918206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '278f226a-6ff8-45ea-91e6-530ab49071a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70109c0cc1d0>]}
[0m21:29:44.918694 [info ] [Thread-1 (]: 2 of 46 OK loaded seed file dev.taxi_zone_lookup ............................... [[32mINSERT 265[0m in 0.03s]
[0m21:29:44.919236 [debug] [Thread-1 (]: Finished running node seed.taxi_rides_ny.taxi_zone_lookup
[0m21:29:44.919625 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190
[0m21:29:44.919954 [info ] [Thread-1 (]: 3 of 46 START test source_not_null_raw_green_tripdata_lpep_pickup_datetime ..... [RUN]
[0m21:29:44.920547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.taxi_rides_ny.taxi_zone_lookup, now test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190)
[0m21:29:44.920854 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190
[0m21:29:44.936960 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190"
[0m21:29:44.937594 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190
[0m21:29:44.949530 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190"
[0m21:29:44.950081 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190"
[0m21:29:44.950387 [debug] [Thread-1 (]: On test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190: BEGIN
[0m21:29:44.950737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:44.952217 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:29:44.952615 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190"
[0m21:29:44.952911 [debug] [Thread-1 (]: On test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select lpep_pickup_datetime
from "taxi_rides_ny"."prod"."green_tripdata"
where lpep_pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m21:29:44.953538 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Catalog Error: Table with name green_tripdata does not exist!
Did you mean "information_schema.referential_constraints"?

LINE 17: from "taxi_rides_ny"."prod"."green_tripdata"
              ^
[0m21:29:44.953852 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select lpep_pickup_datetime
from "taxi_rides_ny"."prod"."green_tripdata"
where lpep_pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m21:29:44.954155 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:29:44.954456 [debug] [Thread-1 (]: On test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190: ROLLBACK
[0m21:29:44.955512 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190'
[0m21:29:44.955907 [debug] [Thread-1 (]: On test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190: Close
[0m21:29:44.960175 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_green_tripdata_lpep_pickup_datetime (models/staging/sources.yml)
  Catalog Error: Table with name green_tripdata does not exist!
  Did you mean "information_schema.referential_constraints"?
  
  LINE 17: from "taxi_rides_ny"."prod"."green_tripdata"
                ^
[0m21:29:44.960615 [error] [Thread-1 (]: 3 of 46 ERROR source_not_null_raw_green_tripdata_lpep_pickup_datetime .......... [[31mERROR[0m in 0.04s]
[0m21:29:44.961112 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190
[0m21:29:44.961513 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf
[0m21:29:44.961934 [info ] [Thread-1 (]: 4 of 46 START test source_not_null_raw_yellow_tripdata_tpep_pickup_datetime .... [RUN]
[0m21:29:44.962555 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_green_tripdata_lpep_pickup_datetime (models/staging/sources.yml)
  Catalog Error: Table with name green_tripdata does not exist!
  Did you mean "information_schema.referential_constraints"?
  
  LINE 17: from "taxi_rides_ny"."prod"."green_tripdata"
                ^.
[0m21:29:44.962924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190, now test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf)
[0m21:29:44.963739 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf
[0m21:29:44.967099 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf"
[0m21:29:44.967748 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf
[0m21:29:44.970303 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf"
[0m21:29:44.971019 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf"
[0m21:29:44.971541 [debug] [Thread-1 (]: On test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf: BEGIN
[0m21:29:44.972093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:44.973616 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:29:44.974098 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf"
[0m21:29:44.974661 [debug] [Thread-1 (]: On test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select tpep_pickup_datetime
from "taxi_rides_ny"."prod"."yellow_tripdata"
where tpep_pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m21:29:44.975604 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Catalog Error: Table with name yellow_tripdata does not exist!
Did you mean "information_schema.table_constraints"?

LINE 17: from "taxi_rides_ny"."prod"."yellow_tripdata"
              ^
[0m21:29:44.976309 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select tpep_pickup_datetime
from "taxi_rides_ny"."prod"."yellow_tripdata"
where tpep_pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m21:29:44.976793 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:29:44.977181 [debug] [Thread-1 (]: On test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf: ROLLBACK
[0m21:29:44.978100 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf'
[0m21:29:44.978613 [debug] [Thread-1 (]: On test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf: Close
[0m21:29:44.981710 [debug] [Thread-1 (]: Runtime Error in test source_not_null_raw_yellow_tripdata_tpep_pickup_datetime (models/staging/sources.yml)
  Catalog Error: Table with name yellow_tripdata does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "taxi_rides_ny"."prod"."yellow_tripdata"
                ^
[0m21:29:44.982227 [error] [Thread-1 (]: 4 of 46 ERROR source_not_null_raw_yellow_tripdata_tpep_pickup_datetime ......... [[31mERROR[0m in 0.02s]
[0m21:29:44.982894 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf
[0m21:29:44.983279 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4
[0m21:29:44.983682 [info ] [Thread-1 (]: 5 of 46 START test not_null_payment_type_lookup_payment_type ................... [RUN]
[0m21:29:44.984113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf, now test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4)
[0m21:29:44.984553 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_raw_yellow_tripdata_tpep_pickup_datetime (models/staging/sources.yml)
  Catalog Error: Table with name yellow_tripdata does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "taxi_rides_ny"."prod"."yellow_tripdata"
                ^.
[0m21:29:44.984898 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4
[0m21:29:44.988742 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4"
[0m21:29:44.989449 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4
[0m21:29:44.990944 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4"
[0m21:29:44.991437 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4"
[0m21:29:44.991763 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4: BEGIN
[0m21:29:44.992195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:44.993617 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:29:44.994119 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4"
[0m21:29:44.994590 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type
from "taxi_rides_ny"."dev"."payment_type_lookup"
where payment_type is null



  
  
      
    ) dbt_internal_test
[0m21:29:44.995804 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:29:44.999311 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4: ROLLBACK
[0m21:29:44.999842 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4'
[0m21:29:45.000170 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4: Close
[0m21:29:45.000705 [info ] [Thread-1 (]: 5 of 46 PASS not_null_payment_type_lookup_payment_type ......................... [[32mPASS[0m in 0.02s]
[0m21:29:45.001211 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4
[0m21:29:45.001593 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245
[0m21:29:45.002088 [info ] [Thread-1 (]: 6 of 46 START test unique_payment_type_lookup_payment_type ..................... [RUN]
[0m21:29:45.002643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4, now test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245)
[0m21:29:45.003056 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245
[0m21:29:45.008250 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245"
[0m21:29:45.008722 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245
[0m21:29:45.010437 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245"
[0m21:29:45.010919 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245"
[0m21:29:45.011219 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245: BEGIN
[0m21:29:45.011551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:45.013099 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:29:45.013724 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245"
[0m21:29:45.014187 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type as unique_field,
    count(*) as n_records

from "taxi_rides_ny"."dev"."payment_type_lookup"
where payment_type is not null
group by payment_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:29:45.015962 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:29:45.017827 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245: ROLLBACK
[0m21:29:45.018595 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245'
[0m21:29:45.019081 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245: Close
[0m21:29:45.019804 [info ] [Thread-1 (]: 6 of 46 PASS unique_payment_type_lookup_payment_type ........................... [[32mPASS[0m in 0.02s]
[0m21:29:45.020369 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245
[0m21:29:45.020810 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dim_zones
[0m21:29:45.021288 [info ] [Thread-1 (]: 7 of 46 START sql table model dev.dim_zones .................................... [RUN]
[0m21:29:45.021808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245, now model.taxi_rides_ny.dim_zones)
[0m21:29:45.022228 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m21:29:45.024747 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m21:29:45.025444 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m21:29:45.049438 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m21:29:45.050068 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.dim_zones"
[0m21:29:45.050370 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: BEGIN
[0m21:29:45.050703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:45.052099 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:29:45.052527 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.dim_zones"
[0m21:29:45.052879 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    
    

    create  table
      "taxi_rides_ny"."dev"."dim_zones__dbt_tmp"
  
    as (
      -- Dimension table for NYC taxi zones
-- This is a simple pass-through from the seed file, but having it as a model
-- allows for future enhancements (e.g., adding calculated fields, filtering)

select
    locationid as location_id,
    borough,
    zone,
    service_zone
from "taxi_rides_ny"."dev"."taxi_zone_lookup"
    );
  
  
[0m21:29:45.054108 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:29:45.058437 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.dim_zones"
[0m21:29:45.058753 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */
alter table "taxi_rides_ny"."dev"."dim_zones__dbt_tmp" rename to "dim_zones"
[0m21:29:45.059519 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:29:45.063274 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: COMMIT
[0m21:29:45.063709 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.dim_zones"
[0m21:29:45.064006 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: COMMIT
[0m21:29:45.068923 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:29:45.073755 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.dim_zones"
[0m21:29:45.074116 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

      drop table if exists "taxi_rides_ny"."dev"."dim_zones__dbt_backup" cascade
    
[0m21:29:45.074812 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:29:45.075896 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: Close
[0m21:29:45.076334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '278f226a-6ff8-45ea-91e6-530ab49071a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70109f616200>]}
[0m21:29:45.076884 [info ] [Thread-1 (]: 7 of 46 OK created sql table model dev.dim_zones ............................... [[32mOK[0m in 0.05s]
[0m21:29:45.077343 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m21:29:45.077709 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_green_tripdata
[0m21:29:45.078030 [info ] [Thread-1 (]: 8 of 46 SKIP relation dev.stg_green_tripdata ................................... [[33mSKIP[0m]
[0m21:29:45.078475 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_green_tripdata
[0m21:29:45.078794 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_yellow_tripdata
[0m21:29:45.079491 [debug] [Thread-4 (]: Marking all children of 'model.taxi_rides_ny.stg_green_tripdata' to be skipped because of status 'skipped'. 
[0m21:29:45.079108 [info ] [Thread-1 (]: 9 of 46 SKIP relation dev.stg_yellow_tripdata .................................. [[33mSKIP[0m]
[0m21:29:45.080143 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_yellow_tripdata
[0m21:29:45.080534 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79
[0m21:29:45.080842 [debug] [Thread-4 (]: Marking all children of 'model.taxi_rides_ny.stg_yellow_tripdata' to be skipped because of status 'skipped'. 
[0m21:29:45.081185 [info ] [Thread-1 (]: 10 of 46 START test not_null_dim_zones_location_id ............................. [RUN]
[0m21:29:45.082075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.dim_zones, now test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79)
[0m21:29:45.082484 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79
[0m21:29:45.085593 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79"
[0m21:29:45.086093 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79
[0m21:29:45.088698 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79"
[0m21:29:45.089220 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79"
[0m21:29:45.089591 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79: BEGIN
[0m21:29:45.089880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:45.091033 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:29:45.091354 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79"
[0m21:29:45.091693 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "taxi_rides_ny"."dev"."dim_zones"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m21:29:45.092705 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:29:45.093965 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79: ROLLBACK
[0m21:29:45.094454 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79'
[0m21:29:45.094754 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79: Close
[0m21:29:45.095220 [info ] [Thread-1 (]: 10 of 46 PASS not_null_dim_zones_location_id ................................... [[32mPASS[0m in 0.01s]
[0m21:29:45.095749 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79
[0m21:29:45.096076 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27
[0m21:29:45.096431 [info ] [Thread-1 (]: 11 of 46 START test unique_dim_zones_location_id ............................... [RUN]
[0m21:29:45.096822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79, now test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27)
[0m21:29:45.097128 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27
[0m21:29:45.099879 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27"
[0m21:29:45.100336 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27
[0m21:29:45.102358 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27"
[0m21:29:45.102899 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27"
[0m21:29:45.103209 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27: BEGIN
[0m21:29:45.103542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:45.104546 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:29:45.104848 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27"
[0m21:29:45.105178 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "taxi_rides_ny"."dev"."dim_zones"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:29:45.106562 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:29:45.108175 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27: ROLLBACK
[0m21:29:45.108691 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27'
[0m21:29:45.108985 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27: Close
[0m21:29:45.109510 [info ] [Thread-1 (]: 11 of 46 PASS unique_dim_zones_location_id ..................................... [[32mPASS[0m in 0.01s]
[0m21:29:45.110027 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27
[0m21:29:45.110388 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e
[0m21:29:45.110889 [info ] [Thread-1 (]: 12 of 46 SKIP test not_null_stg_green_tripdata_pickup_datetime ................. [[33mSKIP[0m]
[0m21:29:45.111289 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e
[0m21:29:45.111681 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493
[0m21:29:45.112007 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e' to be skipped because of status 'skipped'. 
[0m21:29:45.112369 [info ] [Thread-1 (]: 13 of 46 SKIP test not_null_stg_green_tripdata_vendor_id ....................... [[33mSKIP[0m]
[0m21:29:45.112963 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493
[0m21:29:45.113301 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m21:29:45.113632 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493' to be skipped because of status 'skipped'. 
[0m21:29:45.113978 [info ] [Thread-1 (]: 14 of 46 SKIP test not_null_stg_yellow_tripdata_pickup_datetime ................ [[33mSKIP[0m]
[0m21:29:45.114488 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m21:29:45.114814 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751
[0m21:29:45.115081 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44' to be skipped because of status 'skipped'. 
[0m21:29:45.115471 [info ] [Thread-1 (]: 15 of 46 SKIP test not_null_stg_yellow_tripdata_vendor_id ...................... [[33mSKIP[0m]
[0m21:29:45.116072 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751
[0m21:29:45.116377 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751' to be skipped because of status 'skipped'. 
[0m21:29:45.117059 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.int_trips_unioned
[0m21:29:45.117375 [info ] [Thread-1 (]: 16 of 46 SKIP relation dev.int_trips_unioned ................................... [[33mSKIP[0m]
[0m21:29:45.117792 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.int_trips_unioned
[0m21:29:45.118081 [debug] [Thread-4 (]: Marking all children of 'model.taxi_rides_ny.int_trips_unioned' to be skipped because of status 'skipped'. 
[0m21:29:45.118646 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.int_trips
[0m21:29:45.118970 [info ] [Thread-1 (]: 17 of 46 SKIP relation dev.int_trips ........................................... [[33mSKIP[0m]
[0m21:29:45.119369 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.int_trips
[0m21:29:45.119733 [debug] [Thread-4 (]: Marking all children of 'model.taxi_rides_ny.int_trips' to be skipped because of status 'skipped'. 
[0m21:29:45.120346 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e
[0m21:29:45.120718 [info ] [Thread-1 (]: 18 of 46 SKIP test accepted_values_int_trips_service_type__Green__Yellow ....... [[33mSKIP[0m]
[0m21:29:45.121181 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e
[0m21:29:45.121552 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09
[0m21:29:45.121874 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e' to be skipped because of status 'skipped'. 
[0m21:29:45.122238 [info ] [Thread-1 (]: 19 of 46 SKIP test not_null_int_trips_pickup_datetime .......................... [[33mSKIP[0m]
[0m21:29:45.122877 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09
[0m21:29:45.123228 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53
[0m21:29:45.123573 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09' to be skipped because of status 'skipped'. 
[0m21:29:45.123968 [info ] [Thread-1 (]: 20 of 46 SKIP test not_null_int_trips_service_type ............................. [[33mSKIP[0m]
[0m21:29:45.124510 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53
[0m21:29:45.124846 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b
[0m21:29:45.125124 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53' to be skipped because of status 'skipped'. 
[0m21:29:45.125451 [info ] [Thread-1 (]: 21 of 46 SKIP test not_null_int_trips_total_amount ............................. [[33mSKIP[0m]
[0m21:29:45.125952 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b
[0m21:29:45.126312 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61
[0m21:29:45.126622 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b' to be skipped because of status 'skipped'. 
[0m21:29:45.126980 [info ] [Thread-1 (]: 22 of 46 SKIP test not_null_int_trips_trip_id .................................. [[33mSKIP[0m]
[0m21:29:45.127512 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61
[0m21:29:45.127842 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c
[0m21:29:45.128114 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61' to be skipped because of status 'skipped'. 
[0m21:29:45.128520 [info ] [Thread-1 (]: 23 of 46 SKIP test not_null_int_trips_vendor_id ................................ [[33mSKIP[0m]
[0m21:29:45.129165 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c
[0m21:29:45.129523 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f
[0m21:29:45.129818 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c' to be skipped because of status 'skipped'. 
[0m21:29:45.130145 [info ] [Thread-1 (]: 24 of 46 SKIP test unique_int_trips_trip_id .................................... [[33mSKIP[0m]
[0m21:29:45.130790 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f
[0m21:29:45.131165 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f' to be skipped because of status 'skipped'. 
[0m21:29:45.131875 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_trips
[0m21:29:45.132275 [info ] [Thread-1 (]: 25 of 46 SKIP relation dev.fct_trips ........................................... [[33mSKIP[0m]
[0m21:29:45.132716 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_trips
[0m21:29:45.133086 [debug] [Thread-4 (]: Marking all children of 'model.taxi_rides_ny.fct_trips' to be skipped because of status 'skipped'. 
[0m21:29:45.133881 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39
[0m21:29:45.134280 [info ] [Thread-1 (]: 26 of 46 SKIP test accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6 . [[33mSKIP[0m]
[0m21:29:45.134734 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39
[0m21:29:45.135084 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c
[0m21:29:45.135362 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39' to be skipped because of status 'skipped'. 
[0m21:29:45.135810 [info ] [Thread-1 (]: 27 of 46 SKIP test accepted_values_fct_trips_service_type__Green__Yellow ....... [[33mSKIP[0m]
[0m21:29:45.136382 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c
[0m21:29:45.136812 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83
[0m21:29:45.137112 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c' to be skipped because of status 'skipped'. 
[0m21:29:45.137498 [info ] [Thread-1 (]: 28 of 46 SKIP test not_null_fct_trips_pickup_datetime .......................... [[33mSKIP[0m]
[0m21:29:45.138042 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83
[0m21:29:45.138408 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f
[0m21:29:45.138721 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83' to be skipped because of status 'skipped'. 
[0m21:29:45.139078 [info ] [Thread-1 (]: 29 of 46 SKIP test not_null_fct_trips_service_type ............................. [[33mSKIP[0m]
[0m21:29:45.139645 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f
[0m21:29:45.140000 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d
[0m21:29:45.140288 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f' to be skipped because of status 'skipped'. 
[0m21:29:45.140783 [info ] [Thread-1 (]: 30 of 46 SKIP test not_null_fct_trips_total_amount ............................. [[33mSKIP[0m]
[0m21:29:45.141535 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d
[0m21:29:45.142112 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d
[0m21:29:45.142583 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d' to be skipped because of status 'skipped'. 
[0m21:29:45.143027 [info ] [Thread-1 (]: 31 of 46 SKIP test not_null_fct_trips_trip_id .................................. [[33mSKIP[0m]
[0m21:29:45.143743 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d
[0m21:29:45.144238 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb
[0m21:29:45.144672 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d' to be skipped because of status 'skipped'. 
[0m21:29:45.145058 [info ] [Thread-1 (]: 32 of 46 SKIP test not_null_fct_trips_vendor_id ................................ [[33mSKIP[0m]
[0m21:29:45.145716 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb
[0m21:29:45.146217 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68
[0m21:29:45.146712 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb' to be skipped because of status 'skipped'. 
[0m21:29:45.147130 [info ] [Thread-1 (]: 33 of 46 SKIP test relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_  [[33mSKIP[0m]
[0m21:29:45.147957 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68
[0m21:29:45.148532 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4
[0m21:29:45.148865 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68' to be skipped because of status 'skipped'. 
[0m21:29:45.149235 [info ] [Thread-1 (]: 34 of 46 SKIP test relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_  [[33mSKIP[0m]
[0m21:29:45.149760 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4
[0m21:29:45.150103 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab
[0m21:29:45.150390 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4' to be skipped because of status 'skipped'. 
[0m21:29:45.150785 [info ] [Thread-1 (]: 35 of 46 SKIP test unique_fct_trips_trip_id .................................... [[33mSKIP[0m]
[0m21:29:45.151289 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab
[0m21:29:45.151698 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab' to be skipped because of status 'skipped'. 
[0m21:29:45.152447 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dim_vendors
[0m21:29:45.153009 [info ] [Thread-1 (]: 36 of 46 SKIP relation dev.dim_vendors ......................................... [[33mSKIP[0m]
[0m21:29:45.153608 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dim_vendors
[0m21:29:45.154145 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_monthly_zone_revenue
[0m21:29:45.154590 [debug] [Thread-4 (]: Marking all children of 'model.taxi_rides_ny.dim_vendors' to be skipped because of status 'skipped'. 
[0m21:29:45.154993 [info ] [Thread-1 (]: 37 of 46 SKIP relation dev.fct_monthly_zone_revenue ............................ [[33mSKIP[0m]
[0m21:29:45.155679 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_monthly_zone_revenue
[0m21:29:45.156019 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580
[0m21:29:45.156318 [debug] [Thread-4 (]: Marking all children of 'model.taxi_rides_ny.fct_monthly_zone_revenue' to be skipped because of status 'skipped'. 
[0m21:29:45.156777 [info ] [Thread-1 (]: 38 of 46 SKIP test not_null_dim_vendors_vendor_id .............................. [[33mSKIP[0m]
[0m21:29:45.157580 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580
[0m21:29:45.157979 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141
[0m21:29:45.158264 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580' to be skipped because of status 'skipped'. 
[0m21:29:45.158849 [info ] [Thread-1 (]: 39 of 46 SKIP test unique_dim_vendors_vendor_id ................................ [[33mSKIP[0m]
[0m21:29:45.159444 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141
[0m21:29:45.159847 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6
[0m21:29:45.160204 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141' to be skipped because of status 'skipped'. 
[0m21:29:45.160548 [info ] [Thread-1 (]: 40 of 46 SKIP test accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow  [[33mSKIP[0m]
[0m21:29:45.161019 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6
[0m21:29:45.161351 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751
[0m21:29:45.161639 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6' to be skipped because of status 'skipped'. 
[0m21:29:45.162012 [info ] [Thread-1 (]: 41 of 46 SKIP test dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type  [[33mSKIP[0m]
[0m21:29:45.162498 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751
[0m21:29:45.162971 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709
[0m21:29:45.163300 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751' to be skipped because of status 'skipped'. 
[0m21:29:45.163680 [info ] [Thread-1 (]: 42 of 46 SKIP test not_null_fct_monthly_zone_revenue_pickup_zone ............... [[33mSKIP[0m]
[0m21:29:45.164216 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709
[0m21:29:45.164586 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100
[0m21:29:45.164868 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709' to be skipped because of status 'skipped'. 
[0m21:29:45.165201 [info ] [Thread-1 (]: 43 of 46 SKIP test not_null_fct_monthly_zone_revenue_revenue_month ............. [[33mSKIP[0m]
[0m21:29:45.165699 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100
[0m21:29:45.166047 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe
[0m21:29:45.166339 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100' to be skipped because of status 'skipped'. 
[0m21:29:45.166846 [info ] [Thread-1 (]: 44 of 46 SKIP test not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount  [[33mSKIP[0m]
[0m21:29:45.167469 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe
[0m21:29:45.167803 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7
[0m21:29:45.168080 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe' to be skipped because of status 'skipped'. 
[0m21:29:45.168404 [info ] [Thread-1 (]: 45 of 46 SKIP test not_null_fct_monthly_zone_revenue_service_type .............. [[33mSKIP[0m]
[0m21:29:45.168840 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7
[0m21:29:45.169157 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413
[0m21:29:45.169438 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7' to be skipped because of status 'skipped'. 
[0m21:29:45.169762 [info ] [Thread-1 (]: 46 of 46 SKIP test not_null_fct_monthly_zone_revenue_total_monthly_trips ....... [[33mSKIP[0m]
[0m21:29:45.170166 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413
[0m21:29:45.170463 [debug] [Thread-4 (]: Marking all children of 'test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413' to be skipped because of status 'skipped'. 
[0m21:29:45.171474 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:45.171924 [debug] [MainThread]: On master: BEGIN
[0m21:29:45.172215 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:29:45.173374 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:29:45.173773 [debug] [MainThread]: On master: COMMIT
[0m21:29:45.174053 [debug] [MainThread]: Using duckdb connection "master"
[0m21:29:45.174314 [debug] [MainThread]: On master: COMMIT
[0m21:29:45.174725 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:29:45.175004 [debug] [MainThread]: On master: Close
[0m21:29:45.175356 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:45.175619 [debug] [MainThread]: Connection 'test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27' was properly closed.
[0m21:29:45.175970 [info ] [MainThread]: 
[0m21:29:45.176304 [info ] [MainThread]: Finished running 1 incremental model, 2 seeds, 5 table models, 36 data tests, 2 view models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m21:29:45.178689 [debug] [MainThread]: Command end result
[0m21:29:45.208644 [debug] [MainThread]: Wrote artifact WritableManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/manifest.json
[0m21:29:45.210081 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/semantic_manifest.json
[0m21:29:45.215273 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/run_results.json
[0m21:29:45.215594 [info ] [MainThread]: 
[0m21:29:45.215955 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m21:29:45.216244 [info ] [MainThread]: 
[0m21:29:45.216585 [error] [MainThread]: [31mFailure in test source_not_null_raw_green_tripdata_lpep_pickup_datetime (models/staging/sources.yml)[0m
[0m21:29:45.216915 [error] [MainThread]:   Runtime Error in test source_not_null_raw_green_tripdata_lpep_pickup_datetime (models/staging/sources.yml)
  Catalog Error: Table with name green_tripdata does not exist!
  Did you mean "information_schema.referential_constraints"?
  
  LINE 17: from "taxi_rides_ny"."prod"."green_tripdata"
                ^
[0m21:29:45.217183 [info ] [MainThread]: 
[0m21:29:45.217502 [info ] [MainThread]:   compiled code at target/compiled/taxi_rides_ny/models/staging/sources.yml/source_not_null_raw_green_tripdata_lpep_pickup_datetime.sql
[0m21:29:45.217775 [info ] [MainThread]: 
[0m21:29:45.218169 [error] [MainThread]: [31mFailure in test source_not_null_raw_yellow_tripdata_tpep_pickup_datetime (models/staging/sources.yml)[0m
[0m21:29:45.218511 [error] [MainThread]:   Runtime Error in test source_not_null_raw_yellow_tripdata_tpep_pickup_datetime (models/staging/sources.yml)
  Catalog Error: Table with name yellow_tripdata does not exist!
  Did you mean "information_schema.table_constraints"?
  
  LINE 17: from "taxi_rides_ny"."prod"."yellow_tripdata"
                ^
[0m21:29:45.218786 [info ] [MainThread]: 
[0m21:29:45.219142 [info ] [MainThread]:   compiled code at target/compiled/taxi_rides_ny/models/staging/sources.yml/source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.sql
[0m21:29:45.219524 [info ] [MainThread]: 
[0m21:29:45.219822 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=37 NO-OP=0 TOTAL=46
[0m21:29:45.220622 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.0865368, "process_in_blocks": "56", "process_kernel_time": 0.108101, "process_mem_max_rss": "165132", "process_out_blocks": "3824", "process_user_time": 1.915804}
[0m21:29:45.221055 [debug] [MainThread]: Command `dbt build` failed at 21:29:45.220925 after 1.09 seconds
[0m21:29:45.221567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70109c0c8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70109f7c3d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70109fc81150>]}
[0m21:29:45.222051 [debug] [MainThread]: Flushing usage events
[0m21:29:46.109748 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:37:52.847016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496cf17c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496ce23fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496ce23fb10>]}


============================== 21:37:52.850518 | a82bd9c1-f025-447d-9b89-8cba9436b301 ==============================
[0m21:37:52.850518 [info ] [MainThread]: Running with dbt=1.11.6
[0m21:37:52.851149 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'debug': 'False', 'write_json': 'True', 'empty': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'profiles_dir': '/home/roy/.dbt', 'static_parser': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt retry', 'version_check': 'True', 'use_colors': 'True', 'log_path': '/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/logs', 'warn_error': 'None', 'fail_fast': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'printer_width': '80', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None'}
[0m21:37:53.027890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a82bd9c1-f025-447d-9b89-8cba9436b301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496cef2cfc0>]}
[0m21:37:53.080062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a82bd9c1-f025-447d-9b89-8cba9436b301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496ce2b6140>]}
[0m21:37:53.130982 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m21:37:53.192778 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m21:37:53.322058 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:37:53.322387 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:37:53.322704 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:37:53.365123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a82bd9c1-f025-447d-9b89-8cba9436b301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496c4547950>]}
[0m21:37:53.485989 [debug] [MainThread]: Wrote artifact WritableManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/manifest.json
[0m21:37:53.487282 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/semantic_manifest.json
[0m21:37:53.494879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a82bd9c1-f025-447d-9b89-8cba9436b301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496c459cd70>]}
[0m21:37:53.495521 [info ] [MainThread]: Found 8 models, 2 seeds, 36 data tests, 2 sources, 619 macros
[0m21:37:53.498394 [info ] [MainThread]: 
[0m21:37:53.498732 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:37:53.499108 [info ] [MainThread]: 
[0m21:37:53.499686 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:37:53.504315 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m21:37:53.534867 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m21:37:53.535193 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"taxi_rides_ny"'
    
  
  
[0m21:37:53.535547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:37:53.548922 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m21:37:53.550033 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m21:37:53.550651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_dev)
[0m21:37:53.551101 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "dev"
"
[0m21:37:53.555955 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m21:37:53.556227 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='taxi_rides_ny'
        and type='sqlite'
    
  
[0m21:37:53.556567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:37:53.557896 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:37:53.558890 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m21:37:53.559142 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: BEGIN
[0m21:37:53.559718 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:37:53.559963 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m21:37:53.560259 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
    
        create schema if not exists "taxi_rides_ny"."dev"
    
[0m21:37:53.560855 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:37:53.561530 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m21:37:53.561789 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m21:37:53.562083 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m21:37:53.562529 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:37:53.562787 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: Close
[0m21:37:53.564159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_dev, now list_taxi_rides_ny_dev)
[0m21:37:53.568114 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m21:37:53.568379 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: BEGIN
[0m21:37:53.568694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:37:53.569666 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:37:53.569920 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m21:37:53.570206 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "connection_name": "list_taxi_rides_ny_dev"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev'
    and lower(table_catalog) = 'taxi_rides_ny'
  
[0m21:37:53.579008 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m21:37:53.579991 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: ROLLBACK
[0m21:37:53.581048 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_dev'
[0m21:37:53.581315 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: Close
[0m21:37:53.582226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a82bd9c1-f025-447d-9b89-8cba9436b301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496ce25c670>]}
[0m21:37:53.582602 [debug] [MainThread]: Using duckdb connection "master"
[0m21:37:53.582863 [debug] [MainThread]: On master: BEGIN
[0m21:37:53.583107 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:37:53.583892 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:37:53.584157 [debug] [MainThread]: On master: COMMIT
[0m21:37:53.584445 [debug] [MainThread]: Using duckdb connection "master"
[0m21:37:53.584721 [debug] [MainThread]: On master: COMMIT
[0m21:37:53.585090 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:37:53.585376 [debug] [MainThread]: On master: Close
[0m21:37:53.587204 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190
[0m21:37:53.587546 [info ] [Thread-1 (]: 1 of 39 START test source_not_null_raw_green_tripdata_lpep_pickup_datetime ..... [RUN]
[0m21:37:53.587902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_taxi_rides_ny_dev, now test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190)
[0m21:37:53.588201 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190
[0m21:37:53.600824 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190"
[0m21:37:53.601386 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190
[0m21:37:53.613580 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190"
[0m21:37:53.614117 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190"
[0m21:37:53.614476 [debug] [Thread-1 (]: On test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190: BEGIN
[0m21:37:53.614761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:53.615867 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:37:53.616205 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190"
[0m21:37:53.616532 [debug] [Thread-1 (]: On test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select lpep_pickup_datetime
from "taxi_rides_ny"."prod"."green_tripdata"
where lpep_pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m21:37:53.617520 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:37:53.620388 [debug] [Thread-1 (]: On test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190: ROLLBACK
[0m21:37:53.620896 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190'
[0m21:37:53.621213 [debug] [Thread-1 (]: On test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190: Close
[0m21:37:53.621697 [info ] [Thread-1 (]: 1 of 39 PASS source_not_null_raw_green_tripdata_lpep_pickup_datetime ........... [[32mPASS[0m in 0.03s]
[0m21:37:53.622166 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190
[0m21:37:53.622500 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf
[0m21:37:53.622808 [info ] [Thread-1 (]: 2 of 39 START test source_not_null_raw_yellow_tripdata_tpep_pickup_datetime .... [RUN]
[0m21:37:53.623300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190, now test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf)
[0m21:37:53.623654 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf
[0m21:37:53.626775 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf"
[0m21:37:53.627224 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf
[0m21:37:53.628769 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf"
[0m21:37:53.629201 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf"
[0m21:37:53.629548 [debug] [Thread-1 (]: On test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf: BEGIN
[0m21:37:53.629828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:53.630804 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:37:53.631098 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf"
[0m21:37:53.631395 [debug] [Thread-1 (]: On test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select tpep_pickup_datetime
from "taxi_rides_ny"."prod"."yellow_tripdata"
where tpep_pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m21:37:53.632570 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:37:53.633745 [debug] [Thread-1 (]: On test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf: ROLLBACK
[0m21:37:53.634363 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf'
[0m21:37:53.634806 [debug] [Thread-1 (]: On test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf: Close
[0m21:37:53.635539 [info ] [Thread-1 (]: 2 of 39 PASS source_not_null_raw_yellow_tripdata_tpep_pickup_datetime .......... [[32mPASS[0m in 0.01s]
[0m21:37:53.636067 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf
[0m21:37:53.636406 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_green_tripdata
[0m21:37:53.637080 [info ] [Thread-1 (]: 3 of 39 START sql view model dev.stg_green_tripdata ............................ [RUN]
[0m21:37:53.637538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf, now model.taxi_rides_ny.stg_green_tripdata)
[0m21:37:53.637882 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_green_tripdata
[0m21:37:53.642381 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_tripdata"
[0m21:37:53.643011 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_green_tripdata
[0m21:37:53.665652 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_tripdata"
[0m21:37:53.666195 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_green_tripdata"
[0m21:37:53.666499 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_tripdata: BEGIN
[0m21:37:53.666782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:53.667889 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:37:53.668183 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_green_tripdata"
[0m21:37:53.668583 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_tripdata"} */

  
  create view "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."green_tripdata"
),

renamed as (
    select
        -- identifiers
        cast(vendorid as integer) as vendor_id,
        cast(ratecodeid as integer) as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps
        cast(lpep_pickup_datetime as timestamp) as pickup_datetime,  -- lpep = Licensed Passenger Enhancement Program (green taxis)
        cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,
        cast(trip_type as integer) as trip_type,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(ehail_fee as numeric) as ehail_fee,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        cast(payment_type as integer) as payment_type

    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

where pickup_datetime >= '2019-01-01' and pickup_datetime < '2019-02-01'

  );

[0m21:37:53.669669 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:37:53.673839 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_green_tripdata"
[0m21:37:53.674143 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_tmp" rename to "stg_green_tripdata"
[0m21:37:53.674695 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:37:53.681437 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_tripdata: COMMIT
[0m21:37:53.681762 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_green_tripdata"
[0m21:37:53.682045 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_tripdata: COMMIT
[0m21:37:53.685914 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:37:53.689970 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_green_tripdata"
[0m21:37:53.690288 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_tripdata"} */

      drop view if exists "taxi_rides_ny"."dev"."stg_green_tripdata__dbt_backup" cascade
    
[0m21:37:53.690870 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:37:53.691893 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_tripdata: Close
[0m21:37:53.693403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a82bd9c1-f025-447d-9b89-8cba9436b301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496c1e64600>]}
[0m21:37:53.693927 [info ] [Thread-1 (]: 3 of 39 OK created sql view model dev.stg_green_tripdata ....................... [[32mOK[0m in 0.05s]
[0m21:37:53.694394 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_green_tripdata
[0m21:37:53.694725 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_yellow_tripdata
[0m21:37:53.695090 [info ] [Thread-1 (]: 4 of 39 START sql view model dev.stg_yellow_tripdata ........................... [RUN]
[0m21:37:53.695499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_tripdata, now model.taxi_rides_ny.stg_yellow_tripdata)
[0m21:37:53.695804 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_yellow_tripdata
[0m21:37:53.698068 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
[0m21:37:53.698560 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_yellow_tripdata
[0m21:37:53.700942 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_tripdata"
[0m21:37:53.701533 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_yellow_tripdata"
[0m21:37:53.702050 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_yellow_tripdata: BEGIN
[0m21:37:53.702558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:53.703839 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:37:53.704293 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_yellow_tripdata"
[0m21:37:53.704821 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_tripdata"} */

  
  create view "taxi_rides_ny"."dev"."stg_yellow_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."yellow_tripdata"
),

renamed as (
    select
        -- identifiers (standardized naming for consistency across yellow/green)
        cast(vendorid as integer) as vendor_id,
        cast(ratecodeid as integer) as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps (standardized naming)
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,  -- tpep = Taxicab Passenger Enhancement Program (yellow taxis)
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        cast(payment_type as integer) as payment_type

    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

where pickup_datetime >= '2019-01-01' and pickup_datetime < '2019-02-01'

  );

[0m21:37:53.706394 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:37:53.708588 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_yellow_tripdata"
[0m21:37:53.709018 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m21:37:53.709791 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:37:53.710691 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_yellow_tripdata: COMMIT
[0m21:37:53.711019 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_yellow_tripdata"
[0m21:37:53.711427 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_yellow_tripdata: COMMIT
[0m21:37:53.715145 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:37:53.717080 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_yellow_tripdata"
[0m21:37:53.717389 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_tripdata"} */

      drop view if exists "taxi_rides_ny"."dev"."stg_yellow_tripdata__dbt_backup" cascade
    
[0m21:37:53.717996 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:37:53.718950 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_yellow_tripdata: Close
[0m21:37:53.719375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a82bd9c1-f025-447d-9b89-8cba9436b301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496c3fa9f10>]}
[0m21:37:53.719841 [info ] [Thread-1 (]: 4 of 39 OK created sql view model dev.stg_yellow_tripdata ...................... [[32mOK[0m in 0.02s]
[0m21:37:53.720327 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_yellow_tripdata
[0m21:37:53.720651 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e
[0m21:37:53.720959 [info ] [Thread-1 (]: 5 of 39 START test not_null_stg_green_tripdata_pickup_datetime ................. [RUN]
[0m21:37:53.721546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_yellow_tripdata, now test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e)
[0m21:37:53.721911 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e
[0m21:37:53.724590 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e"
[0m21:37:53.725033 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e
[0m21:37:53.726836 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e"
[0m21:37:53.727321 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e"
[0m21:37:53.727630 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e: BEGIN
[0m21:37:53.727911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:53.729293 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:37:53.729718 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e"
[0m21:37:53.730061 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "taxi_rides_ny"."dev"."stg_green_tripdata"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m21:37:53.740532 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m21:37:53.741908 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e: ROLLBACK
[0m21:37:53.742556 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e'
[0m21:37:53.743115 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e: Close
[0m21:37:53.743643 [info ] [Thread-1 (]: 5 of 39 PASS not_null_stg_green_tripdata_pickup_datetime ....................... [[32mPASS[0m in 0.02s]
[0m21:37:53.744098 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e
[0m21:37:53.744455 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493
[0m21:37:53.744754 [info ] [Thread-1 (]: 6 of 39 START test not_null_stg_green_tripdata_vendor_id ....................... [RUN]
[0m21:37:53.745115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e, now test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493)
[0m21:37:53.745508 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493
[0m21:37:53.748143 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493"
[0m21:37:53.748581 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493
[0m21:37:53.750347 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493"
[0m21:37:53.751038 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493"
[0m21:37:53.751345 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493: BEGIN
[0m21:37:53.751633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:53.752661 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:37:53.752980 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493"
[0m21:37:53.753349 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "taxi_rides_ny"."dev"."stg_green_tripdata"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m21:37:53.757815 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:37:53.759017 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493: ROLLBACK
[0m21:37:53.759495 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493'
[0m21:37:53.759790 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493: Close
[0m21:37:53.760244 [info ] [Thread-1 (]: 6 of 39 PASS not_null_stg_green_tripdata_vendor_id ............................. [[32mPASS[0m in 0.02s]
[0m21:37:53.760755 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493
[0m21:37:53.761147 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m21:37:53.761669 [info ] [Thread-1 (]: 7 of 39 START test not_null_stg_yellow_tripdata_pickup_datetime ................ [RUN]
[0m21:37:53.762190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493, now test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44)
[0m21:37:53.762517 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m21:37:53.765294 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m21:37:53.765811 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m21:37:53.767892 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m21:37:53.768336 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m21:37:53.768639 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: BEGIN
[0m21:37:53.768918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:53.770139 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:37:53.770505 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m21:37:53.770865 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "taxi_rides_ny"."dev"."stg_yellow_tripdata"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m21:37:53.832324 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m21:37:53.833651 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: ROLLBACK
[0m21:37:53.834200 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44'
[0m21:37:53.834573 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: Close
[0m21:37:53.835060 [info ] [Thread-1 (]: 7 of 39 PASS not_null_stg_yellow_tripdata_pickup_datetime ...................... [[32mPASS[0m in 0.07s]
[0m21:37:53.835598 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m21:37:53.835917 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751
[0m21:37:53.836240 [info ] [Thread-1 (]: 8 of 39 START test not_null_stg_yellow_tripdata_vendor_id ...................... [RUN]
[0m21:37:53.836645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44, now test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751)
[0m21:37:53.836946 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751
[0m21:37:53.839532 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751"
[0m21:37:53.840005 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751
[0m21:37:53.842017 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751"
[0m21:37:53.842679 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751"
[0m21:37:53.842982 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751: BEGIN
[0m21:37:53.843263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:53.844432 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:37:53.844786 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751"
[0m21:37:53.845221 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "taxi_rides_ny"."dev"."stg_yellow_tripdata"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m21:37:53.868854 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m21:37:53.870189 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751: ROLLBACK
[0m21:37:53.870771 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751'
[0m21:37:53.871073 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751: Close
[0m21:37:53.871637 [info ] [Thread-1 (]: 8 of 39 PASS not_null_stg_yellow_tripdata_vendor_id ............................ [[32mPASS[0m in 0.03s]
[0m21:37:53.872162 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751
[0m21:37:53.872867 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.int_trips_unioned
[0m21:37:53.873268 [info ] [Thread-1 (]: 9 of 39 START sql table model dev.int_trips_unioned ............................ [RUN]
[0m21:37:53.873707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751, now model.taxi_rides_ny.int_trips_unioned)
[0m21:37:53.874015 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.int_trips_unioned
[0m21:37:53.876315 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.int_trips_unioned"
[0m21:37:53.876836 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.int_trips_unioned
[0m21:37:53.892256 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.int_trips_unioned"
[0m21:37:53.892917 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.int_trips_unioned"
[0m21:37:53.893228 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips_unioned: BEGIN
[0m21:37:53.893587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:53.894777 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:37:53.895078 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.int_trips_unioned"
[0m21:37:53.895445 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.int_trips_unioned"} */

  
    
    

    create  table
      "taxi_rides_ny"."dev"."int_trips_unioned__dbt_tmp"
  
    as (
      -- Union green and yellow taxi data into a single dataset
-- Demonstrates how to combine data from multiple sources with slightly different schemas

with green_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        trip_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        ehail_fee,
        improvement_surcharge,
        total_amount,
        payment_type,
        'Green' as service_type
    from "taxi_rides_ny"."dev"."stg_green_tripdata"
),

yellow_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        1 as trip_type,  -- Yellow taxis only do street-hail (code 1)
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        cast(0 as numeric) as ehail_fee,  -- Yellow taxis don't have ehail_fee
        improvement_surcharge,
        total_amount,
        payment_type,
        'Yellow' as service_type
    from "taxi_rides_ny"."dev"."stg_yellow_tripdata"
)

select * from green_trips
union all
select * from yellow_trips
    );
  
  
[0m21:37:55.063126 [debug] [Thread-1 (]: SQL status: OK in 1.167 seconds
[0m21:37:55.065579 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.int_trips_unioned"
[0m21:37:55.065948 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.int_trips_unioned"} */
alter table "taxi_rides_ny"."dev"."int_trips_unioned__dbt_tmp" rename to "int_trips_unioned"
[0m21:37:55.066803 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:37:55.070308 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips_unioned: COMMIT
[0m21:37:55.070704 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.int_trips_unioned"
[0m21:37:55.071090 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips_unioned: COMMIT
[0m21:37:56.754170 [debug] [Thread-1 (]: SQL status: OK in 1.683 seconds
[0m21:37:56.756055 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.int_trips_unioned"
[0m21:37:56.756334 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.int_trips_unioned"} */

      drop table if exists "taxi_rides_ny"."dev"."int_trips_unioned__dbt_backup" cascade
    
[0m21:37:56.756927 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:37:56.757830 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips_unioned: Close
[0m21:37:56.758220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a82bd9c1-f025-447d-9b89-8cba9436b301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496c4270aa0>]}
[0m21:37:56.758794 [info ] [Thread-1 (]: 9 of 39 OK created sql table model dev.int_trips_unioned ....................... [[32mOK[0m in 2.88s]
[0m21:37:56.759292 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.int_trips_unioned
[0m21:37:56.760093 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.int_trips
[0m21:37:56.760503 [info ] [Thread-1 (]: 10 of 39 START sql table model dev.int_trips ................................... [RUN]
[0m21:37:56.760898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.int_trips_unioned, now model.taxi_rides_ny.int_trips)
[0m21:37:56.761177 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.int_trips
[0m21:37:56.773083 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.int_trips"
[0m21:37:56.773663 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.int_trips
[0m21:37:56.775922 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.int_trips"
[0m21:37:56.776341 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.int_trips"
[0m21:37:56.776676 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips: BEGIN
[0m21:37:56.776940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:56.811233 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m21:37:56.811647 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.int_trips"
[0m21:37:56.811972 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.int_trips"} */

  
    
    

    create  table
      "taxi_rides_ny"."dev"."int_trips__dbt_tmp"
  
    as (
      -- Enrich and deduplicate trip data
-- Demonstrates enrichment and surrogate key generation
-- Note: Data quality analysis available in analyses/trips_data_quality.sql

with unioned as (
    select * from "taxi_rides_ny"."dev"."int_trips_unioned"
),

payment_types as (
    select * from "taxi_rides_ny"."dev"."payment_type_lookup"
),

cleaned_and_enriched as (
    select
        -- Generate unique trip identifier (surrogate key pattern)
        md5(cast(coalesce(cast(u.vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_location_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.service_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- Identifiers
        u.vendor_id,
        u.service_type,
        u.rate_code_id,

        -- Location IDs
        u.pickup_location_id,
        u.dropoff_location_id,

        -- Timestamps
        u.pickup_datetime,
        u.dropoff_datetime,

        -- Trip details
        u.store_and_fwd_flag,
        u.passenger_count,
        u.trip_distance,
        u.trip_type,

        -- Payment breakdown
        u.fare_amount,
        u.extra,
        u.mta_tax,
        u.tip_amount,
        u.tolls_amount,
        u.ehail_fee,
        u.improvement_surcharge,
        u.total_amount,

        -- Enrich with payment type description
        coalesce(u.payment_type, 0) as payment_type,
        coalesce(pt.description, 'Unknown') as payment_type_description

    from unioned u
    left join payment_types pt
        on coalesce(u.payment_type, 0) = pt.payment_type
)

select * from cleaned_and_enriched

-- Deduplicate: if multiple trips match (same vendor, second, location, service), keep first
qualify row_number() over(
    partition by vendor_id, pickup_datetime, pickup_location_id, service_type
    order by dropoff_datetime
) = 1
    );
  
  
[0m21:38:00.627894 [debug] [Thread-1 (]: SQL status: OK in 3.816 seconds
[0m21:38:00.632232 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.int_trips"
[0m21:38:00.632559 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.int_trips"} */
alter table "taxi_rides_ny"."dev"."int_trips__dbt_tmp" rename to "int_trips"
[0m21:38:00.633256 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:38:00.634210 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips: COMMIT
[0m21:38:00.634580 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.int_trips"
[0m21:38:00.634853 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips: COMMIT
[0m21:38:02.011464 [debug] [Thread-1 (]: SQL status: OK in 1.376 seconds
[0m21:38:02.013092 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.int_trips"
[0m21:38:02.013394 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.int_trips"} */

      drop table if exists "taxi_rides_ny"."dev"."int_trips__dbt_backup" cascade
    
[0m21:38:02.014035 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:38:02.014984 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips: Close
[0m21:38:02.015405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a82bd9c1-f025-447d-9b89-8cba9436b301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74968a70d130>]}
[0m21:38:02.015931 [info ] [Thread-1 (]: 10 of 39 OK created sql table model dev.int_trips .............................. [[32mOK[0m in 5.25s]
[0m21:38:02.016513 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.int_trips
[0m21:38:02.017284 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e
[0m21:38:02.017637 [info ] [Thread-1 (]: 11 of 39 START test accepted_values_int_trips_service_type__Green__Yellow ...... [RUN]
[0m21:38:02.018112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.int_trips, now test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e)
[0m21:38:02.018403 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e
[0m21:38:02.025022 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e"
[0m21:38:02.025630 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e
[0m21:38:02.027672 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e"
[0m21:38:02.028238 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e"
[0m21:38:02.028608 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e: BEGIN
[0m21:38:02.028916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:02.061131 [debug] [Thread-1 (]: SQL status: OK in 0.032 seconds
[0m21:38:02.061577 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e"
[0m21:38:02.061902 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        service_type as value_field,
        count(*) as n_records

    from "taxi_rides_ny"."dev"."int_trips"
    group by service_type

)

select *
from all_values
where value_field not in (
    'Green','Yellow'
)



  
  
      
    ) dbt_internal_test
[0m21:38:02.076950 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m21:38:02.078325 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e: ROLLBACK
[0m21:38:02.078958 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e'
[0m21:38:02.079295 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e: Close
[0m21:38:02.079821 [info ] [Thread-1 (]: 11 of 39 PASS accepted_values_int_trips_service_type__Green__Yellow ............ [[32mPASS[0m in 0.06s]
[0m21:38:02.080436 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e
[0m21:38:02.080819 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09
[0m21:38:02.081226 [info ] [Thread-1 (]: 12 of 39 START test not_null_int_trips_pickup_datetime ......................... [RUN]
[0m21:38:02.081819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e, now test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09)
[0m21:38:02.082131 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09
[0m21:38:02.085498 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09"
[0m21:38:02.086010 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09
[0m21:38:02.087987 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09"
[0m21:38:02.088564 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09"
[0m21:38:02.088915 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09: BEGIN
[0m21:38:02.089267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:02.092194 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:38:02.092633 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09"
[0m21:38:02.093013 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "taxi_rides_ny"."dev"."int_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m21:38:02.094082 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:02.095307 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09: ROLLBACK
[0m21:38:02.095984 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09'
[0m21:38:02.096353 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09: Close
[0m21:38:02.096958 [info ] [Thread-1 (]: 12 of 39 PASS not_null_int_trips_pickup_datetime ............................... [[32mPASS[0m in 0.02s]
[0m21:38:02.097611 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09
[0m21:38:02.097968 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53
[0m21:38:02.098354 [info ] [Thread-1 (]: 13 of 39 START test not_null_int_trips_service_type ............................ [RUN]
[0m21:38:02.098914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09, now test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53)
[0m21:38:02.099216 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53
[0m21:38:02.102690 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53"
[0m21:38:02.103189 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53
[0m21:38:02.104896 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53"
[0m21:38:02.105380 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53"
[0m21:38:02.105741 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53: BEGIN
[0m21:38:02.106112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:02.107449 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:02.107887 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53"
[0m21:38:02.108339 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select service_type
from "taxi_rides_ny"."dev"."int_trips"
where service_type is null



  
  
      
    ) dbt_internal_test
[0m21:38:02.109395 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:02.110693 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53: ROLLBACK
[0m21:38:02.111358 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53'
[0m21:38:02.111753 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53: Close
[0m21:38:02.112326 [info ] [Thread-1 (]: 13 of 39 PASS not_null_int_trips_service_type .................................. [[32mPASS[0m in 0.01s]
[0m21:38:02.112914 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53
[0m21:38:02.113241 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b
[0m21:38:02.113650 [info ] [Thread-1 (]: 14 of 39 START test not_null_int_trips_total_amount ............................ [RUN]
[0m21:38:02.114073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53, now test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b)
[0m21:38:02.114380 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b
[0m21:38:02.117673 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b"
[0m21:38:02.118205 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b
[0m21:38:02.119921 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b"
[0m21:38:02.120387 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b"
[0m21:38:02.120700 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b: BEGIN
[0m21:38:02.120982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:02.122181 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:02.122682 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b"
[0m21:38:02.123011 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "taxi_rides_ny"."dev"."int_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m21:38:02.124085 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:02.125640 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b: ROLLBACK
[0m21:38:02.126251 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b'
[0m21:38:02.126645 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b: Close
[0m21:38:02.127168 [info ] [Thread-1 (]: 14 of 39 PASS not_null_int_trips_total_amount .................................. [[32mPASS[0m in 0.01s]
[0m21:38:02.127814 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b
[0m21:38:02.128133 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61
[0m21:38:02.128520 [info ] [Thread-1 (]: 15 of 39 START test not_null_int_trips_trip_id ................................. [RUN]
[0m21:38:02.129025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b, now test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61)
[0m21:38:02.129329 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61
[0m21:38:02.132901 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61"
[0m21:38:02.133552 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61
[0m21:38:02.135270 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61"
[0m21:38:02.135811 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61"
[0m21:38:02.136195 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61: BEGIN
[0m21:38:02.136538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:02.137789 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:02.138119 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61"
[0m21:38:02.138437 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "taxi_rides_ny"."dev"."int_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m21:38:02.139567 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:02.140777 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61: ROLLBACK
[0m21:38:02.141326 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61'
[0m21:38:02.141714 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61: Close
[0m21:38:02.142241 [info ] [Thread-1 (]: 15 of 39 PASS not_null_int_trips_trip_id ....................................... [[32mPASS[0m in 0.01s]
[0m21:38:02.142779 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61
[0m21:38:02.143155 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c
[0m21:38:02.143568 [info ] [Thread-1 (]: 16 of 39 START test not_null_int_trips_vendor_id ............................... [RUN]
[0m21:38:02.143978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61, now test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c)
[0m21:38:02.144326 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c
[0m21:38:02.147814 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c"
[0m21:38:02.148366 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c
[0m21:38:02.150020 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c"
[0m21:38:02.150521 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c"
[0m21:38:02.150849 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c: BEGIN
[0m21:38:02.151244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:02.152361 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:02.152735 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c"
[0m21:38:02.153059 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "taxi_rides_ny"."dev"."int_trips"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m21:38:02.154092 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:02.155820 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c: ROLLBACK
[0m21:38:02.156397 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c'
[0m21:38:02.156772 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c: Close
[0m21:38:02.157375 [info ] [Thread-1 (]: 16 of 39 PASS not_null_int_trips_vendor_id ..................................... [[32mPASS[0m in 0.01s]
[0m21:38:02.157924 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c
[0m21:38:02.158280 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f
[0m21:38:02.158711 [info ] [Thread-1 (]: 17 of 39 START test unique_int_trips_trip_id ................................... [RUN]
[0m21:38:02.159071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c, now test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f)
[0m21:38:02.159372 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f
[0m21:38:02.164929 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f"
[0m21:38:02.165447 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f
[0m21:38:02.167048 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f"
[0m21:38:02.167513 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f"
[0m21:38:02.167815 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f: BEGIN
[0m21:38:02.168097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:02.169153 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:02.169502 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f"
[0m21:38:02.169806 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "taxi_rides_ny"."dev"."int_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:38:02.598042 [debug] [Thread-1 (]: SQL status: OK in 0.428 seconds
[0m21:38:02.599389 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f: ROLLBACK
[0m21:38:02.599891 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f'
[0m21:38:02.600175 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f: Close
[0m21:38:02.600741 [info ] [Thread-1 (]: 17 of 39 PASS unique_int_trips_trip_id ......................................... [[32mPASS[0m in 0.44s]
[0m21:38:02.601295 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f
[0m21:38:02.601905 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_trips
[0m21:38:02.602341 [info ] [Thread-1 (]: 18 of 39 START sql incremental model dev.fct_trips ............................. [RUN]
[0m21:38:02.602917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f, now model.taxi_rides_ny.fct_trips)
[0m21:38:02.603224 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_trips
[0m21:38:02.612929 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_trips"
[0m21:38:02.613493 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_trips
[0m21:38:02.649057 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.fct_trips"
[0m21:38:02.649477 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_trips"} */
DESCRIBE (select * from (
        

-- Fact table containing all taxi trips enriched with zone information
-- This is a classic star schema design: fact table (trips) joined to dimension table (zones)
-- Materialized incrementally to handle large datasets efficiently

select
    -- Trip identifiers
    trips.trip_id,
    trips.vendor_id,
    trips.service_type,
    trips.rate_code_id,

    -- Location details (enriched with human-readable zone names from dimension)
    trips.pickup_location_id,
    pz.borough as pickup_borough,
    pz.zone as pickup_zone,
    trips.dropoff_location_id,
    dz.borough as dropoff_borough,
    dz.zone as dropoff_zone,

    -- Trip timing
    trips.pickup_datetime,
    trips.dropoff_datetime,
    trips.store_and_fwd_flag,

    -- Trip metrics
    trips.passenger_count,
    trips.trip_distance,
    trips.trip_type,
    
    
        (date_diff('minute', trips.pickup_datetime::timestamp, trips.dropoff_datetime::timestamp ))
    
 as trip_duration_minutes,

    -- Payment breakdown
    trips.fare_amount,
    trips.extra,
    trips.mta_tax,
    trips.tip_amount,
    trips.tolls_amount,
    trips.ehail_fee,
    trips.improvement_surcharge,
    trips.total_amount,
    trips.payment_type,
    trips.payment_type_description

from "taxi_rides_ny"."dev"."int_trips" as trips
-- LEFT JOIN preserves all trips even if zone information is missing or unknown
left join "taxi_rides_ny"."dev"."dim_zones" as pz
    on trips.pickup_location_id = pz.location_id
left join "taxi_rides_ny"."dev"."dim_zones" as dz
    on trips.dropoff_location_id = dz.location_id


    ) as __dbt_sbq
    where false
    limit 0
)
[0m21:38:02.649800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:02.683090 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m21:38:02.693802 [warn ] [Thread-1 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['trip_distance', 'fare_amount', 'extra', 'mta_tax', 'tip_amount', 'tolls_amount', 'ehail_fee', 'improvement_surcharge', 'total_amount']`
[0m21:38:02.694552 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.fct_trips"
[0m21:38:02.694906 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_trips"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as varchar)
 as trip_id, 
      
    cast(null as integer)
 as vendor_id, 
      
    cast(null as varchar)
 as service_type, 
      
    cast(null as integer)
 as rate_code_id, 
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as integer)
 as dropoff_location_id, 
      
    cast(null as varchar)
 as dropoff_borough, 
      
    cast(null as varchar)
 as dropoff_zone, 
      
    cast(null as timestamp)
 as pickup_datetime, 
      
    cast(null as timestamp)
 as dropoff_datetime, 
      
    cast(null as varchar)
 as store_and_fwd_flag, 
      
    cast(null as integer)
 as passenger_count, 
      
    cast(null as numeric)
 as trip_distance, 
      
    cast(null as integer)
 as trip_type, 
      
    cast(null as bigint)
 as trip_duration_minutes, 
      
    cast(null as numeric)
 as fare_amount, 
      
    cast(null as numeric)
 as extra, 
      
    cast(null as numeric)
 as mta_tax, 
      
    cast(null as numeric)
 as tip_amount, 
      
    cast(null as numeric)
 as tolls_amount, 
      
    cast(null as numeric)
 as ehail_fee, 
      
    cast(null as numeric)
 as improvement_surcharge, 
      
    cast(null as numeric)
 as total_amount, 
      
    cast(null as integer)
 as payment_type, 
      
    cast(null as varchar)
 as payment_type_description
    ) as __dbt_sbq
    where false
    limit 0
)
[0m21:38:02.695921 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:02.712130 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_trips"
[0m21:38:02.712756 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.fct_trips"
[0m21:38:02.713050 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_trips: BEGIN
[0m21:38:02.713793 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:38:02.714073 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.fct_trips"
[0m21:38:02.714668 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_trips"} */

  
    
    
      
    

    create  table
      "taxi_rides_ny"."dev"."fct_trips"
  
  (
    trip_id varchar,
    vendor_id integer,
    service_type varchar,
    rate_code_id integer,
    pickup_location_id integer,
    pickup_borough varchar,
    pickup_zone varchar,
    dropoff_location_id integer,
    dropoff_borough varchar,
    dropoff_zone varchar,
    pickup_datetime timestamp,
    dropoff_datetime timestamp,
    store_and_fwd_flag varchar,
    passenger_count integer,
    trip_distance numeric,
    trip_type integer,
    trip_duration_minutes bigint,
    fare_amount numeric,
    extra numeric,
    mta_tax numeric,
    tip_amount numeric,
    tolls_amount numeric,
    ehail_fee numeric,
    improvement_surcharge numeric,
    total_amount numeric,
    payment_type integer,
    payment_type_description varchar
    
    )
 ;
    insert into "taxi_rides_ny"."dev"."fct_trips" 
  (
    
      
      trip_id ,
    
      
      vendor_id ,
    
      
      service_type ,
    
      
      rate_code_id ,
    
      
      pickup_location_id ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      dropoff_location_id ,
    
      
      dropoff_borough ,
    
      
      dropoff_zone ,
    
      
      pickup_datetime ,
    
      
      dropoff_datetime ,
    
      
      store_and_fwd_flag ,
    
      
      passenger_count ,
    
      
      trip_distance ,
    
      
      trip_type ,
    
      
      trip_duration_minutes ,
    
      
      fare_amount ,
    
      
      extra ,
    
      
      mta_tax ,
    
      
      tip_amount ,
    
      
      tolls_amount ,
    
      
      ehail_fee ,
    
      
      improvement_surcharge ,
    
      
      total_amount ,
    
      
      payment_type ,
    
      
      payment_type_description 
    
  )
 (
      
    select trip_id, vendor_id, service_type, rate_code_id, pickup_location_id, pickup_borough, pickup_zone, dropoff_location_id, dropoff_borough, dropoff_zone, pickup_datetime, dropoff_datetime, store_and_fwd_flag, passenger_count, trip_distance, trip_type, trip_duration_minutes, fare_amount, extra, mta_tax, tip_amount, tolls_amount, ehail_fee, improvement_surcharge, total_amount, payment_type, payment_type_description
    from (
        

-- Fact table containing all taxi trips enriched with zone information
-- This is a classic star schema design: fact table (trips) joined to dimension table (zones)
-- Materialized incrementally to handle large datasets efficiently

select
    -- Trip identifiers
    trips.trip_id,
    trips.vendor_id,
    trips.service_type,
    trips.rate_code_id,

    -- Location details (enriched with human-readable zone names from dimension)
    trips.pickup_location_id,
    pz.borough as pickup_borough,
    pz.zone as pickup_zone,
    trips.dropoff_location_id,
    dz.borough as dropoff_borough,
    dz.zone as dropoff_zone,

    -- Trip timing
    trips.pickup_datetime,
    trips.dropoff_datetime,
    trips.store_and_fwd_flag,

    -- Trip metrics
    trips.passenger_count,
    trips.trip_distance,
    trips.trip_type,
    
    
        (date_diff('minute', trips.pickup_datetime::timestamp, trips.dropoff_datetime::timestamp ))
    
 as trip_duration_minutes,

    -- Payment breakdown
    trips.fare_amount,
    trips.extra,
    trips.mta_tax,
    trips.tip_amount,
    trips.tolls_amount,
    trips.ehail_fee,
    trips.improvement_surcharge,
    trips.total_amount,
    trips.payment_type,
    trips.payment_type_description

from "taxi_rides_ny"."dev"."int_trips" as trips
-- LEFT JOIN preserves all trips even if zone information is missing or unknown
left join "taxi_rides_ny"."dev"."dim_zones" as pz
    on trips.pickup_location_id = pz.location_id
left join "taxi_rides_ny"."dev"."dim_zones" as dz
    on trips.dropoff_location_id = dz.location_id


    ) as model_subq
    );
  
  
  
[0m21:38:05.403420 [debug] [Thread-1 (]: SQL status: OK in 2.688 seconds
[0m21:38:05.404530 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_trips: COMMIT
[0m21:38:05.404866 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.fct_trips"
[0m21:38:05.405165 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_trips: COMMIT
[0m21:38:06.863877 [debug] [Thread-1 (]: SQL status: OK in 1.458 seconds
[0m21:38:06.864592 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_trips: Close
[0m21:38:06.865063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a82bd9c1-f025-447d-9b89-8cba9436b301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74968a7a74d0>]}
[0m21:38:06.865568 [info ] [Thread-1 (]: 18 of 39 OK created sql incremental model dev.fct_trips ........................ [[32mOK[0m in 4.26s]
[0m21:38:06.866268 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_trips
[0m21:38:06.867100 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39
[0m21:38:06.867455 [info ] [Thread-1 (]: 19 of 39 START test accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6  [RUN]
[0m21:38:06.867998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.fct_trips, now test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39)
[0m21:38:06.868343 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39
[0m21:38:06.871561 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39"
[0m21:38:06.872086 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39
[0m21:38:06.873747 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39"
[0m21:38:06.874213 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39"
[0m21:38:06.874545 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39: BEGIN
[0m21:38:06.874849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:06.904582 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m21:38:06.905041 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39"
[0m21:38:06.905378 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from "taxi_rides_ny"."dev"."fct_trips"
    group by payment_type

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m21:38:06.916723 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m21:38:06.917874 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39: ROLLBACK
[0m21:38:06.918377 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39'
[0m21:38:06.918728 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39: Close
[0m21:38:06.919217 [info ] [Thread-1 (]: 19 of 39 PASS accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6 ...... [[32mPASS[0m in 0.05s]
[0m21:38:06.919836 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39
[0m21:38:06.920217 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c
[0m21:38:06.920725 [info ] [Thread-1 (]: 20 of 39 START test accepted_values_fct_trips_service_type__Green__Yellow ...... [RUN]
[0m21:38:06.921151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39, now test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c)
[0m21:38:06.921509 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c
[0m21:38:06.927078 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c"
[0m21:38:06.927674 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c
[0m21:38:06.929264 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c"
[0m21:38:06.930091 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c"
[0m21:38:06.930555 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c: BEGIN
[0m21:38:06.931047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:06.932605 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:38:06.932969 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c"
[0m21:38:06.933354 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        service_type as value_field,
        count(*) as n_records

    from "taxi_rides_ny"."dev"."fct_trips"
    group by service_type

)

select *
from all_values
where value_field not in (
    'Green','Yellow'
)



  
  
      
    ) dbt_internal_test
[0m21:38:06.947813 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m21:38:06.949118 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c: ROLLBACK
[0m21:38:06.949664 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c'
[0m21:38:06.949955 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c: Close
[0m21:38:06.950531 [info ] [Thread-1 (]: 20 of 39 PASS accepted_values_fct_trips_service_type__Green__Yellow ............ [[32mPASS[0m in 0.03s]
[0m21:38:06.951260 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c
[0m21:38:06.951719 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83
[0m21:38:06.952041 [info ] [Thread-1 (]: 21 of 39 START test not_null_fct_trips_pickup_datetime ......................... [RUN]
[0m21:38:06.952527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c, now test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83)
[0m21:38:06.952839 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83
[0m21:38:06.955909 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m21:38:06.956323 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83
[0m21:38:06.958098 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m21:38:06.958575 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m21:38:06.958875 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83: BEGIN
[0m21:38:06.959145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:06.960571 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:06.960965 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m21:38:06.961399 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "taxi_rides_ny"."dev"."fct_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m21:38:06.962559 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:06.963828 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83: ROLLBACK
[0m21:38:06.964337 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83'
[0m21:38:06.964742 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83: Close
[0m21:38:06.965581 [info ] [Thread-1 (]: 21 of 39 PASS not_null_fct_trips_pickup_datetime ............................... [[32mPASS[0m in 0.01s]
[0m21:38:06.966277 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83
[0m21:38:06.966723 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f
[0m21:38:06.967062 [info ] [Thread-1 (]: 22 of 39 START test not_null_fct_trips_service_type ............................ [RUN]
[0m21:38:06.967704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83, now test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f)
[0m21:38:06.968001 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f
[0m21:38:06.971610 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f"
[0m21:38:06.972500 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f
[0m21:38:06.974140 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f"
[0m21:38:06.974689 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f"
[0m21:38:06.975052 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f: BEGIN
[0m21:38:06.975324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:06.976609 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:06.976912 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f"
[0m21:38:06.977296 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select service_type
from "taxi_rides_ny"."dev"."fct_trips"
where service_type is null



  
  
      
    ) dbt_internal_test
[0m21:38:06.978260 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:06.979487 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f: ROLLBACK
[0m21:38:06.979989 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f'
[0m21:38:06.980302 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f: Close
[0m21:38:06.980778 [info ] [Thread-1 (]: 22 of 39 PASS not_null_fct_trips_service_type .................................. [[32mPASS[0m in 0.01s]
[0m21:38:06.981402 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f
[0m21:38:06.981821 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d
[0m21:38:06.982162 [info ] [Thread-1 (]: 23 of 39 START test not_null_fct_trips_total_amount ............................ [RUN]
[0m21:38:06.982680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f, now test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d)
[0m21:38:06.983042 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d
[0m21:38:06.986526 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d"
[0m21:38:06.987041 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d
[0m21:38:06.989087 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d"
[0m21:38:06.989572 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d"
[0m21:38:06.989868 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d: BEGIN
[0m21:38:06.990148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:06.991179 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:06.991526 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d"
[0m21:38:06.991888 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "taxi_rides_ny"."dev"."fct_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m21:38:06.992899 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:06.994133 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d: ROLLBACK
[0m21:38:06.994964 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d'
[0m21:38:06.995402 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d: Close
[0m21:38:06.996033 [info ] [Thread-1 (]: 23 of 39 PASS not_null_fct_trips_total_amount .................................. [[32mPASS[0m in 0.01s]
[0m21:38:06.996611 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d
[0m21:38:06.997002 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d
[0m21:38:06.997352 [info ] [Thread-1 (]: 24 of 39 START test not_null_fct_trips_trip_id ................................. [RUN]
[0m21:38:06.998090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d, now test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d)
[0m21:38:06.998459 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d
[0m21:38:07.001218 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d"
[0m21:38:07.001802 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d
[0m21:38:07.003891 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d"
[0m21:38:07.004378 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d"
[0m21:38:07.004698 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d: BEGIN
[0m21:38:07.004987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:07.006859 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:38:07.007189 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d"
[0m21:38:07.007565 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "taxi_rides_ny"."dev"."fct_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m21:38:07.008641 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:07.009823 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d: ROLLBACK
[0m21:38:07.010435 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d'
[0m21:38:07.010817 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d: Close
[0m21:38:07.011369 [info ] [Thread-1 (]: 24 of 39 PASS not_null_fct_trips_trip_id ....................................... [[32mPASS[0m in 0.01s]
[0m21:38:07.012039 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d
[0m21:38:07.012378 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb
[0m21:38:07.012820 [info ] [Thread-1 (]: 25 of 39 START test not_null_fct_trips_vendor_id ............................... [RUN]
[0m21:38:07.013238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d, now test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb)
[0m21:38:07.013618 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb
[0m21:38:07.016876 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m21:38:07.017551 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb
[0m21:38:07.019796 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m21:38:07.020250 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m21:38:07.020583 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb: BEGIN
[0m21:38:07.020876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:07.022132 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:07.022519 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m21:38:07.022867 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "taxi_rides_ny"."dev"."fct_trips"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m21:38:07.023913 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:07.025403 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb: ROLLBACK
[0m21:38:07.026026 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb'
[0m21:38:07.026353 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb: Close
[0m21:38:07.026930 [info ] [Thread-1 (]: 25 of 39 PASS not_null_fct_trips_vendor_id ..................................... [[32mPASS[0m in 0.01s]
[0m21:38:07.027480 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb
[0m21:38:07.027871 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68
[0m21:38:07.028226 [info ] [Thread-1 (]: 26 of 39 START test relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_  [RUN]
[0m21:38:07.028706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb, now test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68)
[0m21:38:07.029063 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68
[0m21:38:07.035881 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68"
[0m21:38:07.036386 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68
[0m21:38:07.038543 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68"
[0m21:38:07.039045 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68"
[0m21:38:07.039435 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68: BEGIN
[0m21:38:07.039786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:07.041100 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:07.041492 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68"
[0m21:38:07.041899 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select dropoff_location_id as from_field
    from "taxi_rides_ny"."dev"."fct_trips"
    where dropoff_location_id is not null
),

parent as (
    select location_id as to_field
    from "taxi_rides_ny"."dev"."dim_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:38:07.059227 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m21:38:07.060514 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68: ROLLBACK
[0m21:38:07.061042 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68'
[0m21:38:07.061385 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68: Close
[0m21:38:07.061898 [info ] [Thread-1 (]: 26 of 39 PASS relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_  [[32mPASS[0m in 0.03s]
[0m21:38:07.062362 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68
[0m21:38:07.062743 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4
[0m21:38:07.063046 [info ] [Thread-1 (]: 27 of 39 START test relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_  [RUN]
[0m21:38:07.063572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68, now test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4)
[0m21:38:07.063880 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4
[0m21:38:07.068156 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4"
[0m21:38:07.068736 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4
[0m21:38:07.070765 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4"
[0m21:38:07.071296 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4"
[0m21:38:07.071758 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4: BEGIN
[0m21:38:07.072280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:07.073899 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:38:07.074230 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4"
[0m21:38:07.074595 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select pickup_location_id as from_field
    from "taxi_rides_ny"."dev"."fct_trips"
    where pickup_location_id is not null
),

parent as (
    select location_id as to_field
    from "taxi_rides_ny"."dev"."dim_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:38:07.090838 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m21:38:07.092131 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4: ROLLBACK
[0m21:38:07.092648 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4'
[0m21:38:07.092969 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4: Close
[0m21:38:07.093512 [info ] [Thread-1 (]: 27 of 39 PASS relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_  [[32mPASS[0m in 0.03s]
[0m21:38:07.094156 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4
[0m21:38:07.094579 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab
[0m21:38:07.094899 [info ] [Thread-1 (]: 28 of 39 START test unique_fct_trips_trip_id ................................... [RUN]
[0m21:38:07.095320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4, now test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab)
[0m21:38:07.095651 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab
[0m21:38:07.098347 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab"
[0m21:38:07.098768 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab
[0m21:38:07.100617 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab"
[0m21:38:07.101173 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab"
[0m21:38:07.101532 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab: BEGIN
[0m21:38:07.101829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:07.102939 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:07.103253 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab"
[0m21:38:07.103654 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "taxi_rides_ny"."dev"."fct_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:38:07.516306 [debug] [Thread-1 (]: SQL status: OK in 0.412 seconds
[0m21:38:07.517687 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab: ROLLBACK
[0m21:38:07.518156 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab'
[0m21:38:07.518472 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab: Close
[0m21:38:07.518963 [info ] [Thread-1 (]: 28 of 39 PASS unique_fct_trips_trip_id ......................................... [[32mPASS[0m in 0.42s]
[0m21:38:07.519541 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab
[0m21:38:07.520248 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dim_vendors
[0m21:38:07.520729 [info ] [Thread-1 (]: 29 of 39 START sql table model dev.dim_vendors ................................. [RUN]
[0m21:38:07.521163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab, now model.taxi_rides_ny.dim_vendors)
[0m21:38:07.521521 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dim_vendors
[0m21:38:07.525018 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_vendors"
[0m21:38:07.525570 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dim_vendors
[0m21:38:07.528206 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_vendors"
[0m21:38:07.529004 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.dim_vendors"
[0m21:38:07.529454 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_vendors: BEGIN
[0m21:38:07.529889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:07.566566 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m21:38:07.566984 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.dim_vendors"
[0m21:38:07.567335 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_vendors"} */

  
    
    

    create  table
      "taxi_rides_ny"."dev"."dim_vendors__dbt_tmp"
  
    as (
      -- Dimension table for taxi technology vendors
-- Small static dimension defining vendor codes and their company names

with trips as (
    select * from "taxi_rides_ny"."dev"."fct_trips"
),

vendors as (
    select distinct
        vendor_id,
        



case vendor_id
    
    when 1 then 'Creative Mobile Technologies'
    
    when 2 then 'VeriFone Inc.'
    
    when 4 then 'Unknown/Other'
    
end

 as vendor_name
    from trips
)

select * from vendors
    );
  
  
[0m21:38:07.576362 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m21:38:07.578812 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.dim_vendors"
[0m21:38:07.579116 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_vendors"} */
alter table "taxi_rides_ny"."dev"."dim_vendors__dbt_tmp" rename to "dim_vendors"
[0m21:38:07.579837 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:38:07.580743 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_vendors: COMMIT
[0m21:38:07.581054 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.dim_vendors"
[0m21:38:07.581362 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_vendors: COMMIT
[0m21:38:07.586703 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:38:07.588666 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.dim_vendors"
[0m21:38:07.588967 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_vendors"} */

      drop table if exists "taxi_rides_ny"."dev"."dim_vendors__dbt_backup" cascade
    
[0m21:38:07.589613 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:38:07.590558 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_vendors: Close
[0m21:38:07.590951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a82bd9c1-f025-447d-9b89-8cba9436b301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74968a7a1fd0>]}
[0m21:38:07.591389 [info ] [Thread-1 (]: 29 of 39 OK created sql table model dev.dim_vendors ............................ [[32mOK[0m in 0.07s]
[0m21:38:07.591877 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dim_vendors
[0m21:38:07.592204 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_monthly_zone_revenue
[0m21:38:07.592656 [info ] [Thread-1 (]: 30 of 39 START sql table model dev.fct_monthly_zone_revenue .................... [RUN]
[0m21:38:07.593057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.dim_vendors, now model.taxi_rides_ny.fct_monthly_zone_revenue)
[0m21:38:07.593535 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_monthly_zone_revenue
[0m21:38:07.595330 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_monthly_zone_revenue"
[0m21:38:07.595826 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_monthly_zone_revenue
[0m21:38:07.598073 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_monthly_zone_revenue"
[0m21:38:07.598637 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.fct_monthly_zone_revenue"
[0m21:38:07.598971 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_monthly_zone_revenue: BEGIN
[0m21:38:07.599273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:07.600780 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:07.601137 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.fct_monthly_zone_revenue"
[0m21:38:07.601499 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_monthly_zone_revenue"} */

  
    
    

    create  table
      "taxi_rides_ny"."dev"."fct_monthly_zone_revenue__dbt_tmp"
  
    as (
      -- Data mart for monthly revenue analysis by pickup zone and service type
-- This aggregation is optimized for business reporting and dashboards
-- Enables analysis of revenue trends across different zones and taxi types

select
    -- Grouping dimensions
    coalesce(pickup_zone, 'Unknown Zone') as pickup_zone,
    date_trunc('month', pickup_datetime) as revenue_month,  -- Truncate to first day of month
    service_type,

    -- Revenue breakdown (summed by zone, month, and service type)
    sum(fare_amount) as revenue_monthly_fare,
    sum(extra) as revenue_monthly_extra,
    sum(mta_tax) as revenue_monthly_mta_tax,
    sum(tip_amount) as revenue_monthly_tip_amount,
    sum(tolls_amount) as revenue_monthly_tolls_amount,
    sum(ehail_fee) as revenue_monthly_ehail_fee,
    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,
    sum(total_amount) as revenue_monthly_total_amount,

    -- Additional metrics for operational analysis
    count(trip_id) as total_monthly_trips,
    avg(passenger_count) as avg_monthly_passenger_count,
    avg(trip_distance) as avg_monthly_trip_distance

from "taxi_rides_ny"."dev"."fct_trips"
group by pickup_zone, revenue_month, service_type
    );
  
  
[0m21:38:07.743058 [debug] [Thread-1 (]: SQL status: OK in 0.141 seconds
[0m21:38:07.745125 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.fct_monthly_zone_revenue"
[0m21:38:07.745434 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_monthly_zone_revenue"} */
alter table "taxi_rides_ny"."dev"."fct_monthly_zone_revenue__dbt_tmp" rename to "fct_monthly_zone_revenue"
[0m21:38:07.746017 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:38:07.746907 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_monthly_zone_revenue: COMMIT
[0m21:38:07.747207 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.fct_monthly_zone_revenue"
[0m21:38:07.747495 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_monthly_zone_revenue: COMMIT
[0m21:38:07.753468 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m21:38:07.755203 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.fct_monthly_zone_revenue"
[0m21:38:07.755519 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.fct_monthly_zone_revenue"} */

      drop table if exists "taxi_rides_ny"."dev"."fct_monthly_zone_revenue__dbt_backup" cascade
    
[0m21:38:07.756081 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:38:07.759066 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_monthly_zone_revenue: Close
[0m21:38:07.759469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a82bd9c1-f025-447d-9b89-8cba9436b301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496ce276210>]}
[0m21:38:07.759915 [info ] [Thread-1 (]: 30 of 39 OK created sql table model dev.fct_monthly_zone_revenue ............... [[32mOK[0m in 0.17s]
[0m21:38:07.760358 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_monthly_zone_revenue
[0m21:38:07.760683 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580
[0m21:38:07.760982 [info ] [Thread-1 (]: 31 of 39 START test not_null_dim_vendors_vendor_id ............................. [RUN]
[0m21:38:07.761438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.fct_monthly_zone_revenue, now test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580)
[0m21:38:07.761730 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580
[0m21:38:07.764121 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580"
[0m21:38:07.764676 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580
[0m21:38:07.766118 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580"
[0m21:38:07.766559 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580"
[0m21:38:07.766893 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580: BEGIN
[0m21:38:07.767200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:07.770999 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:38:07.771507 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580"
[0m21:38:07.772560 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "taxi_rides_ny"."dev"."dim_vendors"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m21:38:07.773680 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:07.774995 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580: ROLLBACK
[0m21:38:07.775539 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580'
[0m21:38:07.775846 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580: Close
[0m21:38:07.776312 [info ] [Thread-1 (]: 31 of 39 PASS not_null_dim_vendors_vendor_id ................................... [[32mPASS[0m in 0.01s]
[0m21:38:07.776820 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580
[0m21:38:07.777183 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141
[0m21:38:07.777669 [info ] [Thread-1 (]: 32 of 39 START test unique_dim_vendors_vendor_id ............................... [RUN]
[0m21:38:07.778045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580, now test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141)
[0m21:38:07.778350 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141
[0m21:38:07.781164 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141"
[0m21:38:07.781636 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141
[0m21:38:07.783131 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141"
[0m21:38:07.783643 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141"
[0m21:38:07.783983 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141: BEGIN
[0m21:38:07.784269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:07.785433 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:07.785827 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141"
[0m21:38:07.786144 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    vendor_id as unique_field,
    count(*) as n_records

from "taxi_rides_ny"."dev"."dim_vendors"
where vendor_id is not null
group by vendor_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:38:07.787534 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:07.789150 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141: ROLLBACK
[0m21:38:07.789756 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141'
[0m21:38:07.790051 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141: Close
[0m21:38:07.790592 [info ] [Thread-1 (]: 32 of 39 PASS unique_dim_vendors_vendor_id ..................................... [[32mPASS[0m in 0.01s]
[0m21:38:07.791126 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141
[0m21:38:07.791492 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6
[0m21:38:07.792023 [info ] [Thread-1 (]: 33 of 39 START test accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow  [RUN]
[0m21:38:07.792407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141, now test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6)
[0m21:38:07.792785 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6
[0m21:38:07.796300 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6"
[0m21:38:07.796998 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6
[0m21:38:07.798595 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6"
[0m21:38:07.799050 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6"
[0m21:38:07.799356 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6: BEGIN
[0m21:38:07.799693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:07.800871 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:07.801193 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6"
[0m21:38:07.801520 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        service_type as value_field,
        count(*) as n_records

    from "taxi_rides_ny"."dev"."fct_monthly_zone_revenue"
    group by service_type

)

select *
from all_values
where value_field not in (
    'Green','Yellow'
)



  
  
      
    ) dbt_internal_test
[0m21:38:07.802948 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:07.804126 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6: ROLLBACK
[0m21:38:07.804701 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6'
[0m21:38:07.805046 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6: Close
[0m21:38:07.805644 [info ] [Thread-1 (]: 33 of 39 PASS accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow  [[32mPASS[0m in 0.01s]
[0m21:38:07.806155 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6
[0m21:38:07.806572 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751
[0m21:38:07.807002 [info ] [Thread-1 (]: 34 of 39 START test dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type  [RUN]
[0m21:38:07.807498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6, now test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751)
[0m21:38:07.807820 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751
[0m21:38:07.816472 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751"
[0m21:38:07.816980 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751
[0m21:38:07.818655 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751"
[0m21:38:07.819157 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751"
[0m21:38:07.819511 [debug] [Thread-1 (]: On test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751: BEGIN
[0m21:38:07.819821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:07.820997 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:07.821315 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751"
[0m21:38:07.821670 [debug] [Thread-1 (]: On test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        pickup_zone, revenue_month, service_type
    from "taxi_rides_ny"."dev"."fct_monthly_zone_revenue"
    group by pickup_zone, revenue_month, service_type
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m21:38:07.824219 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:38:07.825753 [debug] [Thread-1 (]: On test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751: ROLLBACK
[0m21:38:07.826276 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751'
[0m21:38:07.826653 [debug] [Thread-1 (]: On test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751: Close
[0m21:38:07.827133 [info ] [Thread-1 (]: 34 of 39 PASS dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type  [[32mPASS[0m in 0.02s]
[0m21:38:07.827767 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751
[0m21:38:07.828112 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709
[0m21:38:07.828502 [info ] [Thread-1 (]: 35 of 39 START test not_null_fct_monthly_zone_revenue_pickup_zone .............. [RUN]
[0m21:38:07.828890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751, now test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709)
[0m21:38:07.829285 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709
[0m21:38:07.832821 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709"
[0m21:38:07.833373 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709
[0m21:38:07.835130 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709"
[0m21:38:07.835701 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709"
[0m21:38:07.836009 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709: BEGIN
[0m21:38:07.836287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:07.837975 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:38:07.838272 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709"
[0m21:38:07.838651 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_zone
from "taxi_rides_ny"."dev"."fct_monthly_zone_revenue"
where pickup_zone is null



  
  
      
    ) dbt_internal_test
[0m21:38:07.839806 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:07.841454 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709: ROLLBACK
[0m21:38:07.842188 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709'
[0m21:38:07.842566 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709: Close
[0m21:38:07.843212 [info ] [Thread-1 (]: 35 of 39 PASS not_null_fct_monthly_zone_revenue_pickup_zone .................... [[32mPASS[0m in 0.01s]
[0m21:38:07.843790 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709
[0m21:38:07.844137 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100
[0m21:38:07.844533 [info ] [Thread-1 (]: 36 of 39 START test not_null_fct_monthly_zone_revenue_revenue_month ............ [RUN]
[0m21:38:07.845016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709, now test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100)
[0m21:38:07.845388 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100
[0m21:38:07.848823 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100"
[0m21:38:07.849348 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100
[0m21:38:07.850945 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100"
[0m21:38:07.851391 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100"
[0m21:38:07.851728 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100: BEGIN
[0m21:38:07.852002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:07.853235 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:07.853686 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100"
[0m21:38:07.854011 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select revenue_month
from "taxi_rides_ny"."dev"."fct_monthly_zone_revenue"
where revenue_month is null



  
  
      
    ) dbt_internal_test
[0m21:38:07.855214 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:07.856454 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100: ROLLBACK
[0m21:38:07.857004 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100'
[0m21:38:07.857372 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100: Close
[0m21:38:07.858082 [info ] [Thread-1 (]: 36 of 39 PASS not_null_fct_monthly_zone_revenue_revenue_month .................. [[32mPASS[0m in 0.01s]
[0m21:38:07.858610 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100
[0m21:38:07.858931 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe
[0m21:38:07.859267 [info ] [Thread-1 (]: 37 of 39 START test not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount  [RUN]
[0m21:38:07.859625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100, now test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe)
[0m21:38:07.859925 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe
[0m21:38:07.863268 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe"
[0m21:38:07.863782 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe
[0m21:38:07.865464 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe"
[0m21:38:07.865928 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe"
[0m21:38:07.866224 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe: BEGIN
[0m21:38:07.866556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:07.867494 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:07.867796 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe"
[0m21:38:07.868128 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select revenue_monthly_total_amount
from "taxi_rides_ny"."dev"."fct_monthly_zone_revenue"
where revenue_monthly_total_amount is null



  
  
      
    ) dbt_internal_test
[0m21:38:07.869264 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:07.870553 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe: ROLLBACK
[0m21:38:07.871129 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe'
[0m21:38:07.871484 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe: Close
[0m21:38:07.872026 [info ] [Thread-1 (]: 37 of 39 PASS not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount ... [[32mPASS[0m in 0.01s]
[0m21:38:07.872633 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe
[0m21:38:07.873044 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7
[0m21:38:07.873480 [info ] [Thread-1 (]: 38 of 39 START test not_null_fct_monthly_zone_revenue_service_type ............. [RUN]
[0m21:38:07.873910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe, now test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7)
[0m21:38:07.874236 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7
[0m21:38:07.877979 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7"
[0m21:38:07.878561 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7
[0m21:38:07.880199 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7"
[0m21:38:07.880796 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7"
[0m21:38:07.881144 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7: BEGIN
[0m21:38:07.881477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:07.883316 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:38:07.883663 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7"
[0m21:38:07.883979 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select service_type
from "taxi_rides_ny"."dev"."fct_monthly_zone_revenue"
where service_type is null



  
  
      
    ) dbt_internal_test
[0m21:38:07.885004 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:07.886198 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7: ROLLBACK
[0m21:38:07.886755 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7'
[0m21:38:07.887077 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7: Close
[0m21:38:07.887643 [info ] [Thread-1 (]: 38 of 39 PASS not_null_fct_monthly_zone_revenue_service_type ................... [[32mPASS[0m in 0.01s]
[0m21:38:07.888131 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7
[0m21:38:07.888517 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413
[0m21:38:07.888873 [info ] [Thread-1 (]: 39 of 39 START test not_null_fct_monthly_zone_revenue_total_monthly_trips ...... [RUN]
[0m21:38:07.889239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7, now test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413)
[0m21:38:07.889614 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413
[0m21:38:07.893035 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413"
[0m21:38:07.893571 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413
[0m21:38:07.895100 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413"
[0m21:38:07.895547 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413"
[0m21:38:07.895857 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413: BEGIN
[0m21:38:07.896150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:07.897334 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:07.897706 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413"
[0m21:38:07.898025 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_monthly_trips
from "taxi_rides_ny"."dev"."fct_monthly_zone_revenue"
where total_monthly_trips is null



  
  
      
    ) dbt_internal_test
[0m21:38:07.898979 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:38:07.900187 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413: ROLLBACK
[0m21:38:07.900738 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413'
[0m21:38:07.901083 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413: Close
[0m21:38:07.901706 [info ] [Thread-1 (]: 39 of 39 PASS not_null_fct_monthly_zone_revenue_total_monthly_trips ............ [[32mPASS[0m in 0.01s]
[0m21:38:07.902271 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413
[0m21:38:07.903353 [debug] [MainThread]: Using duckdb connection "master"
[0m21:38:07.903707 [debug] [MainThread]: On master: BEGIN
[0m21:38:07.904000 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:38:07.905083 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:38:07.905424 [debug] [MainThread]: On master: COMMIT
[0m21:38:07.905760 [debug] [MainThread]: Using duckdb connection "master"
[0m21:38:07.906050 [debug] [MainThread]: On master: COMMIT
[0m21:38:07.906543 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:38:07.906844 [debug] [MainThread]: On master: Close
[0m21:38:07.907227 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:38:07.907572 [debug] [MainThread]: Connection 'test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413' was properly closed.
[0m21:38:07.907971 [info ] [MainThread]: 
[0m21:38:07.908303 [info ] [MainThread]: Finished running 1 incremental model, 4 table models, 32 data tests, 2 view models in 0 hours 0 minutes and 14.41 seconds (14.41s).
[0m21:38:07.913407 [debug] [MainThread]: Command end result
[0m21:38:07.947357 [debug] [MainThread]: Wrote artifact WritableManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/manifest.json
[0m21:38:07.948852 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/semantic_manifest.json
[0m21:38:07.954463 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/run_results.json
[0m21:38:07.954812 [info ] [MainThread]: 
[0m21:38:07.955165 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:38:07.955507 [info ] [MainThread]: 
[0m21:38:07.955840 [info ] [MainThread]: Done. PASS=39 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=39
[0m21:38:07.956930 [debug] [MainThread]: Resource report: {"command_name": "retry", "command_success": true, "command_wall_clock_time": 15.1557255, "process_in_blocks": "372584", "process_kernel_time": 7.031559, "process_mem_max_rss": "4057720", "process_out_blocks": "2973696", "process_user_time": 106.73381}
[0m21:38:07.957377 [debug] [MainThread]: Command `dbt retry` succeeded at 21:38:07.957288 after 15.16 seconds
[0m21:38:07.957747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496ce974ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496cf21e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7496ce44f110>]}
[0m21:38:07.958095 [debug] [MainThread]: Flushing usage events
[0m21:38:09.012007 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:49:47.216556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7364975986e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73649665fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73649665fb10>]}


============================== 21:49:47.218927 | 9b22f07f-abc5-416d-9f94-5e67dd60a793 ==============================
[0m21:49:47.218927 [info ] [MainThread]: Running with dbt=1.11.6
[0m21:49:47.219535 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'no_print': 'None', 'quiet': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'partial_parse': 'True', 'empty': 'False', 'debug': 'False', 'log_path': '/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build --target prod', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'static_parser': 'True', 'profiles_dir': '/home/roy/.dbt', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True'}
[0m21:49:47.394864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b22f07f-abc5-416d-9f94-5e67dd60a793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736497344fc0>]}
[0m21:49:47.444535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b22f07f-abc5-416d-9f94-5e67dd60a793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7364966c2140>]}
[0m21:49:47.445660 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m21:49:47.499963 [debug] [MainThread]: checksum: fda039cb47cdf0e627679f660a87812f9dc734dcd251ec88b5466764946323e4, vars: {}, profile: , target: prod, version: 1.11.6
[0m21:49:47.591503 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m21:49:47.591920 [debug] [MainThread]: previous checksum: fda039cb47cdf0e627679f660a87812f9dc734dcd251ec88b5466764946323e4, current checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8
[0m21:49:47.592249 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m21:49:47.592636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9b22f07f-abc5-416d-9f94-5e67dd60a793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73648c97fb50>]}
[0m21:49:49.073997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b22f07f-abc5-416d-9f94-5e67dd60a793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73648c603110>]}
[0m21:49:49.150529 [debug] [MainThread]: Wrote artifact WritableManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/manifest.json
[0m21:49:49.151870 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/semantic_manifest.json
[0m21:49:49.172126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b22f07f-abc5-416d-9f94-5e67dd60a793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736471341710>]}
[0m21:49:49.172608 [info ] [MainThread]: Found 8 models, 2 seeds, 36 data tests, 2 sources, 619 macros
[0m21:49:49.175684 [info ] [MainThread]: 
[0m21:49:49.176019 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:49:49.176391 [info ] [MainThread]: 
[0m21:49:49.176958 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:49:49.182776 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m21:49:49.207353 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m21:49:49.207689 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"taxi_rides_ny"'
    
  
  
[0m21:49:49.207988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:49.220314 [debug] [ThreadPool]: DuckDB adapter: duckdb error: IO Error: Could not set lock on file "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/taxi_rides_ny.duckdb": Conflicting lock is held in /usr/local/bin/duckdb (PID 18833) by user roy. See also https://duckdb.org/docs/stable/connect/concurrency
[0m21:49:49.220704 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"taxi_rides_ny"'
    
  
  
[0m21:49:49.220958 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m21:49:49.221200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:49.224750 [debug] [ThreadPool]: DuckDB adapter: duckdb error: IO Error: Could not set lock on file "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/taxi_rides_ny.duckdb": Conflicting lock is held in /usr/local/bin/duckdb (PID 18833) by user roy. See also https://duckdb.org/docs/stable/connect/concurrency
[0m21:49:49.225019 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: macro list_schemas
[0m21:49:49.225316 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m21:49:49.225608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:49.228901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:49:49.229301 [debug] [MainThread]: Connection 'list_taxi_rides_ny' was properly closed.
[0m21:49:49.229639 [info ] [MainThread]: 
[0m21:49:49.230048 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m21:49:49.230728 [error] [MainThread]: Encountered an error:
IO Error: Could not set lock on file "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/taxi_rides_ny.duckdb": Conflicting lock is held in /usr/local/bin/duckdb (PID 18833) by user roy. See also https://duckdb.org/docs/stable/connect/concurrency
[0m21:49:49.247074 [error] [MainThread]: Traceback (most recent call last):
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/connections.py", line 95, in exception_handler
    yield
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/sql/connections.py", line 147, in add_query
    cursor = connection.handle.cursor()
             ^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/contracts/connection.py", line 96, in handle
    self._handle.resolve(self)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/contracts/connection.py", line 120, in resolve
    return self.opener(connection)
           ~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/connections.py", line 53, in open
    connection.handle = cls._ENV.handle()
                        ~~~~~~~~~~~~~~~^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/environments/local.py", line 75, in handle
    self.conn = self.initialize_db(self.creds, self._plugins)
                ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/environments/__init__.py", line 159, in initialize_db
    conn = duckdb.connect(creds.path, read_only=False, config=config)
_duckdb.IOException: IO Error: Could not set lock on file "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/taxi_rides_ny.duckdb": Conflicting lock is held in /usr/local/bin/duckdb (PID 18833) by user roy. See also https://duckdb.org/docs/stable/connect/concurrency

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/connections.py", line 95, in exception_handler
    yield
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 1320, in execute_macro
    result = macro_function(**kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 427, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt_common/record.py", line 538, in record_replay_wrapper
    return func_to_record(*call_args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 471, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/connections.py", line 130, in execute
    return super().execute(sql, auto_begin, fetch, limit)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/sql/connections.py", line 219, in execute
    _, cursor = self.add_query(sql, auto_begin)
                ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/sql/connections.py", line 131, in add_query
    with self.exception_handler(sql):
         ~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/roy/miniconda3/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/connections.py", line 102, in exception_handler
    self.rollback_if_open()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/base/connections.py", line 125, in rollback_if_open
    if conn is not None and conn.handle and conn.transaction_open:
                            ^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/contracts/connection.py", line 96, in handle
    self._handle.resolve(self)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/contracts/connection.py", line 120, in resolve
    return self.opener(connection)
           ~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/connections.py", line 53, in open
    connection.handle = cls._ENV.handle()
                        ~~~~~~~~~~~~~~~^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/environments/local.py", line 75, in handle
    self.conn = self.initialize_db(self.creds, self._plugins)
                ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/environments/__init__.py", line 159, in initialize_db
    conn = duckdb.connect(creds.path, read_only=False, config=config)
_duckdb.IOException: IO Error: Could not set lock on file "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/taxi_rides_ny.duckdb": Conflicting lock is held in /usr/local/bin/duckdb (PID 18833) by user roy. See also https://duckdb.org/docs/stable/connect/concurrency

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/cli/requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/cli/requires.py", line 276, in wrapper
    return func(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/cli/requires.py", line 321, in wrapper
    return func(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/cli/requires.py", line 391, in wrapper
    return func(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/cli/requires.py", line 368, in wrapper
    return func(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/cli/requires.py", line 408, in wrapper
    return func(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/cli/main.py", line 210, in build
    results = task.run()
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/task/runnable.py", line 626, in run
    result = self.execute_with_hooks(selected_uids)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/task/runnable.py", line 559, in execute_with_hooks
    before_run_status = self.before_run(adapter, selected_uids)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/task/run.py", line 1117, in before_run
    self.create_schemas(adapter, required_schemas)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/task/runnable.py", line 734, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
                                    ~~~~~~~~~~~~~~~~^^
  File "/home/roy/miniconda3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/home/roy/miniconda3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/roy/miniconda3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt_common/utils/executor.py", line 16, in connected
    return func(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/task/runnable.py", line 709, in list_schemas
    for s in adapter.list_schemas(database_quoted)
             ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/sql/impl.py", line 218, in list_schemas
    results = self.execute_macro(LIST_SCHEMAS_MACRO_NAME, kwargs={"database": database})
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 1319, in execute_macro
    with self.connections.exception_handler(f"macro {macro_name}"):
         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/miniconda3/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/connections.py", line 102, in exception_handler
    self.rollback_if_open()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/base/connections.py", line 125, in rollback_if_open
    if conn is not None and conn.handle and conn.transaction_open:
                            ^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/contracts/connection.py", line 96, in handle
    self._handle.resolve(self)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/contracts/connection.py", line 120, in resolve
    return self.opener(connection)
           ~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/connections.py", line 53, in open
    connection.handle = cls._ENV.handle()
                        ~~~~~~~~~~~~~~~^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/environments/local.py", line 75, in handle
    self.conn = self.initialize_db(self.creds, self._plugins)
                ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/environments/__init__.py", line 159, in initialize_db
    conn = duckdb.connect(creds.path, read_only=False, config=config)
_duckdb.IOException: IO Error: Could not set lock on file "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/taxi_rides_ny.duckdb": Conflicting lock is held in /usr/local/bin/duckdb (PID 18833) by user roy. See also https://duckdb.org/docs/stable/connect/concurrency

[0m21:49:49.248715 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.0800421, "process_in_blocks": "3816", "process_kernel_time": 0.12404, "process_mem_max_rss": "159036", "process_out_blocks": "3464", "process_user_time": 2.88294}
[0m21:49:49.249128 [debug] [MainThread]: Command `dbt build` failed at 21:49:49.249011 after 2.08 seconds
[0m21:49:49.249539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7364706bc7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7364969f3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7364712eba10>]}
[0m21:49:49.249833 [debug] [MainThread]: Flushing usage events
[0m21:49:50.167602 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:50:42.996363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46d3d986e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46d2e5fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46d2e5fb10>]}


============================== 21:50:42.998610 | df7c6efc-27b0-4f7d-bafd-bc8548b754ba ==============================
[0m21:50:42.998610 [info ] [MainThread]: Running with dbt=1.11.6
[0m21:50:42.999246 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'debug': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'version_check': 'True', 'log_path': '/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/logs', 'introspect': 'True', 'printer_width': '80', 'log_format': 'default', 'write_json': 'True', 'invocation_command': 'dbt build --target prod', 'cache_selected_only': 'False', 'fail_fast': 'False', 'profiles_dir': '/home/roy/.dbt', 'partial_parse': 'True', 'empty': 'False', 'static_parser': 'True', 'target_path': 'None'}
[0m21:50:43.178644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df7c6efc-27b0-4f7d-bafd-bc8548b754ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46d3b44fc0>]}
[0m21:50:43.228368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df7c6efc-27b0-4f7d-bafd-bc8548b754ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46d2ec2140>]}
[0m21:50:43.229562 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m21:50:43.284045 [debug] [MainThread]: checksum: fda039cb47cdf0e627679f660a87812f9dc734dcd251ec88b5466764946323e4, vars: {}, profile: , target: prod, version: 1.11.6
[0m21:50:43.385581 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:50:43.385879 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:50:43.386140 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:50:43.428009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df7c6efc-27b0-4f7d-bafd-bc8548b754ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46c917c350>]}
[0m21:50:43.544657 [debug] [MainThread]: Wrote artifact WritableManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/manifest.json
[0m21:50:43.545978 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/semantic_manifest.json
[0m21:50:43.566920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df7c6efc-27b0-4f7d-bafd-bc8548b754ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46d5fac050>]}
[0m21:50:43.567323 [info ] [MainThread]: Found 8 models, 2 seeds, 36 data tests, 2 sources, 619 macros
[0m21:50:43.570444 [info ] [MainThread]: 
[0m21:50:43.570808 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m21:50:43.571252 [info ] [MainThread]: 
[0m21:50:43.571824 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:50:43.576674 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m21:50:43.602637 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m21:50:43.602967 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"taxi_rides_ny"'
    
  
  
[0m21:50:43.603225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:50:43.618097 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m21:50:43.619237 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m21:50:43.619766 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_prod)
[0m21:50:43.620122 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "prod"
"
[0m21:50:43.624908 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m21:50:43.625210 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
        select type from duckdb_databases()
        where lower(database_name)='taxi_rides_ny'
        and type='sqlite'
    
  
[0m21:50:43.625516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:50:43.626716 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:50:43.627674 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m21:50:43.627936 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: BEGIN
[0m21:50:43.628380 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:50:43.628673 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m21:50:43.628920 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
    
        create schema if not exists "taxi_rides_ny"."prod"
    
[0m21:50:43.629404 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:50:43.630040 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m21:50:43.630308 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m21:50:43.630567 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m21:50:43.631003 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:50:43.631270 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: Close
[0m21:50:43.632662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_prod, now list_taxi_rides_ny_prod)
[0m21:50:43.636815 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m21:50:43.637073 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: BEGIN
[0m21:50:43.637307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:50:43.638264 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:50:43.638560 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m21:50:43.638809 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "connection_name": "list_taxi_rides_ny_prod"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'prod'
    and lower(table_catalog) = 'taxi_rides_ny'
  
[0m21:50:43.647968 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m21:50:43.648893 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: ROLLBACK
[0m21:50:43.649575 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_prod'
[0m21:50:43.649832 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: Close
[0m21:50:43.650717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df7c6efc-27b0-4f7d-bafd-bc8548b754ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46c8e8d8d0>]}
[0m21:50:43.651071 [debug] [MainThread]: Using duckdb connection "master"
[0m21:50:43.651323 [debug] [MainThread]: On master: BEGIN
[0m21:50:43.651608 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:50:43.652503 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:50:43.652757 [debug] [MainThread]: On master: COMMIT
[0m21:50:43.653002 [debug] [MainThread]: Using duckdb connection "master"
[0m21:50:43.653242 [debug] [MainThread]: On master: COMMIT
[0m21:50:43.653752 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:50:43.654057 [debug] [MainThread]: On master: Close
[0m21:50:43.655477 [debug] [Thread-1 (]: Began running node seed.taxi_rides_ny.payment_type_lookup
[0m21:50:43.655907 [info ] [Thread-1 (]: 1 of 46 START seed file prod.payment_type_lookup ............................... [RUN]
[0m21:50:43.656381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_taxi_rides_ny_prod, now seed.taxi_rides_ny.payment_type_lookup)
[0m21:50:43.656762 [debug] [Thread-1 (]: Began compiling node seed.taxi_rides_ny.payment_type_lookup
[0m21:50:43.657088 [debug] [Thread-1 (]: Began executing node seed.taxi_rides_ny.payment_type_lookup
[0m21:50:43.678742 [debug] [Thread-1 (]: Using duckdb connection "seed.taxi_rides_ny.payment_type_lookup"
[0m21:50:43.679101 [debug] [Thread-1 (]: On seed.taxi_rides_ny.payment_type_lookup: BEGIN
[0m21:50:43.679384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:43.680763 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:43.681062 [debug] [Thread-1 (]: Using duckdb connection "seed.taxi_rides_ny.payment_type_lookup"
[0m21:50:43.681355 [debug] [Thread-1 (]: On seed.taxi_rides_ny.payment_type_lookup: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "seed.taxi_rides_ny.payment_type_lookup"} */

    create table "taxi_rides_ny"."prod"."payment_type_lookup" ("payment_type" integer,"description" text)
  
[0m21:50:43.681911 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:43.689826 [debug] [Thread-1 (]: Using duckdb connection "seed.taxi_rides_ny.payment_type_lookup"
[0m21:50:43.690167 [debug] [Thread-1 (]: On seed.taxi_rides_ny.payment_type_lookup: 
          COPY "taxi_rides_ny"."prod"."payment_type_lookup" FROM '/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/seeds/payment_type_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m21:50:43.693335 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:50:43.697425 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.taxi_rides_ny.payment_type_lookup"
[0m21:50:43.706526 [debug] [Thread-1 (]: On seed.taxi_rides_ny.payment_type_lookup: COMMIT
[0m21:50:43.706838 [debug] [Thread-1 (]: Using duckdb connection "seed.taxi_rides_ny.payment_type_lookup"
[0m21:50:43.707122 [debug] [Thread-1 (]: On seed.taxi_rides_ny.payment_type_lookup: COMMIT
[0m21:50:43.710767 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:50:43.712051 [debug] [Thread-1 (]: On seed.taxi_rides_ny.payment_type_lookup: Close
[0m21:50:43.713210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df7c6efc-27b0-4f7d-bafd-bc8548b754ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46bab7f110>]}
[0m21:50:43.713630 [info ] [Thread-1 (]: 1 of 46 OK loaded seed file prod.payment_type_lookup ........................... [[32mINSERT 7[0m in 0.06s]
[0m21:50:43.714096 [debug] [Thread-1 (]: Finished running node seed.taxi_rides_ny.payment_type_lookup
[0m21:50:43.714428 [debug] [Thread-1 (]: Began running node seed.taxi_rides_ny.taxi_zone_lookup
[0m21:50:43.714813 [info ] [Thread-1 (]: 2 of 46 START seed file prod.taxi_zone_lookup .................................. [RUN]
[0m21:50:43.715331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.taxi_rides_ny.payment_type_lookup, now seed.taxi_rides_ny.taxi_zone_lookup)
[0m21:50:43.715644 [debug] [Thread-1 (]: Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
[0m21:50:43.715946 [debug] [Thread-1 (]: Began executing node seed.taxi_rides_ny.taxi_zone_lookup
[0m21:50:43.720236 [debug] [Thread-1 (]: Using duckdb connection "seed.taxi_rides_ny.taxi_zone_lookup"
[0m21:50:43.720704 [debug] [Thread-1 (]: On seed.taxi_rides_ny.taxi_zone_lookup: BEGIN
[0m21:50:43.721303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:43.722739 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:50:43.723086 [debug] [Thread-1 (]: Using duckdb connection "seed.taxi_rides_ny.taxi_zone_lookup"
[0m21:50:43.723422 [debug] [Thread-1 (]: On seed.taxi_rides_ny.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "seed.taxi_rides_ny.taxi_zone_lookup"} */

    create table "taxi_rides_ny"."prod"."taxi_zone_lookup" ("locationid" integer,"borough" text,"zone" text,"service_zone" text)
  
[0m21:50:43.724082 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:43.725238 [debug] [Thread-1 (]: Using duckdb connection "seed.taxi_rides_ny.taxi_zone_lookup"
[0m21:50:43.725752 [debug] [Thread-1 (]: On seed.taxi_rides_ny.taxi_zone_lookup: 
          COPY "taxi_rides_ny"."prod"."taxi_zone_lookup" FROM '/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/seeds/taxi_zone_lookup.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m21:50:43.729040 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:50:43.729589 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.taxi_rides_ny.taxi_zone_lookup"
[0m21:50:43.730943 [debug] [Thread-1 (]: On seed.taxi_rides_ny.taxi_zone_lookup: COMMIT
[0m21:50:43.731402 [debug] [Thread-1 (]: Using duckdb connection "seed.taxi_rides_ny.taxi_zone_lookup"
[0m21:50:43.731866 [debug] [Thread-1 (]: On seed.taxi_rides_ny.taxi_zone_lookup: COMMIT
[0m21:50:43.735794 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:50:43.736469 [debug] [Thread-1 (]: On seed.taxi_rides_ny.taxi_zone_lookup: Close
[0m21:50:43.736906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df7c6efc-27b0-4f7d-bafd-bc8548b754ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46baa38290>]}
[0m21:50:43.737315 [info ] [Thread-1 (]: 2 of 46 OK loaded seed file prod.taxi_zone_lookup .............................. [[32mINSERT 265[0m in 0.02s]
[0m21:50:43.737997 [debug] [Thread-1 (]: Finished running node seed.taxi_rides_ny.taxi_zone_lookup
[0m21:50:43.738366 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190
[0m21:50:43.738700 [info ] [Thread-1 (]: 3 of 46 START test source_not_null_raw_green_tripdata_lpep_pickup_datetime ..... [RUN]
[0m21:50:43.739150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.taxi_rides_ny.taxi_zone_lookup, now test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190)
[0m21:50:43.739653 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190
[0m21:50:43.756332 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190"
[0m21:50:43.757079 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190
[0m21:50:43.769150 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190"
[0m21:50:43.769672 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190"
[0m21:50:43.770000 [debug] [Thread-1 (]: On test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190: BEGIN
[0m21:50:43.770306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:43.771562 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:43.771873 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190"
[0m21:50:43.772185 [debug] [Thread-1 (]: On test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select lpep_pickup_datetime
from "taxi_rides_ny"."prod"."green_tripdata"
where lpep_pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m21:50:43.773052 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:43.775494 [debug] [Thread-1 (]: On test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190: ROLLBACK
[0m21:50:43.776202 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190'
[0m21:50:43.776519 [debug] [Thread-1 (]: On test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190: Close
[0m21:50:43.777001 [info ] [Thread-1 (]: 3 of 46 PASS source_not_null_raw_green_tripdata_lpep_pickup_datetime ........... [[32mPASS[0m in 0.04s]
[0m21:50:43.777584 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190
[0m21:50:43.777911 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf
[0m21:50:43.778219 [info ] [Thread-1 (]: 4 of 46 START test source_not_null_raw_yellow_tripdata_tpep_pickup_datetime .... [RUN]
[0m21:50:43.778758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.source_not_null_raw_green_tripdata_lpep_pickup_datetime.05d0330190, now test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf)
[0m21:50:43.779095 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf
[0m21:50:43.781927 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf"
[0m21:50:43.782353 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf
[0m21:50:43.783993 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf"
[0m21:50:43.784516 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf"
[0m21:50:43.784812 [debug] [Thread-1 (]: On test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf: BEGIN
[0m21:50:43.785090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:43.786258 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:43.786732 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf"
[0m21:50:43.787381 [debug] [Thread-1 (]: On test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select tpep_pickup_datetime
from "taxi_rides_ny"."prod"."yellow_tripdata"
where tpep_pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m21:50:43.788283 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:43.789458 [debug] [Thread-1 (]: On test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf: ROLLBACK
[0m21:50:43.789923 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf'
[0m21:50:43.790219 [debug] [Thread-1 (]: On test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf: Close
[0m21:50:43.790774 [info ] [Thread-1 (]: 4 of 46 PASS source_not_null_raw_yellow_tripdata_tpep_pickup_datetime .......... [[32mPASS[0m in 0.01s]
[0m21:50:43.791374 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf
[0m21:50:43.791874 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4
[0m21:50:43.792383 [info ] [Thread-1 (]: 5 of 46 START test not_null_payment_type_lookup_payment_type ................... [RUN]
[0m21:50:43.793001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.source_not_null_raw_yellow_tripdata_tpep_pickup_datetime.97d185cebf, now test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4)
[0m21:50:43.793394 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4
[0m21:50:43.796778 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4"
[0m21:50:43.797375 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4
[0m21:50:43.799243 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4"
[0m21:50:43.799786 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4"
[0m21:50:43.800088 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4: BEGIN
[0m21:50:43.800387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:43.801652 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:43.802195 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4"
[0m21:50:43.802749 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_type
from "taxi_rides_ny"."prod"."payment_type_lookup"
where payment_type is null



  
  
      
    ) dbt_internal_test
[0m21:50:43.803882 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:43.805759 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4: ROLLBACK
[0m21:50:43.806338 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4'
[0m21:50:43.806716 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4: Close
[0m21:50:43.807203 [info ] [Thread-1 (]: 5 of 46 PASS not_null_payment_type_lookup_payment_type ......................... [[32mPASS[0m in 0.01s]
[0m21:50:43.807866 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4
[0m21:50:43.808195 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245
[0m21:50:43.808677 [info ] [Thread-1 (]: 6 of 46 START test unique_payment_type_lookup_payment_type ..................... [RUN]
[0m21:50:43.809150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_payment_type_lookup_payment_type.51dda45cb4, now test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245)
[0m21:50:43.809528 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245
[0m21:50:43.815348 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245"
[0m21:50:43.815981 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245
[0m21:50:43.817612 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245"
[0m21:50:43.818204 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245"
[0m21:50:43.818537 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245: BEGIN
[0m21:50:43.818828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:43.819946 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:43.820240 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245"
[0m21:50:43.820666 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_type as unique_field,
    count(*) as n_records

from "taxi_rides_ny"."prod"."payment_type_lookup"
where payment_type is not null
group by payment_type
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:50:43.821986 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:43.824009 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245: ROLLBACK
[0m21:50:43.824730 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245'
[0m21:50:43.825171 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245: Close
[0m21:50:43.825707 [info ] [Thread-1 (]: 6 of 46 PASS unique_payment_type_lookup_payment_type ........................... [[32mPASS[0m in 0.02s]
[0m21:50:43.826300 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245
[0m21:50:43.826665 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dim_zones
[0m21:50:43.827136 [info ] [Thread-1 (]: 7 of 46 START sql table model prod.dim_zones ................................... [RUN]
[0m21:50:43.827712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_payment_type_lookup_payment_type.819f837245, now model.taxi_rides_ny.dim_zones)
[0m21:50:43.828019 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m21:50:43.830100 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m21:50:43.830688 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m21:50:43.854616 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m21:50:43.855215 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.dim_zones"
[0m21:50:43.855568 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: BEGIN
[0m21:50:43.855847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:43.856896 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:43.857189 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.dim_zones"
[0m21:50:43.857538 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    
    

    create  table
      "taxi_rides_ny"."prod"."dim_zones__dbt_tmp"
  
    as (
      -- Dimension table for NYC taxi zones
-- This is a simple pass-through from the seed file, but having it as a model
-- allows for future enhancements (e.g., adding calculated fields, filtering)

select
    locationid as location_id,
    borough,
    zone,
    service_zone
from "taxi_rides_ny"."prod"."taxi_zone_lookup"
    );
  
  
[0m21:50:43.858562 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:43.863183 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.dim_zones"
[0m21:50:43.863672 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "model.taxi_rides_ny.dim_zones"} */
alter table "taxi_rides_ny"."prod"."dim_zones__dbt_tmp" rename to "dim_zones"
[0m21:50:43.864654 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:43.865677 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: COMMIT
[0m21:50:43.865976 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.dim_zones"
[0m21:50:43.866257 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: COMMIT
[0m21:50:43.869827 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:50:43.873920 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.dim_zones"
[0m21:50:43.874225 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "model.taxi_rides_ny.dim_zones"} */

      drop table if exists "taxi_rides_ny"."prod"."dim_zones__dbt_backup" cascade
    
[0m21:50:43.874887 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:43.876160 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: Close
[0m21:50:43.876594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df7c6efc-27b0-4f7d-bafd-bc8548b754ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46c8d254f0>]}
[0m21:50:43.877073 [info ] [Thread-1 (]: 7 of 46 OK created sql table model prod.dim_zones .............................. [[32mOK[0m in 0.05s]
[0m21:50:43.877543 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m21:50:43.877868 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_green_tripdata
[0m21:50:43.878232 [info ] [Thread-1 (]: 8 of 46 START sql view model prod.stg_green_tripdata ........................... [RUN]
[0m21:50:43.878831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.dim_zones, now model.taxi_rides_ny.stg_green_tripdata)
[0m21:50:43.879215 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_green_tripdata
[0m21:50:43.881719 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_tripdata"
[0m21:50:43.882207 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_green_tripdata
[0m21:50:43.895655 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_tripdata"
[0m21:50:43.896219 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_green_tripdata"
[0m21:50:43.896549 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_tripdata: BEGIN
[0m21:50:43.896833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:43.898168 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:43.898485 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_green_tripdata"
[0m21:50:43.898815 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "model.taxi_rides_ny.stg_green_tripdata"} */

  
  create view "taxi_rides_ny"."prod"."stg_green_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."green_tripdata"
),

renamed as (
    select
        -- identifiers
        cast(vendorid as integer) as vendor_id,
        cast(ratecodeid as integer) as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps
        cast(lpep_pickup_datetime as timestamp) as pickup_datetime,  -- lpep = Licensed Passenger Enhancement Program (green taxis)
        cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,
        cast(trip_type as integer) as trip_type,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(ehail_fee as numeric) as ehail_fee,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        cast(payment_type as integer) as payment_type

    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

  );

[0m21:50:43.899823 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:43.902555 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_green_tripdata"
[0m21:50:43.902945 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "model.taxi_rides_ny.stg_green_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_green_tripdata__dbt_tmp" rename to "stg_green_tripdata"
[0m21:50:43.903705 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:43.904647 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_tripdata: COMMIT
[0m21:50:43.904958 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_green_tripdata"
[0m21:50:43.905245 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_tripdata: COMMIT
[0m21:50:43.908818 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:50:43.910407 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_green_tripdata"
[0m21:50:43.910730 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "model.taxi_rides_ny.stg_green_tripdata"} */

      drop view if exists "taxi_rides_ny"."prod"."stg_green_tripdata__dbt_backup" cascade
    
[0m21:50:43.911270 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:43.912199 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_tripdata: Close
[0m21:50:43.912623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df7c6efc-27b0-4f7d-bafd-bc8548b754ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46baaebc50>]}
[0m21:50:43.913091 [info ] [Thread-1 (]: 8 of 46 OK created sql view model prod.stg_green_tripdata ...................... [[32mOK[0m in 0.03s]
[0m21:50:43.913597 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_green_tripdata
[0m21:50:43.914042 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_yellow_tripdata
[0m21:50:43.914666 [info ] [Thread-1 (]: 9 of 46 START sql view model prod.stg_yellow_tripdata .......................... [RUN]
[0m21:50:43.915185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_tripdata, now model.taxi_rides_ny.stg_yellow_tripdata)
[0m21:50:43.915723 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_yellow_tripdata
[0m21:50:43.918203 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
[0m21:50:43.918700 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_yellow_tripdata
[0m21:50:43.920910 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_tripdata"
[0m21:50:43.921476 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_yellow_tripdata"
[0m21:50:43.921779 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_yellow_tripdata: BEGIN
[0m21:50:43.922062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:43.923037 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:43.923338 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_yellow_tripdata"
[0m21:50:43.923827 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "model.taxi_rides_ny.stg_yellow_tripdata"} */

  
  create view "taxi_rides_ny"."prod"."stg_yellow_tripdata__dbt_tmp" as (
    with source as (
    select * from "taxi_rides_ny"."prod"."yellow_tripdata"
),

renamed as (
    select
        -- identifiers (standardized naming for consistency across yellow/green)
        cast(vendorid as integer) as vendor_id,
        cast(ratecodeid as integer) as rate_code_id,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps (standardized naming)
        cast(tpep_pickup_datetime as timestamp) as pickup_datetime,  -- tpep = Taxicab Passenger Enhancement Program (yellow taxis)
        cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        store_and_fwd_flag,
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,

        -- payment info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount,
        cast(payment_type as integer) as payment_type

    from source
    -- Filter out records with null vendor_id (data quality requirement)
    where vendorid is not null
)

select * from renamed

-- Sample records for dev environment using deterministic date filter

  );

[0m21:50:43.925841 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:43.928799 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_yellow_tripdata"
[0m21:50:43.929141 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "model.taxi_rides_ny.stg_yellow_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_yellow_tripdata__dbt_tmp" rename to "stg_yellow_tripdata"
[0m21:50:43.929905 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:43.930901 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_yellow_tripdata: COMMIT
[0m21:50:43.931228 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_yellow_tripdata"
[0m21:50:43.931665 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_yellow_tripdata: COMMIT
[0m21:50:43.935737 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:50:43.937782 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_yellow_tripdata"
[0m21:50:43.938095 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "model.taxi_rides_ny.stg_yellow_tripdata"} */

      drop view if exists "taxi_rides_ny"."prod"."stg_yellow_tripdata__dbt_backup" cascade
    
[0m21:50:43.938770 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:43.939740 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_yellow_tripdata: Close
[0m21:50:43.940157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df7c6efc-27b0-4f7d-bafd-bc8548b754ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46ba6eb050>]}
[0m21:50:43.940701 [info ] [Thread-1 (]: 9 of 46 OK created sql view model prod.stg_yellow_tripdata ..................... [[32mOK[0m in 0.03s]
[0m21:50:43.941226 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_yellow_tripdata
[0m21:50:43.941626 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79
[0m21:50:43.941983 [info ] [Thread-1 (]: 10 of 46 START test not_null_dim_zones_location_id ............................. [RUN]
[0m21:50:43.942530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_yellow_tripdata, now test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79)
[0m21:50:43.942841 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79
[0m21:50:43.945661 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79"
[0m21:50:43.946084 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79
[0m21:50:43.947721 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79"
[0m21:50:43.948198 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79"
[0m21:50:43.948558 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79: BEGIN
[0m21:50:43.948855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:43.949914 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:43.950216 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79"
[0m21:50:43.950553 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location_id
from "taxi_rides_ny"."prod"."dim_zones"
where location_id is null



  
  
      
    ) dbt_internal_test
[0m21:50:43.951528 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:43.952764 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79: ROLLBACK
[0m21:50:43.953491 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79'
[0m21:50:43.953879 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79: Close
[0m21:50:43.954383 [info ] [Thread-1 (]: 10 of 46 PASS not_null_dim_zones_location_id ................................... [[32mPASS[0m in 0.01s]
[0m21:50:43.955095 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79
[0m21:50:43.955495 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27
[0m21:50:43.955847 [info ] [Thread-1 (]: 11 of 46 START test unique_dim_zones_location_id ............................... [RUN]
[0m21:50:43.956235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_dim_zones_location_id.cbf42e7b79, now test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27)
[0m21:50:43.956553 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27
[0m21:50:43.962185 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27"
[0m21:50:43.962792 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27
[0m21:50:43.964312 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27"
[0m21:50:43.964747 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27"
[0m21:50:43.965150 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27: BEGIN
[0m21:50:43.965610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:43.967155 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:50:43.967595 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27"
[0m21:50:43.967899 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    location_id as unique_field,
    count(*) as n_records

from "taxi_rides_ny"."prod"."dim_zones"
where location_id is not null
group by location_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:50:43.969019 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:43.970129 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27: ROLLBACK
[0m21:50:43.970665 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27'
[0m21:50:43.970960 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27: Close
[0m21:50:43.971483 [info ] [Thread-1 (]: 11 of 46 PASS unique_dim_zones_location_id ..................................... [[32mPASS[0m in 0.02s]
[0m21:50:43.972018 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27
[0m21:50:43.972385 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e
[0m21:50:43.972784 [info ] [Thread-1 (]: 12 of 46 START test not_null_stg_green_tripdata_pickup_datetime ................ [RUN]
[0m21:50:43.973183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_dim_zones_location_id.5aa0ad7f27, now test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e)
[0m21:50:43.973523 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e
[0m21:50:43.976718 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e"
[0m21:50:43.977458 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e
[0m21:50:43.979784 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e"
[0m21:50:43.980374 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e"
[0m21:50:43.980748 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e: BEGIN
[0m21:50:43.981030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:43.982299 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:43.982607 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e"
[0m21:50:43.982908 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "taxi_rides_ny"."prod"."stg_green_tripdata"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m21:50:43.984200 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:43.985683 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e: ROLLBACK
[0m21:50:43.986723 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e'
[0m21:50:43.987259 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e: Close
[0m21:50:43.988132 [info ] [Thread-1 (]: 12 of 46 PASS not_null_stg_green_tripdata_pickup_datetime ...................... [[32mPASS[0m in 0.01s]
[0m21:50:43.988925 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e
[0m21:50:43.989478 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493
[0m21:50:43.990189 [info ] [Thread-1 (]: 13 of 46 START test not_null_stg_green_tripdata_vendor_id ...................... [RUN]
[0m21:50:43.990811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_stg_green_tripdata_pickup_datetime.4c4eb3b86e, now test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493)
[0m21:50:43.991323 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493
[0m21:50:43.996812 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493"
[0m21:50:43.997645 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493
[0m21:50:44.000688 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493"
[0m21:50:44.001555 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493"
[0m21:50:44.002057 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493: BEGIN
[0m21:50:44.002521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:44.004111 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:50:44.004621 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493"
[0m21:50:44.005135 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "taxi_rides_ny"."prod"."stg_green_tripdata"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m21:50:44.021131 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m21:50:44.022509 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493: ROLLBACK
[0m21:50:44.023025 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493'
[0m21:50:44.023421 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493: Close
[0m21:50:44.023978 [info ] [Thread-1 (]: 13 of 46 PASS not_null_stg_green_tripdata_vendor_id ............................ [[32mPASS[0m in 0.03s]
[0m21:50:44.024555 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493
[0m21:50:44.024959 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m21:50:44.025479 [info ] [Thread-1 (]: 14 of 46 START test not_null_stg_yellow_tripdata_pickup_datetime ............... [RUN]
[0m21:50:44.026192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_stg_green_tripdata_vendor_id.48b68c1493, now test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44)
[0m21:50:44.026747 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m21:50:44.032492 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m21:50:44.033497 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m21:50:44.036160 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m21:50:44.036879 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m21:50:44.037258 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: BEGIN
[0m21:50:44.037578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:44.038785 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:44.039118 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"
[0m21:50:44.039444 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "taxi_rides_ny"."prod"."stg_yellow_tripdata"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m21:50:44.041050 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:44.042258 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: ROLLBACK
[0m21:50:44.042797 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44'
[0m21:50:44.043120 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44: Close
[0m21:50:44.043757 [info ] [Thread-1 (]: 14 of 46 PASS not_null_stg_yellow_tripdata_pickup_datetime ..................... [[32mPASS[0m in 0.02s]
[0m21:50:44.044221 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44
[0m21:50:44.044594 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751
[0m21:50:44.044962 [info ] [Thread-1 (]: 15 of 46 START test not_null_stg_yellow_tripdata_vendor_id ..................... [RUN]
[0m21:50:44.045316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_stg_yellow_tripdata_pickup_datetime.140d66ac44, now test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751)
[0m21:50:44.045723 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751
[0m21:50:44.048739 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751"
[0m21:50:44.049287 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751
[0m21:50:44.051551 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751"
[0m21:50:44.052240 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751"
[0m21:50:44.052683 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751: BEGIN
[0m21:50:44.052984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:44.054058 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:44.054356 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751"
[0m21:50:44.054716 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "taxi_rides_ny"."prod"."stg_yellow_tripdata"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m21:50:44.155733 [debug] [Thread-1 (]: SQL status: OK in 0.101 seconds
[0m21:50:44.157228 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751: ROLLBACK
[0m21:50:44.157795 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751'
[0m21:50:44.158101 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751: Close
[0m21:50:44.158644 [info ] [Thread-1 (]: 15 of 46 PASS not_null_stg_yellow_tripdata_vendor_id ........................... [[32mPASS[0m in 0.11s]
[0m21:50:44.159232 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751
[0m21:50:44.160065 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.int_trips_unioned
[0m21:50:44.160570 [info ] [Thread-1 (]: 16 of 46 START sql table model prod.int_trips_unioned .......................... [RUN]
[0m21:50:44.161071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_stg_yellow_tripdata_vendor_id.85d1b1a751, now model.taxi_rides_ny.int_trips_unioned)
[0m21:50:44.161396 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.int_trips_unioned
[0m21:50:44.164213 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.int_trips_unioned"
[0m21:50:44.164954 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.int_trips_unioned
[0m21:50:44.167597 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.int_trips_unioned"
[0m21:50:44.168073 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.int_trips_unioned"
[0m21:50:44.168376 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips_unioned: BEGIN
[0m21:50:44.168717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:44.169908 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:50:44.170256 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.int_trips_unioned"
[0m21:50:44.170662 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "model.taxi_rides_ny.int_trips_unioned"} */

  
    
    

    create  table
      "taxi_rides_ny"."prod"."int_trips_unioned__dbt_tmp"
  
    as (
      -- Union green and yellow taxi data into a single dataset
-- Demonstrates how to combine data from multiple sources with slightly different schemas

with green_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        trip_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        ehail_fee,
        improvement_surcharge,
        total_amount,
        payment_type,
        'Green' as service_type
    from "taxi_rides_ny"."prod"."stg_green_tripdata"
),

yellow_trips as (
    select
        vendor_id,
        rate_code_id,
        pickup_location_id,
        dropoff_location_id,
        pickup_datetime,
        dropoff_datetime,
        store_and_fwd_flag,
        passenger_count,
        trip_distance,
        1 as trip_type,  -- Yellow taxis only do street-hail (code 1)
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        cast(0 as numeric) as ehail_fee,  -- Yellow taxis don't have ehail_fee
        improvement_surcharge,
        total_amount,
        payment_type,
        'Yellow' as service_type
    from "taxi_rides_ny"."prod"."stg_yellow_tripdata"
)

select * from green_trips
union all
select * from yellow_trips
    );
  
  
[0m21:50:55.427651 [debug] [Thread-1 (]: SQL status: OK in 11.257 seconds
[0m21:50:55.431421 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.int_trips_unioned"
[0m21:50:55.431750 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "model.taxi_rides_ny.int_trips_unioned"} */
alter table "taxi_rides_ny"."prod"."int_trips_unioned__dbt_tmp" rename to "int_trips_unioned"
[0m21:50:55.432422 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:55.433306 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips_unioned: COMMIT
[0m21:50:55.433609 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.int_trips_unioned"
[0m21:50:55.433889 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips_unioned: COMMIT
[0m21:50:56.884204 [debug] [Thread-1 (]: SQL status: OK in 1.450 seconds
[0m21:50:56.886168 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.int_trips_unioned"
[0m21:50:56.886539 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips_unioned: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "model.taxi_rides_ny.int_trips_unioned"} */

      drop table if exists "taxi_rides_ny"."prod"."int_trips_unioned__dbt_backup" cascade
    
[0m21:50:56.887111 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:50:56.888075 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips_unioned: Close
[0m21:50:56.888487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df7c6efc-27b0-4f7d-bafd-bc8548b754ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46ba6d47c0>]}
[0m21:50:56.889001 [info ] [Thread-1 (]: 16 of 46 OK created sql table model prod.int_trips_unioned ..................... [[32mOK[0m in 12.73s]
[0m21:50:56.889707 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.int_trips_unioned
[0m21:50:56.890307 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.int_trips
[0m21:50:56.890785 [info ] [Thread-1 (]: 17 of 46 START sql table model prod.int_trips .................................. [RUN]
[0m21:50:56.891372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.int_trips_unioned, now model.taxi_rides_ny.int_trips)
[0m21:50:56.891702 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.int_trips
[0m21:50:56.904451 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.int_trips"
[0m21:50:56.905216 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.int_trips
[0m21:50:56.907742 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.int_trips"
[0m21:50:56.908322 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.int_trips"
[0m21:50:56.908757 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips: BEGIN
[0m21:50:56.909071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:50:56.961258 [debug] [Thread-1 (]: SQL status: OK in 0.052 seconds
[0m21:50:56.961715 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.int_trips"
[0m21:50:56.962131 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "model.taxi_rides_ny.int_trips"} */

  
    
    

    create  table
      "taxi_rides_ny"."prod"."int_trips__dbt_tmp"
  
    as (
      -- Enrich and deduplicate trip data
-- Demonstrates enrichment and surrogate key generation
-- Note: Data quality analysis available in analyses/trips_data_quality.sql

with unioned as (
    select * from "taxi_rides_ny"."prod"."int_trips_unioned"
),

payment_types as (
    select * from "taxi_rides_ny"."prod"."payment_type_lookup"
),

cleaned_and_enriched as (
    select
        -- Generate unique trip identifier (surrogate key pattern)
        md5(cast(coalesce(cast(u.vendor_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_datetime as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.pickup_location_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(u.service_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as trip_id,

        -- Identifiers
        u.vendor_id,
        u.service_type,
        u.rate_code_id,

        -- Location IDs
        u.pickup_location_id,
        u.dropoff_location_id,

        -- Timestamps
        u.pickup_datetime,
        u.dropoff_datetime,

        -- Trip details
        u.store_and_fwd_flag,
        u.passenger_count,
        u.trip_distance,
        u.trip_type,

        -- Payment breakdown
        u.fare_amount,
        u.extra,
        u.mta_tax,
        u.tip_amount,
        u.tolls_amount,
        u.ehail_fee,
        u.improvement_surcharge,
        u.total_amount,

        -- Enrich with payment type description
        coalesce(u.payment_type, 0) as payment_type,
        coalesce(pt.description, 'Unknown') as payment_type_description

    from unioned u
    left join payment_types pt
        on coalesce(u.payment_type, 0) = pt.payment_type
)

select * from cleaned_and_enriched

-- Deduplicate: if multiple trips match (same vendor, second, location, service), keep first
qualify row_number() over(
    partition by vendor_id, pickup_datetime, pickup_location_id, service_type
    order by dropoff_datetime
) = 1
    );
  
  
[0m21:53:35.564409 [debug] [Thread-1 (]: SQL status: OK in 158.602 seconds
[0m21:53:35.568401 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.int_trips"
[0m21:53:35.568801 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "model.taxi_rides_ny.int_trips"} */
alter table "taxi_rides_ny"."prod"."int_trips__dbt_tmp" rename to "int_trips"
[0m21:53:35.569642 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:53:35.570620 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips: COMMIT
[0m21:53:35.570998 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.int_trips"
[0m21:53:35.571325 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips: COMMIT
[0m21:53:37.892684 [debug] [Thread-1 (]: SQL status: OK in 2.321 seconds
[0m21:53:37.894383 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.int_trips"
[0m21:53:37.894715 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "model.taxi_rides_ny.int_trips"} */

      drop table if exists "taxi_rides_ny"."prod"."int_trips__dbt_backup" cascade
    
[0m21:53:37.895389 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:53:37.896350 [debug] [Thread-1 (]: On model.taxi_rides_ny.int_trips: Close
[0m21:53:37.896794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df7c6efc-27b0-4f7d-bafd-bc8548b754ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46baa30e30>]}
[0m21:53:37.897274 [info ] [Thread-1 (]: 17 of 46 OK created sql table model prod.int_trips ............................. [[32mOK[0m in 161.01s]
[0m21:53:37.897930 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.int_trips
[0m21:53:37.898746 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e
[0m21:53:37.899076 [info ] [Thread-1 (]: 18 of 46 START test accepted_values_int_trips_service_type__Green__Yellow ...... [RUN]
[0m21:53:37.899530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.int_trips, now test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e)
[0m21:53:37.899843 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e
[0m21:53:37.906379 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e"
[0m21:53:37.906989 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e
[0m21:53:37.909019 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e"
[0m21:53:37.909759 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e"
[0m21:53:37.910131 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e: BEGIN
[0m21:53:37.910695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:37.951671 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m21:53:37.952030 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e"
[0m21:53:37.952384 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        service_type as value_field,
        count(*) as n_records

    from "taxi_rides_ny"."prod"."int_trips"
    group by service_type

)

select *
from all_values
where value_field not in (
    'Green','Yellow'
)



  
  
      
    ) dbt_internal_test
[0m21:53:38.260710 [debug] [Thread-1 (]: SQL status: OK in 0.308 seconds
[0m21:53:38.261943 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e: ROLLBACK
[0m21:53:38.262482 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e'
[0m21:53:38.262795 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e: Close
[0m21:53:38.263277 [info ] [Thread-1 (]: 18 of 46 PASS accepted_values_int_trips_service_type__Green__Yellow ............ [[32mPASS[0m in 0.36s]
[0m21:53:38.263763 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e
[0m21:53:38.264102 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09
[0m21:53:38.264471 [info ] [Thread-1 (]: 19 of 46 START test not_null_int_trips_pickup_datetime ......................... [RUN]
[0m21:53:38.264832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_int_trips_service_type__Green__Yellow.c251a1899e, now test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09)
[0m21:53:38.265146 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09
[0m21:53:38.268124 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09"
[0m21:53:38.268568 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09
[0m21:53:38.270016 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09"
[0m21:53:38.270485 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09"
[0m21:53:38.270788 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09: BEGIN
[0m21:53:38.271075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:38.274183 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:53:38.274575 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09"
[0m21:53:38.274897 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "taxi_rides_ny"."prod"."int_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m21:53:38.275909 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:53:38.277195 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09: ROLLBACK
[0m21:53:38.277767 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09'
[0m21:53:38.278080 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09: Close
[0m21:53:38.278587 [info ] [Thread-1 (]: 19 of 46 PASS not_null_int_trips_pickup_datetime ............................... [[32mPASS[0m in 0.01s]
[0m21:53:38.279069 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09
[0m21:53:38.279431 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53
[0m21:53:38.279807 [info ] [Thread-1 (]: 20 of 46 START test not_null_int_trips_service_type ............................ [RUN]
[0m21:53:38.280170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_int_trips_pickup_datetime.e4fa5f3e09, now test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53)
[0m21:53:38.280491 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53
[0m21:53:38.283974 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53"
[0m21:53:38.284608 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53
[0m21:53:38.286266 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53"
[0m21:53:38.286813 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53"
[0m21:53:38.287160 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53: BEGIN
[0m21:53:38.287511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:38.288602 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:53:38.288921 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53"
[0m21:53:38.289207 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select service_type
from "taxi_rides_ny"."prod"."int_trips"
where service_type is null



  
  
      
    ) dbt_internal_test
[0m21:53:38.290176 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:53:38.291623 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53: ROLLBACK
[0m21:53:38.292197 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53'
[0m21:53:38.292566 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53: Close
[0m21:53:38.293126 [info ] [Thread-1 (]: 20 of 46 PASS not_null_int_trips_service_type .................................. [[32mPASS[0m in 0.01s]
[0m21:53:38.293759 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53
[0m21:53:38.294130 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b
[0m21:53:38.294528 [info ] [Thread-1 (]: 21 of 46 START test not_null_int_trips_total_amount ............................ [RUN]
[0m21:53:38.295054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_int_trips_service_type.f38e150f53, now test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b)
[0m21:53:38.295426 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b
[0m21:53:38.301494 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b"
[0m21:53:38.302080 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b
[0m21:53:38.303722 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b"
[0m21:53:38.304335 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b"
[0m21:53:38.304754 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b: BEGIN
[0m21:53:38.305165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:38.306418 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:53:38.306838 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b"
[0m21:53:38.307155 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "taxi_rides_ny"."prod"."int_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m21:53:38.308238 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:53:38.309728 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b: ROLLBACK
[0m21:53:38.310231 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b'
[0m21:53:38.310686 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b: Close
[0m21:53:38.311368 [info ] [Thread-1 (]: 21 of 46 PASS not_null_int_trips_total_amount .................................. [[32mPASS[0m in 0.02s]
[0m21:53:38.312239 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b
[0m21:53:38.312741 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61
[0m21:53:38.313146 [info ] [Thread-1 (]: 22 of 46 START test not_null_int_trips_trip_id ................................. [RUN]
[0m21:53:38.313568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_int_trips_total_amount.ec933efa9b, now test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61)
[0m21:53:38.313886 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61
[0m21:53:38.317191 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61"
[0m21:53:38.318002 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61
[0m21:53:38.319610 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61"
[0m21:53:38.320031 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61"
[0m21:53:38.320348 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61: BEGIN
[0m21:53:38.320718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:38.322291 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:53:38.322789 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61"
[0m21:53:38.323244 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "taxi_rides_ny"."prod"."int_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m21:53:38.324453 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:53:38.326266 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61: ROLLBACK
[0m21:53:38.326877 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61'
[0m21:53:38.327246 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61: Close
[0m21:53:38.327838 [info ] [Thread-1 (]: 22 of 46 PASS not_null_int_trips_trip_id ....................................... [[32mPASS[0m in 0.01s]
[0m21:53:38.328360 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61
[0m21:53:38.328758 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c
[0m21:53:38.329109 [info ] [Thread-1 (]: 23 of 46 START test not_null_int_trips_vendor_id ............................... [RUN]
[0m21:53:38.329558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_int_trips_trip_id.9edd5fee61, now test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c)
[0m21:53:38.329856 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c
[0m21:53:38.333975 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c"
[0m21:53:38.334776 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c
[0m21:53:38.336478 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c"
[0m21:53:38.336922 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c"
[0m21:53:38.337216 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c: BEGIN
[0m21:53:38.337546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:38.338700 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:53:38.338990 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c"
[0m21:53:38.339315 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "taxi_rides_ny"."prod"."int_trips"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m21:53:38.340249 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:53:38.341661 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c: ROLLBACK
[0m21:53:38.342382 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c'
[0m21:53:38.342857 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c: Close
[0m21:53:38.343628 [info ] [Thread-1 (]: 23 of 46 PASS not_null_int_trips_vendor_id ..................................... [[32mPASS[0m in 0.01s]
[0m21:53:38.344405 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c
[0m21:53:38.345006 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f
[0m21:53:38.345559 [info ] [Thread-1 (]: 24 of 46 START test unique_int_trips_trip_id ................................... [RUN]
[0m21:53:38.346171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_int_trips_vendor_id.c9ac94714c, now test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f)
[0m21:53:38.346581 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f
[0m21:53:38.349811 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f"
[0m21:53:38.350285 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f
[0m21:53:38.352135 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f"
[0m21:53:38.352836 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f"
[0m21:53:38.353153 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f: BEGIN
[0m21:53:38.353444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:38.354506 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:53:38.354966 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f"
[0m21:53:38.355475 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "taxi_rides_ny"."prod"."int_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:53:55.382894 [debug] [Thread-1 (]: SQL status: OK in 17.027 seconds
[0m21:53:55.384723 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f: ROLLBACK
[0m21:53:55.385191 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f'
[0m21:53:55.385533 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f: Close
[0m21:53:55.385991 [info ] [Thread-1 (]: 24 of 46 PASS unique_int_trips_trip_id ......................................... [[32mPASS[0m in 17.04s]
[0m21:53:55.386570 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f
[0m21:53:55.387127 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_trips
[0m21:53:55.387588 [info ] [Thread-1 (]: 25 of 46 START sql incremental model prod.fct_trips ............................ [RUN]
[0m21:53:55.388003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_int_trips_trip_id.37d69d814f, now model.taxi_rides_ny.fct_trips)
[0m21:53:55.388343 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_trips
[0m21:53:55.399299 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_trips"
[0m21:53:55.399977 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_trips
[0m21:53:55.436632 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.fct_trips"
[0m21:53:55.437034 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "model.taxi_rides_ny.fct_trips"} */
DESCRIBE (select * from (
        

-- Fact table containing all taxi trips enriched with zone information
-- This is a classic star schema design: fact table (trips) joined to dimension table (zones)
-- Materialized incrementally to handle large datasets efficiently

select
    -- Trip identifiers
    trips.trip_id,
    trips.vendor_id,
    trips.service_type,
    trips.rate_code_id,

    -- Location details (enriched with human-readable zone names from dimension)
    trips.pickup_location_id,
    pz.borough as pickup_borough,
    pz.zone as pickup_zone,
    trips.dropoff_location_id,
    dz.borough as dropoff_borough,
    dz.zone as dropoff_zone,

    -- Trip timing
    trips.pickup_datetime,
    trips.dropoff_datetime,
    trips.store_and_fwd_flag,

    -- Trip metrics
    trips.passenger_count,
    trips.trip_distance,
    trips.trip_type,
    
    
        (date_diff('minute', trips.pickup_datetime::timestamp, trips.dropoff_datetime::timestamp ))
    
 as trip_duration_minutes,

    -- Payment breakdown
    trips.fare_amount,
    trips.extra,
    trips.mta_tax,
    trips.tip_amount,
    trips.tolls_amount,
    trips.ehail_fee,
    trips.improvement_surcharge,
    trips.total_amount,
    trips.payment_type,
    trips.payment_type_description

from "taxi_rides_ny"."prod"."int_trips" as trips
-- LEFT JOIN preserves all trips even if zone information is missing or unknown
left join "taxi_rides_ny"."prod"."dim_zones" as pz
    on trips.pickup_location_id = pz.location_id
left join "taxi_rides_ny"."prod"."dim_zones" as dz
    on trips.dropoff_location_id = dz.location_id


    ) as __dbt_sbq
    where false
    limit 0
)
[0m21:53:55.437380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:53:55.543364 [debug] [Thread-1 (]: SQL status: OK in 0.106 seconds
[0m21:53:55.554781 [warn ] [Thread-1 (]: Detected columns with numeric type and unspecified precision/scale, this can lead to unintended rounding: ['trip_distance', 'fare_amount', 'extra', 'mta_tax', 'tip_amount', 'tolls_amount', 'ehail_fee', 'improvement_surcharge', 'total_amount']`
[0m21:53:55.555484 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.fct_trips"
[0m21:53:55.555825 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "model.taxi_rides_ny.fct_trips"} */
DESCRIBE (select * from (
        select
    
      
    cast(null as varchar)
 as trip_id, 
      
    cast(null as integer)
 as vendor_id, 
      
    cast(null as varchar)
 as service_type, 
      
    cast(null as integer)
 as rate_code_id, 
      
    cast(null as integer)
 as pickup_location_id, 
      
    cast(null as varchar)
 as pickup_borough, 
      
    cast(null as varchar)
 as pickup_zone, 
      
    cast(null as integer)
 as dropoff_location_id, 
      
    cast(null as varchar)
 as dropoff_borough, 
      
    cast(null as varchar)
 as dropoff_zone, 
      
    cast(null as timestamp)
 as pickup_datetime, 
      
    cast(null as timestamp)
 as dropoff_datetime, 
      
    cast(null as varchar)
 as store_and_fwd_flag, 
      
    cast(null as integer)
 as passenger_count, 
      
    cast(null as numeric)
 as trip_distance, 
      
    cast(null as integer)
 as trip_type, 
      
    cast(null as bigint)
 as trip_duration_minutes, 
      
    cast(null as numeric)
 as fare_amount, 
      
    cast(null as numeric)
 as extra, 
      
    cast(null as numeric)
 as mta_tax, 
      
    cast(null as numeric)
 as tip_amount, 
      
    cast(null as numeric)
 as tolls_amount, 
      
    cast(null as numeric)
 as ehail_fee, 
      
    cast(null as numeric)
 as improvement_surcharge, 
      
    cast(null as numeric)
 as total_amount, 
      
    cast(null as integer)
 as payment_type, 
      
    cast(null as varchar)
 as payment_type_description
    ) as __dbt_sbq
    where false
    limit 0
)
[0m21:53:55.556918 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:53:55.573871 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_trips"
[0m21:53:55.574518 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.fct_trips"
[0m21:53:55.574841 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_trips: BEGIN
[0m21:53:55.575470 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:53:55.575757 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.fct_trips"
[0m21:53:55.576135 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_trips: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "model.taxi_rides_ny.fct_trips"} */

  
    
    
      
    

    create  table
      "taxi_rides_ny"."prod"."fct_trips"
  
  (
    trip_id varchar,
    vendor_id integer,
    service_type varchar,
    rate_code_id integer,
    pickup_location_id integer,
    pickup_borough varchar,
    pickup_zone varchar,
    dropoff_location_id integer,
    dropoff_borough varchar,
    dropoff_zone varchar,
    pickup_datetime timestamp,
    dropoff_datetime timestamp,
    store_and_fwd_flag varchar,
    passenger_count integer,
    trip_distance numeric,
    trip_type integer,
    trip_duration_minutes bigint,
    fare_amount numeric,
    extra numeric,
    mta_tax numeric,
    tip_amount numeric,
    tolls_amount numeric,
    ehail_fee numeric,
    improvement_surcharge numeric,
    total_amount numeric,
    payment_type integer,
    payment_type_description varchar
    
    )
 ;
    insert into "taxi_rides_ny"."prod"."fct_trips" 
  (
    
      
      trip_id ,
    
      
      vendor_id ,
    
      
      service_type ,
    
      
      rate_code_id ,
    
      
      pickup_location_id ,
    
      
      pickup_borough ,
    
      
      pickup_zone ,
    
      
      dropoff_location_id ,
    
      
      dropoff_borough ,
    
      
      dropoff_zone ,
    
      
      pickup_datetime ,
    
      
      dropoff_datetime ,
    
      
      store_and_fwd_flag ,
    
      
      passenger_count ,
    
      
      trip_distance ,
    
      
      trip_type ,
    
      
      trip_duration_minutes ,
    
      
      fare_amount ,
    
      
      extra ,
    
      
      mta_tax ,
    
      
      tip_amount ,
    
      
      tolls_amount ,
    
      
      ehail_fee ,
    
      
      improvement_surcharge ,
    
      
      total_amount ,
    
      
      payment_type ,
    
      
      payment_type_description 
    
  )
 (
      
    select trip_id, vendor_id, service_type, rate_code_id, pickup_location_id, pickup_borough, pickup_zone, dropoff_location_id, dropoff_borough, dropoff_zone, pickup_datetime, dropoff_datetime, store_and_fwd_flag, passenger_count, trip_distance, trip_type, trip_duration_minutes, fare_amount, extra, mta_tax, tip_amount, tolls_amount, ehail_fee, improvement_surcharge, total_amount, payment_type, payment_type_description
    from (
        

-- Fact table containing all taxi trips enriched with zone information
-- This is a classic star schema design: fact table (trips) joined to dimension table (zones)
-- Materialized incrementally to handle large datasets efficiently

select
    -- Trip identifiers
    trips.trip_id,
    trips.vendor_id,
    trips.service_type,
    trips.rate_code_id,

    -- Location details (enriched with human-readable zone names from dimension)
    trips.pickup_location_id,
    pz.borough as pickup_borough,
    pz.zone as pickup_zone,
    trips.dropoff_location_id,
    dz.borough as dropoff_borough,
    dz.zone as dropoff_zone,

    -- Trip timing
    trips.pickup_datetime,
    trips.dropoff_datetime,
    trips.store_and_fwd_flag,

    -- Trip metrics
    trips.passenger_count,
    trips.trip_distance,
    trips.trip_type,
    
    
        (date_diff('minute', trips.pickup_datetime::timestamp, trips.dropoff_datetime::timestamp ))
    
 as trip_duration_minutes,

    -- Payment breakdown
    trips.fare_amount,
    trips.extra,
    trips.mta_tax,
    trips.tip_amount,
    trips.tolls_amount,
    trips.ehail_fee,
    trips.improvement_surcharge,
    trips.total_amount,
    trips.payment_type,
    trips.payment_type_description

from "taxi_rides_ny"."prod"."int_trips" as trips
-- LEFT JOIN preserves all trips even if zone information is missing or unknown
left join "taxi_rides_ny"."prod"."dim_zones" as pz
    on trips.pickup_location_id = pz.location_id
left join "taxi_rides_ny"."prod"."dim_zones" as dz
    on trips.dropoff_location_id = dz.location_id


    ) as model_subq
    );
  
  
  
[0m21:54:40.427273 [debug] [Thread-1 (]: SQL status: OK in 44.851 seconds
[0m21:54:40.430024 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_trips: COMMIT
[0m21:54:40.430385 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.fct_trips"
[0m21:54:40.430677 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_trips: COMMIT
[0m21:54:42.805029 [debug] [Thread-1 (]: SQL status: OK in 2.374 seconds
[0m21:54:42.805882 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_trips: Close
[0m21:54:42.806350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df7c6efc-27b0-4f7d-bafd-bc8548b754ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46d35311f0>]}
[0m21:54:42.806854 [info ] [Thread-1 (]: 25 of 46 OK created sql incremental model prod.fct_trips ....................... [[32mOK[0m in 47.42s]
[0m21:54:42.807525 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_trips
[0m21:54:42.808354 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39
[0m21:54:42.808736 [info ] [Thread-1 (]: 26 of 46 START test accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6  [RUN]
[0m21:54:42.809205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.fct_trips, now test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39)
[0m21:54:42.809609 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39
[0m21:54:42.812692 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39"
[0m21:54:42.813549 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39
[0m21:54:42.816059 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39"
[0m21:54:42.816748 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39"
[0m21:54:42.817216 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39: BEGIN
[0m21:54:42.817750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:42.844827 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m21:54:42.845217 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39"
[0m21:54:42.845565 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from "taxi_rides_ny"."prod"."fct_trips"
    group by payment_type

)

select *
from all_values
where value_field not in (
    '0','1','2','3','4','5','6'
)



  
  
      
    ) dbt_internal_test
[0m21:54:43.107745 [debug] [Thread-1 (]: SQL status: OK in 0.262 seconds
[0m21:54:43.108968 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39: ROLLBACK
[0m21:54:43.109499 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39'
[0m21:54:43.109831 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39: Close
[0m21:54:43.110322 [info ] [Thread-1 (]: 26 of 46 PASS accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6 ...... [[32mPASS[0m in 0.30s]
[0m21:54:43.110818 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39
[0m21:54:43.111174 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c
[0m21:54:43.111536 [info ] [Thread-1 (]: 27 of 46 START test accepted_values_fct_trips_service_type__Green__Yellow ...... [RUN]
[0m21:54:43.111905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_fct_trips_payment_type__0__1__2__3__4__5__6.5119ed7e39, now test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c)
[0m21:54:43.112240 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c
[0m21:54:43.115046 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c"
[0m21:54:43.115492 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c
[0m21:54:43.116990 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c"
[0m21:54:43.117507 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c"
[0m21:54:43.117836 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c: BEGIN
[0m21:54:43.118171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:43.119868 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:54:43.120249 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c"
[0m21:54:43.120741 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        service_type as value_field,
        count(*) as n_records

    from "taxi_rides_ny"."prod"."fct_trips"
    group by service_type

)

select *
from all_values
where value_field not in (
    'Green','Yellow'
)



  
  
      
    ) dbt_internal_test
[0m21:54:43.407206 [debug] [Thread-1 (]: SQL status: OK in 0.286 seconds
[0m21:54:43.408440 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c: ROLLBACK
[0m21:54:43.408924 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c'
[0m21:54:43.409221 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c: Close
[0m21:54:43.409699 [info ] [Thread-1 (]: 27 of 46 PASS accepted_values_fct_trips_service_type__Green__Yellow ............ [[32mPASS[0m in 0.30s]
[0m21:54:43.410237 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c
[0m21:54:43.410689 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83
[0m21:54:43.411036 [info ] [Thread-1 (]: 28 of 46 START test not_null_fct_trips_pickup_datetime ......................... [RUN]
[0m21:54:43.411513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_fct_trips_service_type__Green__Yellow.4fe52fcf3c, now test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83)
[0m21:54:43.411822 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83
[0m21:54:43.414830 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m21:54:43.415264 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83
[0m21:54:43.416929 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m21:54:43.417450 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m21:54:43.417847 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83: BEGIN
[0m21:54:43.418216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:43.420197 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:54:43.420554 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83"
[0m21:54:43.420892 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_datetime
from "taxi_rides_ny"."prod"."fct_trips"
where pickup_datetime is null



  
  
      
    ) dbt_internal_test
[0m21:54:43.422142 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:54:43.423550 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83: ROLLBACK
[0m21:54:43.424149 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83'
[0m21:54:43.424521 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83: Close
[0m21:54:43.425016 [info ] [Thread-1 (]: 28 of 46 PASS not_null_fct_trips_pickup_datetime ............................... [[32mPASS[0m in 0.01s]
[0m21:54:43.425626 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83
[0m21:54:43.425982 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f
[0m21:54:43.426296 [info ] [Thread-1 (]: 29 of 46 START test not_null_fct_trips_service_type ............................ [RUN]
[0m21:54:43.426714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_fct_trips_pickup_datetime.3c78164d83, now test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f)
[0m21:54:43.427134 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f
[0m21:54:43.430565 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f"
[0m21:54:43.431104 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f
[0m21:54:43.432916 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f"
[0m21:54:43.433380 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f"
[0m21:54:43.433726 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f: BEGIN
[0m21:54:43.434012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:43.435240 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:54:43.435734 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f"
[0m21:54:43.436222 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select service_type
from "taxi_rides_ny"."prod"."fct_trips"
where service_type is null



  
  
      
    ) dbt_internal_test
[0m21:54:43.437380 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:54:43.438631 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f: ROLLBACK
[0m21:54:43.439106 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f'
[0m21:54:43.439399 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f: Close
[0m21:54:43.439912 [info ] [Thread-1 (]: 29 of 46 PASS not_null_fct_trips_service_type .................................. [[32mPASS[0m in 0.01s]
[0m21:54:43.440508 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f
[0m21:54:43.440999 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d
[0m21:54:43.441442 [info ] [Thread-1 (]: 30 of 46 START test not_null_fct_trips_total_amount ............................ [RUN]
[0m21:54:43.441934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_fct_trips_service_type.f7d55d2d8f, now test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d)
[0m21:54:43.442293 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d
[0m21:54:43.445237 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d"
[0m21:54:43.445815 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d
[0m21:54:43.447774 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d"
[0m21:54:43.448399 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d"
[0m21:54:43.448734 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d: BEGIN
[0m21:54:43.449027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:43.450256 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:54:43.450568 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d"
[0m21:54:43.450933 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "taxi_rides_ny"."prod"."fct_trips"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m21:54:43.451955 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:54:43.453263 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d: ROLLBACK
[0m21:54:43.453819 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d'
[0m21:54:43.454145 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d: Close
[0m21:54:43.454700 [info ] [Thread-1 (]: 30 of 46 PASS not_null_fct_trips_total_amount .................................. [[32mPASS[0m in 0.01s]
[0m21:54:43.455367 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d
[0m21:54:43.455883 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d
[0m21:54:43.456277 [info ] [Thread-1 (]: 31 of 46 START test not_null_fct_trips_trip_id ................................. [RUN]
[0m21:54:43.456716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_fct_trips_total_amount.0e8ec5477d, now test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d)
[0m21:54:43.457031 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d
[0m21:54:43.460022 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d"
[0m21:54:43.460573 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d
[0m21:54:43.464788 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d"
[0m21:54:43.465433 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d"
[0m21:54:43.465809 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d: BEGIN
[0m21:54:43.466095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:43.467268 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:54:43.467618 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d"
[0m21:54:43.467923 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select trip_id
from "taxi_rides_ny"."prod"."fct_trips"
where trip_id is null



  
  
      
    ) dbt_internal_test
[0m21:54:43.468911 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:54:43.470094 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d: ROLLBACK
[0m21:54:43.470717 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d'
[0m21:54:43.471054 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d: Close
[0m21:54:43.471729 [info ] [Thread-1 (]: 31 of 46 PASS not_null_fct_trips_trip_id ....................................... [[32mPASS[0m in 0.01s]
[0m21:54:43.472362 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d
[0m21:54:43.472806 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb
[0m21:54:43.473210 [info ] [Thread-1 (]: 32 of 46 START test not_null_fct_trips_vendor_id ............................... [RUN]
[0m21:54:43.473710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_fct_trips_trip_id.df65bf8c1d, now test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb)
[0m21:54:43.474062 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb
[0m21:54:43.476861 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m21:54:43.477487 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb
[0m21:54:43.479528 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m21:54:43.480003 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m21:54:43.480323 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb: BEGIN
[0m21:54:43.480769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:43.481922 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:54:43.482281 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m21:54:43.482639 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "taxi_rides_ny"."prod"."fct_trips"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m21:54:43.483595 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:54:43.484989 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb: ROLLBACK
[0m21:54:43.485575 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb'
[0m21:54:43.485914 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb: Close
[0m21:54:43.486390 [info ] [Thread-1 (]: 32 of 46 PASS not_null_fct_trips_vendor_id ..................................... [[32mPASS[0m in 0.01s]
[0m21:54:43.486933 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb
[0m21:54:43.487266 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68
[0m21:54:43.487656 [info ] [Thread-1 (]: 33 of 46 START test relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_  [RUN]
[0m21:54:43.488087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_fct_trips_vendor_id.b9b2f380bb, now test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68)
[0m21:54:43.488495 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68
[0m21:54:43.495175 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68"
[0m21:54:43.495698 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68
[0m21:54:43.497592 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68"
[0m21:54:43.498132 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68"
[0m21:54:43.498483 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68: BEGIN
[0m21:54:43.498795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:43.499900 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:54:43.500207 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68"
[0m21:54:43.500528 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select dropoff_location_id as from_field
    from "taxi_rides_ny"."prod"."fct_trips"
    where dropoff_location_id is not null
),

parent as (
    select location_id as to_field
    from "taxi_rides_ny"."prod"."dim_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:54:43.862309 [debug] [Thread-1 (]: SQL status: OK in 0.361 seconds
[0m21:54:43.863690 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68: ROLLBACK
[0m21:54:43.864188 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68'
[0m21:54:43.864548 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68: Close
[0m21:54:43.865034 [info ] [Thread-1 (]: 33 of 46 PASS relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_  [[32mPASS[0m in 0.38s]
[0m21:54:43.865599 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68
[0m21:54:43.865979 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4
[0m21:54:43.866329 [info ] [Thread-1 (]: 34 of 46 START test relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_  [RUN]
[0m21:54:43.866728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_fct_trips_dropoff_location_id__location_id__ref_dim_zones_.95cac88a68, now test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4)
[0m21:54:43.867072 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4
[0m21:54:43.870555 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4"
[0m21:54:43.871027 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4
[0m21:54:43.873102 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4"
[0m21:54:43.873731 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4"
[0m21:54:43.874043 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4: BEGIN
[0m21:54:43.874332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:43.876654 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:54:43.877048 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4"
[0m21:54:43.877376 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select pickup_location_id as from_field
    from "taxi_rides_ny"."prod"."fct_trips"
    where pickup_location_id is not null
),

parent as (
    select location_id as to_field
    from "taxi_rides_ny"."prod"."dim_zones"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:54:44.265920 [debug] [Thread-1 (]: SQL status: OK in 0.388 seconds
[0m21:54:44.268007 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4: ROLLBACK
[0m21:54:44.268610 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4'
[0m21:54:44.269007 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4: Close
[0m21:54:44.269614 [info ] [Thread-1 (]: 34 of 46 PASS relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_  [[32mPASS[0m in 0.40s]
[0m21:54:44.270368 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4
[0m21:54:44.270791 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab
[0m21:54:44.271253 [info ] [Thread-1 (]: 35 of 46 START test unique_fct_trips_trip_id ................................... [RUN]
[0m21:54:44.271829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_fct_trips_pickup_location_id__location_id__ref_dim_zones_.00ad1cf8e4, now test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab)
[0m21:54:44.272204 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab
[0m21:54:44.275756 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab"
[0m21:54:44.276430 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab
[0m21:54:44.278922 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab"
[0m21:54:44.279537 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab"
[0m21:54:44.279906 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab: BEGIN
[0m21:54:44.280236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:44.283152 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:54:44.283731 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab"
[0m21:54:44.284143 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "taxi_rides_ny"."prod"."fct_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:55:01.301752 [debug] [Thread-1 (]: SQL status: OK in 17.017 seconds
[0m21:55:01.304825 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab: ROLLBACK
[0m21:55:01.305343 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab'
[0m21:55:01.305663 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab: Close
[0m21:55:01.306173 [info ] [Thread-1 (]: 35 of 46 PASS unique_fct_trips_trip_id ......................................... [[32mPASS[0m in 17.03s]
[0m21:55:01.306911 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab
[0m21:55:01.307675 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dim_vendors
[0m21:55:01.308076 [info ] [Thread-1 (]: 36 of 46 START sql table model prod.dim_vendors ................................ [RUN]
[0m21:55:01.308547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_fct_trips_trip_id.9b74cb6aab, now model.taxi_rides_ny.dim_vendors)
[0m21:55:01.308828 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dim_vendors
[0m21:55:01.312169 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_vendors"
[0m21:55:01.312742 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dim_vendors
[0m21:55:01.315352 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_vendors"
[0m21:55:01.315995 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.dim_vendors"
[0m21:55:01.316314 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_vendors: BEGIN
[0m21:55:01.316717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:01.442883 [debug] [Thread-1 (]: SQL status: OK in 0.126 seconds
[0m21:55:01.443329 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.dim_vendors"
[0m21:55:01.443707 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "model.taxi_rides_ny.dim_vendors"} */

  
    
    

    create  table
      "taxi_rides_ny"."prod"."dim_vendors__dbt_tmp"
  
    as (
      -- Dimension table for taxi technology vendors
-- Small static dimension defining vendor codes and their company names

with trips as (
    select * from "taxi_rides_ny"."prod"."fct_trips"
),

vendors as (
    select distinct
        vendor_id,
        



case vendor_id
    
    when 1 then 'Creative Mobile Technologies'
    
    when 2 then 'VeriFone Inc.'
    
    when 4 then 'Unknown/Other'
    
end

 as vendor_name
    from trips
)

select * from vendors
    );
  
  
[0m21:55:01.560780 [debug] [Thread-1 (]: SQL status: OK in 0.117 seconds
[0m21:55:01.563474 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.dim_vendors"
[0m21:55:01.563919 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "model.taxi_rides_ny.dim_vendors"} */
alter table "taxi_rides_ny"."prod"."dim_vendors__dbt_tmp" rename to "dim_vendors"
[0m21:55:01.564950 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:55:01.566295 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_vendors: COMMIT
[0m21:55:01.566795 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.dim_vendors"
[0m21:55:01.567142 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_vendors: COMMIT
[0m21:55:01.575659 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m21:55:01.578221 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.dim_vendors"
[0m21:55:01.578657 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_vendors: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "model.taxi_rides_ny.dim_vendors"} */

      drop table if exists "taxi_rides_ny"."prod"."dim_vendors__dbt_backup" cascade
    
[0m21:55:01.579435 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:55:01.580567 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_vendors: Close
[0m21:55:01.581055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df7c6efc-27b0-4f7d-bafd-bc8548b754ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46d35311f0>]}
[0m21:55:01.581629 [info ] [Thread-1 (]: 36 of 46 OK created sql table model prod.dim_vendors ........................... [[32mOK[0m in 0.27s]
[0m21:55:01.582163 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dim_vendors
[0m21:55:01.582550 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fct_monthly_zone_revenue
[0m21:55:01.583012 [info ] [Thread-1 (]: 37 of 46 START sql table model prod.fct_monthly_zone_revenue ................... [RUN]
[0m21:55:01.583534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.dim_vendors, now model.taxi_rides_ny.fct_monthly_zone_revenue)
[0m21:55:01.583928 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fct_monthly_zone_revenue
[0m21:55:01.586160 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fct_monthly_zone_revenue"
[0m21:55:01.586715 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fct_monthly_zone_revenue
[0m21:55:01.589893 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fct_monthly_zone_revenue"
[0m21:55:01.590607 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.fct_monthly_zone_revenue"
[0m21:55:01.591007 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_monthly_zone_revenue: BEGIN
[0m21:55:01.591361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:01.595753 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:55:01.596280 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.fct_monthly_zone_revenue"
[0m21:55:01.596922 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "model.taxi_rides_ny.fct_monthly_zone_revenue"} */

  
    
    

    create  table
      "taxi_rides_ny"."prod"."fct_monthly_zone_revenue__dbt_tmp"
  
    as (
      -- Data mart for monthly revenue analysis by pickup zone and service type
-- This aggregation is optimized for business reporting and dashboards
-- Enables analysis of revenue trends across different zones and taxi types

select
    -- Grouping dimensions
    coalesce(pickup_zone, 'Unknown Zone') as pickup_zone,
    date_trunc('month', pickup_datetime) as revenue_month,  -- Truncate to first day of month
    service_type,

    -- Revenue breakdown (summed by zone, month, and service type)
    sum(fare_amount) as revenue_monthly_fare,
    sum(extra) as revenue_monthly_extra,
    sum(mta_tax) as revenue_monthly_mta_tax,
    sum(tip_amount) as revenue_monthly_tip_amount,
    sum(tolls_amount) as revenue_monthly_tolls_amount,
    sum(ehail_fee) as revenue_monthly_ehail_fee,
    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,
    sum(total_amount) as revenue_monthly_total_amount,

    -- Additional metrics for operational analysis
    count(trip_id) as total_monthly_trips,
    avg(passenger_count) as avg_monthly_passenger_count,
    avg(trip_distance) as avg_monthly_trip_distance

from "taxi_rides_ny"."prod"."fct_trips"
group by pickup_zone, revenue_month, service_type
    );
  
  
[0m21:55:05.650305 [debug] [Thread-1 (]: SQL status: OK in 4.053 seconds
[0m21:55:05.652547 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.fct_monthly_zone_revenue"
[0m21:55:05.652872 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "model.taxi_rides_ny.fct_monthly_zone_revenue"} */
alter table "taxi_rides_ny"."prod"."fct_monthly_zone_revenue__dbt_tmp" rename to "fct_monthly_zone_revenue"
[0m21:55:05.653502 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:55:05.654450 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_monthly_zone_revenue: COMMIT
[0m21:55:05.654772 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.fct_monthly_zone_revenue"
[0m21:55:05.655076 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_monthly_zone_revenue: COMMIT
[0m21:55:05.670025 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m21:55:05.671856 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.fct_monthly_zone_revenue"
[0m21:55:05.672193 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "model.taxi_rides_ny.fct_monthly_zone_revenue"} */

      drop table if exists "taxi_rides_ny"."prod"."fct_monthly_zone_revenue__dbt_backup" cascade
    
[0m21:55:05.672809 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:55:05.673814 [debug] [Thread-1 (]: On model.taxi_rides_ny.fct_monthly_zone_revenue: Close
[0m21:55:05.674244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df7c6efc-27b0-4f7d-bafd-bc8548b754ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46d35311f0>]}
[0m21:55:05.674776 [info ] [Thread-1 (]: 37 of 46 OK created sql table model prod.fct_monthly_zone_revenue .............. [[32mOK[0m in 4.09s]
[0m21:55:05.675263 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fct_monthly_zone_revenue
[0m21:55:05.675609 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580
[0m21:55:05.675926 [info ] [Thread-1 (]: 38 of 46 START test not_null_dim_vendors_vendor_id ............................. [RUN]
[0m21:55:05.676377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.fct_monthly_zone_revenue, now test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580)
[0m21:55:05.676701 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580
[0m21:55:05.679584 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580"
[0m21:55:05.680166 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580
[0m21:55:05.681624 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580"
[0m21:55:05.682129 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580"
[0m21:55:05.682511 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580: BEGIN
[0m21:55:05.682848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:05.696921 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m21:55:05.697318 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580"
[0m21:55:05.697703 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select vendor_id
from "taxi_rides_ny"."prod"."dim_vendors"
where vendor_id is null



  
  
      
    ) dbt_internal_test
[0m21:55:05.698717 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:55:05.699899 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580: ROLLBACK
[0m21:55:05.700385 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580'
[0m21:55:05.700866 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580: Close
[0m21:55:05.701460 [info ] [Thread-1 (]: 38 of 46 PASS not_null_dim_vendors_vendor_id ................................... [[32mPASS[0m in 0.02s]
[0m21:55:05.702009 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580
[0m21:55:05.702375 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141
[0m21:55:05.702744 [info ] [Thread-1 (]: 39 of 46 START test unique_dim_vendors_vendor_id ............................... [RUN]
[0m21:55:05.703187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_dim_vendors_vendor_id.a23aa97580, now test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141)
[0m21:55:05.703653 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141
[0m21:55:05.706763 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141"
[0m21:55:05.707212 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141
[0m21:55:05.708788 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141"
[0m21:55:05.709320 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141"
[0m21:55:05.709668 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141: BEGIN
[0m21:55:05.709971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:05.711085 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:55:05.711447 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141"
[0m21:55:05.711898 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    vendor_id as unique_field,
    count(*) as n_records

from "taxi_rides_ny"."prod"."dim_vendors"
where vendor_id is not null
group by vendor_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:55:05.713600 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:55:05.714944 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141: ROLLBACK
[0m21:55:05.715528 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141'
[0m21:55:05.715832 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141: Close
[0m21:55:05.716319 [info ] [Thread-1 (]: 39 of 46 PASS unique_dim_vendors_vendor_id ..................................... [[32mPASS[0m in 0.01s]
[0m21:55:05.716879 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141
[0m21:55:05.717241 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6
[0m21:55:05.717614 [info ] [Thread-1 (]: 40 of 46 START test accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow  [RUN]
[0m21:55:05.718093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_dim_vendors_vendor_id.8a24aa2141, now test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6)
[0m21:55:05.718500 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6
[0m21:55:05.721958 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6"
[0m21:55:05.722580 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6
[0m21:55:05.724445 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6"
[0m21:55:05.725008 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6"
[0m21:55:05.725318 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6: BEGIN
[0m21:55:05.725690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:05.727158 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:55:05.727641 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6"
[0m21:55:05.728056 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        service_type as value_field,
        count(*) as n_records

    from "taxi_rides_ny"."prod"."fct_monthly_zone_revenue"
    group by service_type

)

select *
from all_values
where value_field not in (
    'Green','Yellow'
)



  
  
      
    ) dbt_internal_test
[0m21:55:05.729665 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:55:05.730902 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6: ROLLBACK
[0m21:55:05.731391 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6'
[0m21:55:05.731811 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6: Close
[0m21:55:05.732372 [info ] [Thread-1 (]: 40 of 46 PASS accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow  [[32mPASS[0m in 0.01s]
[0m21:55:05.732942 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6
[0m21:55:05.733327 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751
[0m21:55:05.733803 [info ] [Thread-1 (]: 41 of 46 START test dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type  [RUN]
[0m21:55:05.734307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_fct_monthly_zone_revenue_service_type__Green__Yellow.6d06874ea6, now test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751)
[0m21:55:05.734726 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751
[0m21:55:05.743674 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751"
[0m21:55:05.744263 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751
[0m21:55:05.746407 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751"
[0m21:55:05.747102 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751"
[0m21:55:05.747442 [debug] [Thread-1 (]: On test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751: BEGIN
[0m21:55:05.747741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:05.748766 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:55:05.749179 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751"
[0m21:55:05.749557 [debug] [Thread-1 (]: On test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  





with validation_errors as (

    select
        pickup_zone, revenue_month, service_type
    from "taxi_rides_ny"."prod"."fct_monthly_zone_revenue"
    group by pickup_zone, revenue_month, service_type
    having count(*) > 1

)

select *
from validation_errors



  
  
      
    ) dbt_internal_test
[0m21:55:05.753572 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:55:05.755101 [debug] [Thread-1 (]: On test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751: ROLLBACK
[0m21:55:05.755599 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751'
[0m21:55:05.755917 [debug] [Thread-1 (]: On test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751: Close
[0m21:55:05.756408 [info ] [Thread-1 (]: 41 of 46 PASS dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type  [[32mPASS[0m in 0.02s]
[0m21:55:05.756940 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751
[0m21:55:05.757313 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709
[0m21:55:05.757764 [info ] [Thread-1 (]: 42 of 46 START test not_null_fct_monthly_zone_revenue_pickup_zone .............. [RUN]
[0m21:55:05.758140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.dbt_utils_unique_combination_of_columns_fct_monthly_zone_revenue_pickup_zone__revenue_month__service_type.22d8eff751, now test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709)
[0m21:55:05.758455 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709
[0m21:55:05.764283 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709"
[0m21:55:05.764944 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709
[0m21:55:05.766647 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709"
[0m21:55:05.767251 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709"
[0m21:55:05.767602 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709: BEGIN
[0m21:55:05.767963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:05.769893 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:55:05.770245 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709"
[0m21:55:05.770597 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select pickup_zone
from "taxi_rides_ny"."prod"."fct_monthly_zone_revenue"
where pickup_zone is null



  
  
      
    ) dbt_internal_test
[0m21:55:05.771767 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:55:05.773302 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709: ROLLBACK
[0m21:55:05.773964 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709'
[0m21:55:05.774310 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709: Close
[0m21:55:05.774825 [info ] [Thread-1 (]: 42 of 46 PASS not_null_fct_monthly_zone_revenue_pickup_zone .................... [[32mPASS[0m in 0.02s]
[0m21:55:05.775301 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709
[0m21:55:05.775642 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100
[0m21:55:05.775953 [info ] [Thread-1 (]: 43 of 46 START test not_null_fct_monthly_zone_revenue_revenue_month ............ [RUN]
[0m21:55:05.776393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_pickup_zone.e3683be709, now test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100)
[0m21:55:05.776709 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100
[0m21:55:05.779626 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100"
[0m21:55:05.780061 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100
[0m21:55:05.781765 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100"
[0m21:55:05.782305 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100"
[0m21:55:05.782666 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100: BEGIN
[0m21:55:05.782998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:05.784173 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:55:05.784549 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100"
[0m21:55:05.784935 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select revenue_month
from "taxi_rides_ny"."prod"."fct_monthly_zone_revenue"
where revenue_month is null



  
  
      
    ) dbt_internal_test
[0m21:55:05.786195 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:55:05.787449 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100: ROLLBACK
[0m21:55:05.787931 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100'
[0m21:55:05.788232 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100: Close
[0m21:55:05.788718 [info ] [Thread-1 (]: 43 of 46 PASS not_null_fct_monthly_zone_revenue_revenue_month .................. [[32mPASS[0m in 0.01s]
[0m21:55:05.789190 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100
[0m21:55:05.789528 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe
[0m21:55:05.789841 [info ] [Thread-1 (]: 44 of 46 START test not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount  [RUN]
[0m21:55:05.790381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_month.50fb349100, now test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe)
[0m21:55:05.790803 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe
[0m21:55:05.795147 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe"
[0m21:55:05.795832 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe
[0m21:55:05.797628 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe"
[0m21:55:05.798130 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe"
[0m21:55:05.798449 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe: BEGIN
[0m21:55:05.798736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:05.800975 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:55:05.801343 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe"
[0m21:55:05.801724 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select revenue_monthly_total_amount
from "taxi_rides_ny"."prod"."fct_monthly_zone_revenue"
where revenue_monthly_total_amount is null



  
  
      
    ) dbt_internal_test
[0m21:55:05.802942 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:55:05.804245 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe: ROLLBACK
[0m21:55:05.804967 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe'
[0m21:55:05.805379 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe: Close
[0m21:55:05.806015 [info ] [Thread-1 (]: 44 of 46 PASS not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount ... [[32mPASS[0m in 0.02s]
[0m21:55:05.806573 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe
[0m21:55:05.806902 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7
[0m21:55:05.807298 [info ] [Thread-1 (]: 45 of 46 START test not_null_fct_monthly_zone_revenue_service_type ............. [RUN]
[0m21:55:05.807807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_revenue_monthly_total_amount.7dd10042fe, now test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7)
[0m21:55:05.808121 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7
[0m21:55:05.811815 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7"
[0m21:55:05.812613 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7
[0m21:55:05.814655 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7"
[0m21:55:05.815178 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7"
[0m21:55:05.815532 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7: BEGIN
[0m21:55:05.815815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:05.816967 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:55:05.817322 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7"
[0m21:55:05.817682 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select service_type
from "taxi_rides_ny"."prod"."fct_monthly_zone_revenue"
where service_type is null



  
  
      
    ) dbt_internal_test
[0m21:55:05.818633 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:55:05.819713 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7: ROLLBACK
[0m21:55:05.820184 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7'
[0m21:55:05.820489 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7: Close
[0m21:55:05.821070 [info ] [Thread-1 (]: 45 of 46 PASS not_null_fct_monthly_zone_revenue_service_type ................... [[32mPASS[0m in 0.01s]
[0m21:55:05.821688 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7
[0m21:55:05.822048 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413
[0m21:55:05.822462 [info ] [Thread-1 (]: 46 of 46 START test not_null_fct_monthly_zone_revenue_total_monthly_trips ...... [RUN]
[0m21:55:05.822890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_service_type.7967f8c6c7, now test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413)
[0m21:55:05.823253 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413
[0m21:55:05.826926 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413"
[0m21:55:05.827490 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413
[0m21:55:05.829165 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413"
[0m21:55:05.829754 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413"
[0m21:55:05.830066 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413: BEGIN
[0m21:55:05.830349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:55:05.831505 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:55:05.831806 [debug] [Thread-1 (]: Using duckdb connection "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413"
[0m21:55:05.832317 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_monthly_trips
from "taxi_rides_ny"."prod"."fct_monthly_zone_revenue"
where total_monthly_trips is null



  
  
      
    ) dbt_internal_test
[0m21:55:05.833487 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:55:05.834822 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413: ROLLBACK
[0m21:55:05.835513 [debug] [Thread-1 (]: Failed to rollback 'test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413'
[0m21:55:05.835908 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413: Close
[0m21:55:05.836443 [info ] [Thread-1 (]: 46 of 46 PASS not_null_fct_monthly_zone_revenue_total_monthly_trips ............ [[32mPASS[0m in 0.01s]
[0m21:55:05.836945 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413
[0m21:55:05.838245 [debug] [MainThread]: Using duckdb connection "master"
[0m21:55:05.838587 [debug] [MainThread]: On master: BEGIN
[0m21:55:05.838889 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:55:05.839941 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:55:05.840232 [debug] [MainThread]: On master: COMMIT
[0m21:55:05.840562 [debug] [MainThread]: Using duckdb connection "master"
[0m21:55:05.840851 [debug] [MainThread]: On master: COMMIT
[0m21:55:05.841259 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:55:05.841689 [debug] [MainThread]: On master: Close
[0m21:55:05.842190 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:55:05.842487 [debug] [MainThread]: Connection 'test.taxi_rides_ny.not_null_fct_monthly_zone_revenue_total_monthly_trips.c1d9a37413' was properly closed.
[0m21:55:05.842963 [info ] [MainThread]: 
[0m21:55:05.843368 [info ] [MainThread]: Finished running 1 incremental model, 2 seeds, 5 table models, 36 data tests, 2 view models in 0 hours 4 minutes and 22.27 seconds (262.27s).
[0m21:55:05.849183 [debug] [MainThread]: Command end result
[0m21:55:05.877092 [debug] [MainThread]: Wrote artifact WritableManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/manifest.json
[0m21:55:05.878480 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/semantic_manifest.json
[0m21:55:05.883942 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/run_results.json
[0m21:55:05.884238 [info ] [MainThread]: 
[0m21:55:05.884570 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:55:05.884868 [info ] [MainThread]: 
[0m21:55:05.885171 [info ] [MainThread]: Done. PASS=46 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=46
[0m21:55:05.885937 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 262.93433, "process_in_blocks": "156131456", "process_kernel_time": 151.95335, "process_mem_max_rss": "5903832", "process_out_blocks": "148932760", "process_user_time": 1506.3257}
[0m21:55:05.886323 [debug] [MainThread]: Command `dbt build` succeeded at 21:55:05.886241 after 262.93 seconds
[0m21:55:05.886691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46d3592bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46ba6cbc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b46ba6cba70>]}
[0m21:55:05.887007 [debug] [MainThread]: Flushing usage events
[0m21:55:07.824873 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:46:40.753073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c7449a86e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c743a6fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c743a6fb10>]}


============================== 22:46:40.760511 | 62dad5dc-2727-4008-baca-3defea398fdb ==============================
[0m22:46:40.760511 [info ] [MainThread]: Running with dbt=1.11.6
[0m22:46:40.761083 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'partial_parse': 'True', 'log_path': '/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/logs', 'static_parser': 'True', 'invocation_command': 'dbt build --select stg_fhv_tripdata', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'use_colors': 'True', 'profiles_dir': '/home/roy/.dbt', 'warn_error': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'introspect': 'True', 'empty': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'no_print': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m22:46:40.937703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62dad5dc-2727-4008-baca-3defea398fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c744754fc0>]}
[0m22:46:40.987243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62dad5dc-2727-4008-baca-3defea398fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c743ad2140>]}
[0m22:46:40.988409 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m22:46:41.047885 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m22:46:41.143500 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m22:46:41.143838 [debug] [MainThread]: previous checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, current checksum: fda039cb47cdf0e627679f660a87812f9dc734dcd251ec88b5466764946323e4
[0m22:46:41.144113 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:46:41.144399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '62dad5dc-2727-4008-baca-3defea398fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c739d8fb50>]}
[0m22:46:42.506534 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_fhv_data' in the 'models' section of file 'models/staging/schema.yml'
[0m22:46:42.605740 [warn ] [MainThread]: The configured adapter does not support metadata-based freshness. A loaded_at_field must be specified for source 'raw.fhv_tripdata'.
[0m22:46:42.700462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62dad5dc-2727-4008-baca-3defea398fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c7399cab70>]}
[0m22:46:42.779623 [debug] [MainThread]: Wrote artifact WritableManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/manifest.json
[0m22:46:42.781154 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/semantic_manifest.json
[0m22:46:42.817665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62dad5dc-2727-4008-baca-3defea398fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c7380f7770>]}
[0m22:46:42.818058 [info ] [MainThread]: Found 9 models, 2 seeds, 36 data tests, 3 sources, 619 macros
[0m22:46:42.820212 [info ] [MainThread]: 
[0m22:46:42.820529 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:46:42.820790 [info ] [MainThread]: 
[0m22:46:42.821173 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:46:42.821862 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m22:46:42.851983 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m22:46:42.852323 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"taxi_rides_ny"'
    
  
  
[0m22:46:42.852590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:42.873296 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m22:46:42.874360 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m22:46:42.875031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_dev)
[0m22:46:42.875465 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "dev"
"
[0m22:46:42.879954 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m22:46:42.880229 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='taxi_rides_ny'
        and type='sqlite'
    
  
[0m22:46:42.880486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:46:42.881619 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:46:42.882544 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m22:46:42.882801 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: BEGIN
[0m22:46:42.883221 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:46:42.883489 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m22:46:42.883777 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
    
        create schema if not exists "taxi_rides_ny"."dev"
    
[0m22:46:42.884239 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:46:42.884856 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m22:46:42.885134 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m22:46:42.885488 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m22:46:42.886042 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:46:42.886337 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: Close
[0m22:46:42.891134 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_dev, now list_taxi_rides_ny_dev)
[0m22:46:42.895447 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m22:46:42.895730 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: BEGIN
[0m22:46:42.895974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:46:42.896989 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:46:42.897247 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m22:46:42.897510 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "connection_name": "list_taxi_rides_ny_dev"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev'
    and lower(table_catalog) = 'taxi_rides_ny'
  
[0m22:46:42.907409 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m22:46:42.908610 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: ROLLBACK
[0m22:46:42.909813 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_dev'
[0m22:46:42.910100 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: Close
[0m22:46:42.911823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62dad5dc-2727-4008-baca-3defea398fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c7298f46d0>]}
[0m22:46:42.912197 [debug] [MainThread]: Using duckdb connection "master"
[0m22:46:42.912495 [debug] [MainThread]: On master: BEGIN
[0m22:46:42.912736 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:46:42.914188 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:46:42.914524 [debug] [MainThread]: On master: COMMIT
[0m22:46:42.914781 [debug] [MainThread]: Using duckdb connection "master"
[0m22:46:42.915025 [debug] [MainThread]: On master: COMMIT
[0m22:46:42.915409 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:46:42.915677 [debug] [MainThread]: On master: Close
[0m22:46:42.917845 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_fhv_tripdata
[0m22:46:42.918275 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.stg_fhv_tripdata ............................... [RUN]
[0m22:46:42.918659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_taxi_rides_ny_dev, now model.taxi_rides_ny.stg_fhv_tripdata)
[0m22:46:42.918969 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_fhv_tripdata
[0m22:46:42.925822 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_fhv_tripdata"
[0m22:46:42.926579 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_fhv_tripdata
[0m22:46:42.952900 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_fhv_tripdata"
[0m22:46:42.953441 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_fhv_tripdata"
[0m22:46:42.953742 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_fhv_tripdata: BEGIN
[0m22:46:42.954026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:46:42.955072 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:46:42.955396 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_fhv_tripdata"
[0m22:46:42.955722 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_fhv_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_fhv_tripdata"} */

  
  create view "taxi_rides_ny"."dev"."stg_fhv_tripdata__dbt_tmp" as (
    

with source as (
    select * from "taxi_rides_ny"."prod"."fhv_tripdata"
),

renamed as (
    select
        -- identifiers
        dispatching_base_num,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps
        cast(pickup_datetime as timestamp) as pickup_datetime,
        cast(dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,

        -- fare info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(ehail_fee as numeric) as ehail_fee,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount

    from source

    -- Required filter
    where dispatching_base_num is not null
)

select * from renamed


where pickup_datetime >= '2019-01-01'
  and pickup_datetime < '2019-02-01'

  );

[0m22:46:42.960824 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Binder Error: Column "passenger_count" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m22:46:42.961192 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_fhv_tripdata"} */

  
  create view "taxi_rides_ny"."dev"."stg_fhv_tripdata__dbt_tmp" as (
    

with source as (
    select * from "taxi_rides_ny"."prod"."fhv_tripdata"
),

renamed as (
    select
        -- identifiers
        dispatching_base_num,
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps
        cast(pickup_datetime as timestamp) as pickup_datetime,
        cast(dropoff_datetime as timestamp) as dropoff_datetime,

        -- trip info
        cast(passenger_count as integer) as passenger_count,
        cast(trip_distance as numeric) as trip_distance,

        -- fare info
        cast(fare_amount as numeric) as fare_amount,
        cast(extra as numeric) as extra,
        cast(mta_tax as numeric) as mta_tax,
        cast(tip_amount as numeric) as tip_amount,
        cast(tolls_amount as numeric) as tolls_amount,
        cast(ehail_fee as numeric) as ehail_fee,
        cast(improvement_surcharge as numeric) as improvement_surcharge,
        cast(total_amount as numeric) as total_amount

    from source

    -- Required filter
    where dispatching_base_num is not null
)

select * from renamed


where pickup_datetime >= '2019-01-01'
  and pickup_datetime < '2019-02-01'

  );

[0m22:46:42.961534 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m22:46:42.961825 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_fhv_tripdata: ROLLBACK
[0m22:46:42.963788 [debug] [Thread-1 (]: Failed to rollback 'model.taxi_rides_ny.stg_fhv_tripdata'
[0m22:46:42.964197 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_fhv_tripdata: Close
[0m22:46:42.972116 [debug] [Thread-1 (]: Runtime Error in model stg_fhv_tripdata (models/staging/stg_fhv_tripdata.sql)
  Binder Error: Column "passenger_count" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m22:46:42.973460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62dad5dc-2727-4008-baca-3defea398fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c7299c4290>]}
[0m22:46:42.973967 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dev.stg_fhv_tripdata ...................... [[31mERROR[0m in 0.05s]
[0m22:46:42.974466 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_fhv_tripdata
[0m22:46:42.975161 [debug] [Thread-4 (]: Marking all children of 'model.taxi_rides_ny.stg_fhv_tripdata' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_fhv_tripdata (models/staging/stg_fhv_tripdata.sql)
  Binder Error: Column "passenger_count" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined.
[0m22:46:42.976257 [debug] [MainThread]: Using duckdb connection "master"
[0m22:46:42.976576 [debug] [MainThread]: On master: BEGIN
[0m22:46:42.976821 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:46:42.977817 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:46:42.978082 [debug] [MainThread]: On master: COMMIT
[0m22:46:42.978331 [debug] [MainThread]: Using duckdb connection "master"
[0m22:46:42.978580 [debug] [MainThread]: On master: COMMIT
[0m22:46:42.978945 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:46:42.979202 [debug] [MainThread]: On master: Close
[0m22:46:42.979521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:46:42.979764 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_fhv_tripdata' was properly closed.
[0m22:46:42.980159 [info ] [MainThread]: 
[0m22:46:42.980499 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m22:46:42.981068 [debug] [MainThread]: Command end result
[0m22:46:43.009029 [debug] [MainThread]: Wrote artifact WritableManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/manifest.json
[0m22:46:43.010460 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/semantic_manifest.json
[0m22:46:43.014894 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/run_results.json
[0m22:46:43.015281 [info ] [MainThread]: 
[0m22:46:43.015662 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:46:43.016040 [info ] [MainThread]: 
[0m22:46:43.016365 [error] [MainThread]: [31mFailure in model stg_fhv_tripdata (models/staging/stg_fhv_tripdata.sql)[0m
[0m22:46:43.016855 [error] [MainThread]:   Runtime Error in model stg_fhv_tripdata (models/staging/stg_fhv_tripdata.sql)
  Binder Error: Column "passenger_count" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m22:46:43.017116 [info ] [MainThread]: 
[0m22:46:43.017454 [info ] [MainThread]:   compiled code at target/compiled/taxi_rides_ny/models/staging/stg_fhv_tripdata.sql
[0m22:46:43.017736 [info ] [MainThread]: 
[0m22:46:43.018020 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:46:43.018717 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.3210409, "process_in_blocks": "11216", "process_kernel_time": 0.142932, "process_mem_max_rss": "174104", "process_out_blocks": "5144", "process_user_time": 3.089546}
[0m22:46:43.019082 [debug] [MainThread]: Command `dbt build` failed at 22:46:43.019005 after 2.32 seconds
[0m22:46:43.019392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c72a6dfe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c72a4f5770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c72a4f5a90>]}
[0m22:46:43.019753 [debug] [MainThread]: Flushing usage events
[0m22:46:43.889385 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:49:07.715086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723bfacb46e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723bf9d7bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723bf9d7bb10>]}


============================== 22:49:07.718079 | 20058de3-6725-4507-9fbc-0390af58b1c6 ==============================
[0m22:49:07.718079 [info ] [MainThread]: Running with dbt=1.11.6
[0m22:49:07.718582 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'target_path': 'None', 'empty': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'log_format': 'default', 'printer_width': '80', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'log_path': '/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/logs', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build --select stg_fhv_tripdata', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/home/roy/.dbt'}
[0m22:49:07.893229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20058de3-6725-4507-9fbc-0390af58b1c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723bfaa60fc0>]}
[0m22:49:07.943985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20058de3-6725-4507-9fbc-0390af58b1c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723bf9dde140>]}
[0m22:49:07.945234 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m22:49:07.999407 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m22:49:08.102445 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:49:08.103041 [debug] [MainThread]: Partial parsing: updated file: taxi_rides_ny://models/staging/stg_fhv_tripdata.sql
[0m22:49:08.355114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20058de3-6725-4507-9fbc-0390af58b1c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723bf0097e50>]}
[0m22:49:08.432868 [debug] [MainThread]: Wrote artifact WritableManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/manifest.json
[0m22:49:08.434235 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/semantic_manifest.json
[0m22:49:08.455251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20058de3-6725-4507-9fbc-0390af58b1c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723bf01258b0>]}
[0m22:49:08.455746 [info ] [MainThread]: Found 9 models, 2 seeds, 36 data tests, 3 sources, 619 macros
[0m22:49:08.457821 [info ] [MainThread]: 
[0m22:49:08.458234 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:49:08.458685 [info ] [MainThread]: 
[0m22:49:08.459221 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:49:08.459941 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m22:49:08.486476 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m22:49:08.486803 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"taxi_rides_ny"'
    
  
  
[0m22:49:08.487059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:08.491726 [debug] [ThreadPool]: DuckDB adapter: duckdb error: IO Error: Could not set lock on file "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/taxi_rides_ny.duckdb": Conflicting lock is held in /usr/local/bin/duckdb (PID 21412) by user roy. See also https://duckdb.org/docs/stable/connect/concurrency
[0m22:49:08.492023 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"taxi_rides_ny"'
    
  
  
[0m22:49:08.492340 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m22:49:08.492641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:08.496124 [debug] [ThreadPool]: DuckDB adapter: duckdb error: IO Error: Could not set lock on file "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/taxi_rides_ny.duckdb": Conflicting lock is held in /usr/local/bin/duckdb (PID 21412) by user roy. See also https://duckdb.org/docs/stable/connect/concurrency
[0m22:49:08.496400 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: macro list_schemas
[0m22:49:08.496660 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m22:49:08.496899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:08.500308 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:49:08.500643 [debug] [MainThread]: Connection 'list_taxi_rides_ny' was properly closed.
[0m22:49:08.500956 [info ] [MainThread]: 
[0m22:49:08.501381 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m22:49:08.501839 [error] [MainThread]: Encountered an error:
IO Error: Could not set lock on file "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/taxi_rides_ny.duckdb": Conflicting lock is held in /usr/local/bin/duckdb (PID 21412) by user roy. See also https://duckdb.org/docs/stable/connect/concurrency
[0m22:49:08.513142 [error] [MainThread]: Traceback (most recent call last):
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/connections.py", line 95, in exception_handler
    yield
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/sql/connections.py", line 147, in add_query
    cursor = connection.handle.cursor()
             ^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/contracts/connection.py", line 96, in handle
    self._handle.resolve(self)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/contracts/connection.py", line 120, in resolve
    return self.opener(connection)
           ~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/connections.py", line 53, in open
    connection.handle = cls._ENV.handle()
                        ~~~~~~~~~~~~~~~^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/environments/local.py", line 75, in handle
    self.conn = self.initialize_db(self.creds, self._plugins)
                ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/environments/__init__.py", line 159, in initialize_db
    conn = duckdb.connect(creds.path, read_only=False, config=config)
_duckdb.IOException: IO Error: Could not set lock on file "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/taxi_rides_ny.duckdb": Conflicting lock is held in /usr/local/bin/duckdb (PID 21412) by user roy. See also https://duckdb.org/docs/stable/connect/concurrency

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/connections.py", line 95, in exception_handler
    yield
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 1320, in execute_macro
    result = macro_function(**kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 427, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt_common/record.py", line 538, in record_replay_wrapper
    return func_to_record(*call_args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 471, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/connections.py", line 130, in execute
    return super().execute(sql, auto_begin, fetch, limit)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/sql/connections.py", line 219, in execute
    _, cursor = self.add_query(sql, auto_begin)
                ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/sql/connections.py", line 131, in add_query
    with self.exception_handler(sql):
         ~~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/home/roy/miniconda3/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/connections.py", line 102, in exception_handler
    self.rollback_if_open()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/base/connections.py", line 125, in rollback_if_open
    if conn is not None and conn.handle and conn.transaction_open:
                            ^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/contracts/connection.py", line 96, in handle
    self._handle.resolve(self)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/contracts/connection.py", line 120, in resolve
    return self.opener(connection)
           ~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/connections.py", line 53, in open
    connection.handle = cls._ENV.handle()
                        ~~~~~~~~~~~~~~~^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/environments/local.py", line 75, in handle
    self.conn = self.initialize_db(self.creds, self._plugins)
                ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/environments/__init__.py", line 159, in initialize_db
    conn = duckdb.connect(creds.path, read_only=False, config=config)
_duckdb.IOException: IO Error: Could not set lock on file "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/taxi_rides_ny.duckdb": Conflicting lock is held in /usr/local/bin/duckdb (PID 21412) by user roy. See also https://duckdb.org/docs/stable/connect/concurrency

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/cli/requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/cli/requires.py", line 276, in wrapper
    return func(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/cli/requires.py", line 321, in wrapper
    return func(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/cli/requires.py", line 391, in wrapper
    return func(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/cli/requires.py", line 368, in wrapper
    return func(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/cli/requires.py", line 408, in wrapper
    return func(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/cli/main.py", line 210, in build
    results = task.run()
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/task/runnable.py", line 626, in run
    result = self.execute_with_hooks(selected_uids)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/task/runnable.py", line 559, in execute_with_hooks
    before_run_status = self.before_run(adapter, selected_uids)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/task/run.py", line 1117, in before_run
    self.create_schemas(adapter, required_schemas)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/task/runnable.py", line 734, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
                                    ~~~~~~~~~~~~~~~~^^
  File "/home/roy/miniconda3/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/home/roy/miniconda3/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/roy/miniconda3/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt_common/utils/executor.py", line 16, in connected
    return func(*args, **kwargs)
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/task/runnable.py", line 709, in list_schemas
    for s in adapter.list_schemas(database_quoted)
             ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/sql/impl.py", line 218, in list_schemas
    results = self.execute_macro(LIST_SCHEMAS_MACRO_NAME, kwargs={"database": database})
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/base/impl.py", line 1319, in execute_macro
    with self.connections.exception_handler(f"macro {macro_name}"):
         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/miniconda3/lib/python3.13/contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/connections.py", line 102, in exception_handler
    self.rollback_if_open()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/base/connections.py", line 125, in rollback_if_open
    if conn is not None and conn.handle and conn.transaction_open:
                            ^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/contracts/connection.py", line 96, in handle
    self._handle.resolve(self)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/contracts/connection.py", line 120, in resolve
    return self.opener(connection)
           ~~~~~~~~~~~^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/connections.py", line 53, in open
    connection.handle = cls._ENV.handle()
                        ~~~~~~~~~~~~~~~^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/environments/local.py", line 75, in handle
    self.conn = self.initialize_db(self.creds, self._plugins)
                ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/dbt_env/lib/python3.13/site-packages/dbt/adapters/duckdb/environments/__init__.py", line 159, in initialize_db
    conn = duckdb.connect(creds.path, read_only=False, config=config)
_duckdb.IOException: IO Error: Could not set lock on file "/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/taxi_rides_ny.duckdb": Conflicting lock is held in /usr/local/bin/duckdb (PID 21412) by user roy. See also https://duckdb.org/docs/stable/connect/concurrency

[0m22:49:08.514624 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.8461521, "process_in_blocks": "208", "process_kernel_time": 0.112967, "process_mem_max_rss": "150856", "process_out_blocks": "3512", "process_user_time": 1.681512}
[0m22:49:08.515154 [debug] [MainThread]: Command `dbt build` failed at 22:49:08.515038 after 0.85 seconds
[0m22:49:08.515698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723bf5ba0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723bf9e4be70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723beda724e0>]}
[0m22:49:08.516306 [debug] [MainThread]: Flushing usage events
[0m22:49:09.401823 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:49:42.106865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac0678946e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac06695bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac06695bb10>]}


============================== 22:49:42.109177 | 2a5fc23d-55b8-4f74-9c16-b2124ad0ce4f ==============================
[0m22:49:42.109177 [info ] [MainThread]: Running with dbt=1.11.6
[0m22:49:42.109859 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'profiles_dir': '/home/roy/.dbt', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/logs', 'printer_width': '80', 'fail_fast': 'False', 'quiet': 'False', 'version_check': 'True', 'empty': 'False', 'partial_parse': 'True', 'introspect': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt build --select stg_fhv_tripdata', 'static_parser': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'log_format': 'default', 'warn_error': 'None', 'debug': 'False', 'indirect_selection': 'eager'}
[0m22:49:42.284202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a5fc23d-55b8-4f74-9c16-b2124ad0ce4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac067640fc0>]}
[0m22:49:42.333569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a5fc23d-55b8-4f74-9c16-b2124ad0ce4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac0669be140>]}
[0m22:49:42.334694 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m22:49:42.388402 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m22:49:42.489702 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:49:42.489993 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m22:49:42.490252 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:49:42.530766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a5fc23d-55b8-4f74-9c16-b2124ad0ce4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac05cc78150>]}
[0m22:49:42.646809 [debug] [MainThread]: Wrote artifact WritableManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/manifest.json
[0m22:49:42.648096 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/semantic_manifest.json
[0m22:49:42.668380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a5fc23d-55b8-4f74-9c16-b2124ad0ce4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac069aa4050>]}
[0m22:49:42.668820 [info ] [MainThread]: Found 9 models, 2 seeds, 36 data tests, 3 sources, 619 macros
[0m22:49:42.670725 [info ] [MainThread]: 
[0m22:49:42.671069 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:49:42.671466 [info ] [MainThread]: 
[0m22:49:42.672063 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:49:42.672776 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m22:49:42.698819 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m22:49:42.699158 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"taxi_rides_ny"'
    
  
  
[0m22:49:42.699422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:42.719316 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m22:49:42.720345 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m22:49:42.720897 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_dev)
[0m22:49:42.721297 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "dev"
"
[0m22:49:42.725834 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m22:49:42.726103 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='taxi_rides_ny'
        and type='sqlite'
    
  
[0m22:49:42.726347 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:49:42.727398 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:49:42.728286 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m22:49:42.728542 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: BEGIN
[0m22:49:42.728987 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:49:42.729229 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m22:49:42.729474 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "connection_name": "create_taxi_rides_ny_dev"} */

    
    
        create schema if not exists "taxi_rides_ny"."dev"
    
[0m22:49:42.729979 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:49:42.730652 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m22:49:42.730913 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_dev"
[0m22:49:42.731156 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: COMMIT
[0m22:49:42.731610 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:49:42.731865 [debug] [ThreadPool]: On create_taxi_rides_ny_dev: Close
[0m22:49:42.736075 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_dev, now list_taxi_rides_ny_dev)
[0m22:49:42.739947 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m22:49:42.740200 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: BEGIN
[0m22:49:42.740457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:49:42.741376 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:49:42.741663 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_dev"
[0m22:49:42.741911 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "connection_name": "list_taxi_rides_ny_dev"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev'
    and lower(table_catalog) = 'taxi_rides_ny'
  
[0m22:49:42.751064 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m22:49:42.752035 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: ROLLBACK
[0m22:49:42.752674 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_dev'
[0m22:49:42.752928 [debug] [ThreadPool]: On list_taxi_rides_ny_dev: Close
[0m22:49:42.754543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a5fc23d-55b8-4f74-9c16-b2124ad0ce4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac05c98af90>]}
[0m22:49:42.754894 [debug] [MainThread]: Using duckdb connection "master"
[0m22:49:42.755142 [debug] [MainThread]: On master: BEGIN
[0m22:49:42.755379 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:49:42.756291 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:49:42.756550 [debug] [MainThread]: On master: COMMIT
[0m22:49:42.756796 [debug] [MainThread]: Using duckdb connection "master"
[0m22:49:42.757031 [debug] [MainThread]: On master: COMMIT
[0m22:49:42.757481 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:49:42.757733 [debug] [MainThread]: On master: Close
[0m22:49:42.759181 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_fhv_tripdata
[0m22:49:42.759583 [info ] [Thread-1 (]: 1 of 1 START sql view model dev.stg_fhv_tripdata ............................... [RUN]
[0m22:49:42.759962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_taxi_rides_ny_dev, now model.taxi_rides_ny.stg_fhv_tripdata)
[0m22:49:42.760272 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_fhv_tripdata
[0m22:49:42.765965 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_fhv_tripdata"
[0m22:49:42.766489 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_fhv_tripdata
[0m22:49:42.790052 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_fhv_tripdata"
[0m22:49:42.790591 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_fhv_tripdata"
[0m22:49:42.790886 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_fhv_tripdata: BEGIN
[0m22:49:42.791163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:49:42.792185 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:49:42.792500 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_fhv_tripdata"
[0m22:49:42.792802 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_fhv_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_fhv_tripdata"} */

  
  create view "taxi_rides_ny"."dev"."stg_fhv_tripdata__dbt_tmp" as (
    

with source as (
    select * from "taxi_rides_ny"."prod"."fhv_tripdata"
),

renamed as (
    select
        -- identifiers
        dispatching_base_num,
        affiliated_base_number,

        -- location ids
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps
        cast(pickup_datetime as timestamp) as pickup_datetime,
        cast(dropOff_datetime as timestamp) as dropoff_datetime,

        -- flags
        sr_flag

    from source

    -- required filter
    where dispatching_base_num is not null
)

select * from renamed


where pickup_datetime >= '2019-01-01'
  and pickup_datetime < '2019-02-01'

  );

[0m22:49:42.793725 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:49:42.798283 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_fhv_tripdata"
[0m22:49:42.798610 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_fhv_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_fhv_tripdata"} */
alter view "taxi_rides_ny"."dev"."stg_fhv_tripdata__dbt_tmp" rename to "stg_fhv_tripdata"
[0m22:49:42.799167 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:42.805866 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_fhv_tripdata: COMMIT
[0m22:49:42.806167 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_fhv_tripdata"
[0m22:49:42.806463 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_fhv_tripdata: COMMIT
[0m22:49:42.810685 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:49:42.814682 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_fhv_tripdata"
[0m22:49:42.816946 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_fhv_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_fhv_tripdata"} */

      drop view if exists "taxi_rides_ny"."dev"."stg_fhv_tripdata__dbt_backup" cascade
    
[0m22:49:42.817564 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:49:42.819217 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_fhv_tripdata: Close
[0m22:49:42.820301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a5fc23d-55b8-4f74-9c16-b2124ad0ce4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac05c06f930>]}
[0m22:49:42.820787 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev.stg_fhv_tripdata .......................... [[32mOK[0m in 0.06s]
[0m22:49:42.821330 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_fhv_tripdata
[0m22:49:42.822354 [debug] [MainThread]: Using duckdb connection "master"
[0m22:49:42.822698 [debug] [MainThread]: On master: BEGIN
[0m22:49:42.822963 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:49:42.823953 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:49:42.824220 [debug] [MainThread]: On master: COMMIT
[0m22:49:42.824575 [debug] [MainThread]: Using duckdb connection "master"
[0m22:49:42.824875 [debug] [MainThread]: On master: COMMIT
[0m22:49:42.825293 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:49:42.825625 [debug] [MainThread]: On master: Close
[0m22:49:42.825954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:49:42.826201 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_fhv_tripdata' was properly closed.
[0m22:49:42.826538 [info ] [MainThread]: 
[0m22:49:42.826949 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m22:49:42.827624 [debug] [MainThread]: Command end result
[0m22:49:42.860077 [debug] [MainThread]: Wrote artifact WritableManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/manifest.json
[0m22:49:42.861520 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/semantic_manifest.json
[0m22:49:42.866366 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/run_results.json
[0m22:49:42.866735 [info ] [MainThread]: 
[0m22:49:42.867179 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:49:42.867619 [info ] [MainThread]: 
[0m22:49:42.868128 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:49:42.868885 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.8061717, "process_in_blocks": "0", "process_kernel_time": 0.100999, "process_mem_max_rss": "161124", "process_out_blocks": "3528", "process_user_time": 1.641985}
[0m22:49:42.869265 [debug] [MainThread]: Command `dbt build` succeeded at 22:49:42.869188 after 0.81 seconds
[0m22:49:42.869593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac066cefc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac05c823d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac05c823e30>]}
[0m22:49:42.869913 [debug] [MainThread]: Flushing usage events
[0m22:49:43.707388 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:53:28.173357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d4988c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d48953ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d48953b10>]}


============================== 22:53:28.175772 | 9b39979f-9049-4788-a57d-96dc894636e6 ==============================
[0m22:53:28.175772 [info ] [MainThread]: Running with dbt=1.11.6
[0m22:53:28.176359 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'profiles_dir': '/home/roy/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'static_parser': 'True', 'printer_width': '80', 'no_print': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'invocation_command': 'dbt build --select stg_fhv_tripdata --target prod', 'introspect': 'True', 'warn_error': 'None', 'target_path': 'None', 'partial_parse': 'True', 'log_path': '/home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/logs', 'fail_fast': 'False'}
[0m22:53:28.351896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b39979f-9049-4788-a57d-96dc894636e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d49638fc0>]}
[0m22:53:28.402027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b39979f-9049-4788-a57d-96dc894636e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d489b6140>]}
[0m22:53:28.403180 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m22:53:28.457253 [debug] [MainThread]: checksum: fda039cb47cdf0e627679f660a87812f9dc734dcd251ec88b5466764946323e4, vars: {}, profile: , target: prod, version: 1.11.6
[0m22:53:28.548588 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m22:53:28.549040 [debug] [MainThread]: previous checksum: fda039cb47cdf0e627679f660a87812f9dc734dcd251ec88b5466764946323e4, current checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8
[0m22:53:28.549294 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:53:28.549581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9b39979f-9049-4788-a57d-96dc894636e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d3ec6fd50>]}
[0m22:53:29.827349 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_fhv_data' in the 'models' section of file 'models/staging/schema.yml'
[0m22:53:29.948110 [warn ] [MainThread]: The configured adapter does not support metadata-based freshness. A loaded_at_field must be specified for source 'raw.fhv_tripdata'.
[0m22:53:30.037059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b39979f-9049-4788-a57d-96dc894636e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d3e903c50>]}
[0m22:53:30.109973 [debug] [MainThread]: Wrote artifact WritableManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/manifest.json
[0m22:53:30.111184 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/semantic_manifest.json
[0m22:53:30.130794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b39979f-9049-4788-a57d-96dc894636e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d3754b070>]}
[0m22:53:30.131185 [info ] [MainThread]: Found 9 models, 2 seeds, 36 data tests, 3 sources, 619 macros
[0m22:53:30.133079 [info ] [MainThread]: 
[0m22:53:30.133409 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m22:53:30.133802 [info ] [MainThread]: 
[0m22:53:30.134346 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m22:53:30.135077 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_taxi_rides_ny'
[0m22:53:30.160176 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny"
[0m22:53:30.160538 [debug] [ThreadPool]: On list_taxi_rides_ny: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "connection_name": "list_taxi_rides_ny"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"taxi_rides_ny"'
    
  
  
[0m22:53:30.160832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:30.181385 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m22:53:30.182570 [debug] [ThreadPool]: On list_taxi_rides_ny: Close
[0m22:53:30.183104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_taxi_rides_ny, now create_taxi_rides_ny_prod)
[0m22:53:30.183528 [debug] [ThreadPool]: Creating schema "database: "taxi_rides_ny"
schema: "prod"
"
[0m22:53:30.188046 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m22:53:30.188366 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
        select type from duckdb_databases()
        where lower(database_name)='taxi_rides_ny'
        and type='sqlite'
    
  
[0m22:53:30.188654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:53:30.189806 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:53:30.190688 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m22:53:30.190935 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: BEGIN
[0m22:53:30.191444 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:53:30.191700 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m22:53:30.191937 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "connection_name": "create_taxi_rides_ny_prod"} */

    
    
        create schema if not exists "taxi_rides_ny"."prod"
    
[0m22:53:30.192367 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:53:30.192954 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m22:53:30.193206 [debug] [ThreadPool]: Using duckdb connection "create_taxi_rides_ny_prod"
[0m22:53:30.193446 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: COMMIT
[0m22:53:30.193869 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m22:53:30.194119 [debug] [ThreadPool]: On create_taxi_rides_ny_prod: Close
[0m22:53:30.198238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_taxi_rides_ny_prod, now list_taxi_rides_ny_prod)
[0m22:53:30.202176 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m22:53:30.202464 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: BEGIN
[0m22:53:30.202712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:53:30.203650 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m22:53:30.203896 [debug] [ThreadPool]: Using duckdb connection "list_taxi_rides_ny_prod"
[0m22:53:30.204141 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "connection_name": "list_taxi_rides_ny_prod"} */
select
      'taxi_rides_ny' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'prod'
    and lower(table_catalog) = 'taxi_rides_ny'
  
[0m22:53:30.213424 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m22:53:30.214420 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: ROLLBACK
[0m22:53:30.215054 [debug] [ThreadPool]: Failed to rollback 'list_taxi_rides_ny_prod'
[0m22:53:30.215303 [debug] [ThreadPool]: On list_taxi_rides_ny_prod: Close
[0m22:53:30.217211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b39979f-9049-4788-a57d-96dc894636e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d3683c870>]}
[0m22:53:30.217602 [debug] [MainThread]: Using duckdb connection "master"
[0m22:53:30.217859 [debug] [MainThread]: On master: BEGIN
[0m22:53:30.218098 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:53:30.218961 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:53:30.219219 [debug] [MainThread]: On master: COMMIT
[0m22:53:30.219514 [debug] [MainThread]: Using duckdb connection "master"
[0m22:53:30.219756 [debug] [MainThread]: On master: COMMIT
[0m22:53:30.220188 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:53:30.220485 [debug] [MainThread]: On master: Close
[0m22:53:30.221980 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_fhv_tripdata
[0m22:53:30.222361 [info ] [Thread-1 (]: 1 of 1 START sql view model prod.stg_fhv_tripdata .............................. [RUN]
[0m22:53:30.222708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_taxi_rides_ny_prod, now model.taxi_rides_ny.stg_fhv_tripdata)
[0m22:53:30.222998 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_fhv_tripdata
[0m22:53:30.228638 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_fhv_tripdata"
[0m22:53:30.229105 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_fhv_tripdata
[0m22:53:30.254075 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_fhv_tripdata"
[0m22:53:30.254736 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_fhv_tripdata"
[0m22:53:30.255049 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_fhv_tripdata: BEGIN
[0m22:53:30.255325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:53:30.256436 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m22:53:30.256727 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_fhv_tripdata"
[0m22:53:30.257025 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_fhv_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "model.taxi_rides_ny.stg_fhv_tripdata"} */

  
  create view "taxi_rides_ny"."prod"."stg_fhv_tripdata__dbt_tmp" as (
    

with source as (
    select * from "taxi_rides_ny"."prod"."fhv_tripdata"
),

renamed as (
    select
        -- identifiers
        dispatching_base_num,
        affiliated_base_number,

        -- location ids
        cast(pulocationid as integer) as pickup_location_id,
        cast(dolocationid as integer) as dropoff_location_id,

        -- timestamps
        cast(pickup_datetime as timestamp) as pickup_datetime,
        cast(dropOff_datetime as timestamp) as dropoff_datetime,

        -- flags
        sr_flag

    from source

    -- required filter
    where dispatching_base_num is not null
)

select * from renamed


  );

[0m22:53:30.257773 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:53:30.262004 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_fhv_tripdata"
[0m22:53:30.262298 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_fhv_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "model.taxi_rides_ny.stg_fhv_tripdata"} */
alter view "taxi_rides_ny"."prod"."stg_fhv_tripdata__dbt_tmp" rename to "stg_fhv_tripdata"
[0m22:53:30.262846 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:53:30.269335 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_fhv_tripdata: COMMIT
[0m22:53:30.269658 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_fhv_tripdata"
[0m22:53:30.269934 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_fhv_tripdata: COMMIT
[0m22:53:30.273952 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m22:53:30.277830 [debug] [Thread-1 (]: Using duckdb connection "model.taxi_rides_ny.stg_fhv_tripdata"
[0m22:53:30.278162 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_fhv_tripdata: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "taxi_rides_ny", "target_name": "prod", "node_id": "model.taxi_rides_ny.stg_fhv_tripdata"} */

      drop view if exists "taxi_rides_ny"."prod"."stg_fhv_tripdata__dbt_backup" cascade
    
[0m22:53:30.278974 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m22:53:30.280857 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_fhv_tripdata: Close
[0m22:53:30.282291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b39979f-9049-4788-a57d-96dc894636e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d36768050>]}
[0m22:53:30.282897 [info ] [Thread-1 (]: 1 of 1 OK created sql view model prod.stg_fhv_tripdata ......................... [[32mOK[0m in 0.06s]
[0m22:53:30.283390 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_fhv_tripdata
[0m22:53:30.284557 [debug] [MainThread]: Using duckdb connection "master"
[0m22:53:30.284843 [debug] [MainThread]: On master: BEGIN
[0m22:53:30.285095 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:53:30.286581 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m22:53:30.286875 [debug] [MainThread]: On master: COMMIT
[0m22:53:30.287133 [debug] [MainThread]: Using duckdb connection "master"
[0m22:53:30.287379 [debug] [MainThread]: On master: COMMIT
[0m22:53:30.287900 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m22:53:30.288189 [debug] [MainThread]: On master: Close
[0m22:53:30.288658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:53:30.289012 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_fhv_tripdata' was properly closed.
[0m22:53:30.289291 [info ] [MainThread]: 
[0m22:53:30.289663 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m22:53:30.290285 [debug] [MainThread]: Command end result
[0m22:53:30.319327 [debug] [MainThread]: Wrote artifact WritableManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/manifest.json
[0m22:53:30.320808 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/semantic_manifest.json
[0m22:53:30.325164 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/roy/Desktop/test-projects/dtc-data-engineering-zoomcamp-2026/module_4/taxi_rides_ny/target/run_results.json
[0m22:53:30.325548 [info ] [MainThread]: 
[0m22:53:30.325965 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:53:30.326279 [info ] [MainThread]: 
[0m22:53:30.326662 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:53:30.327487 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.1987755, "process_in_blocks": "0", "process_kernel_time": 0.115921, "process_mem_max_rss": "172240", "process_out_blocks": "5136", "process_user_time": 3.034957}
[0m22:53:30.327863 [debug] [MainThread]: Command `dbt build` succeeded at 22:53:30.327786 after 2.20 seconds
[0m22:53:30.328152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d374c7d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d368b76b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d368b4230>]}
[0m22:53:30.328495 [debug] [MainThread]: Flushing usage events
[0m22:53:31.248437 [debug] [MainThread]: An error was encountered while trying to flush usage events
